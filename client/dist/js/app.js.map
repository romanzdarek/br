{"version":3,"file":"app.js","mappings":"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","sources":["webpack://mini-battle-royale-client/./src/Weapon.ts","webpack://mini-battle-royale-client/./src/Terrain.ts","webpack://mini-battle-royale-client/./src/LootType.ts","webpack://mini-battle-royale-client/./src/Controller.ts","webpack://mini-battle-royale-client/./src/RoundObstacle.ts","webpack://mini-battle-royale-client/./src/Tree.ts","webpack://mini-battle-royale-client/./src/Rock.ts","webpack://mini-battle-royale-client/./src/Bush.ts","webpack://mini-battle-royale-client/./src/RectangleObstacle.ts","webpack://mini-battle-royale-client/./src/Wall.ts","webpack://mini-battle-royale-client/./src/Colors.ts","webpack://mini-battle-royale-client/./src/PartBulletLine.ts","webpack://mini-battle-royale-client/./src/BulletLine.ts","webpack://mini-battle-royale-client/./src/Point.ts","webpack://mini-battle-royale-client/./src/Scope.ts","webpack://mini-battle-royale-client/./src/View.ts","webpack://mini-battle-royale-client/./src/Map.ts","webpack://mini-battle-royale-client/./src/WaterTerrainData.ts","webpack://mini-battle-royale-client/./src/CollisionPoints.ts","webpack://mini-battle-royale-client/./src/Hand.ts","webpack://mini-battle-royale-client/./src/Blood.ts","webpack://mini-battle-royale-client/./src/Player.ts","webpack://mini-battle-royale-client/./src/ZoneCircle.ts","webpack://mini-battle-royale-client/./src/Zone.ts","webpack://mini-battle-royale-client/./src/Message.ts","webpack://mini-battle-royale-client/./src/WaterCircle.ts","webpack://mini-battle-royale-client/./src/SnapshotManager.ts","webpack://mini-battle-royale-client/./src/Model.ts","webpack://mini-battle-royale-client/./src/ServerClientSync.ts","webpack://mini-battle-royale-client/./src/MyHtmlElements.ts","webpack://mini-battle-royale-client/./src/MapData.ts","webpack://mini-battle-royale-client/./src/Editor.ts","webpack://mini-battle-royale-client/./src/app.ts"],"sourcesContent":["export enum Weapon {\r\n\tEmpty,\r\n\tHand,\r\n\tPistol,\r\n    Machinegun,\r\n    Shotgun,\r\n    Rifle,\r\n    Hammer,\r\n    Granade,\r\n    Smoke,\r\n    Medkit\r\n}","export enum TerrainType {\r\n\tGrass,\r\n\tWater,\r\n\tWaterTriangle1,\r\n\tWaterTriangle2,\r\n\tWaterTriangle3,\r\n\tWaterTriangle4\r\n}\r\n\r\nexport class Terrain {\r\n\treadonly type: TerrainType;\r\n\treadonly x: number;\r\n\treadonly y: number;\r\n\treadonly size: number;\r\n\treadonly angle: number = 0;\r\n\r\n\tconstructor(type: TerrainType, x: number, y: number, size: number) {\r\n\t\tthis.type = type;\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.size = size;\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase TerrainType.WaterTriangle2:\r\n\t\t\t\tthis.angle = 90;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle3:\r\n\t\t\t\tthis.angle = 180;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle4:\r\n\t\t\t\tthis.angle = 270;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n","export enum LootType {\r\n\tPistol,\r\n\tMachinegun,\r\n\tShotgun,\r\n\tRifle,\r\n\tHammer,\r\n\tRedAmmo,\r\n\tGreenAmmo,\r\n\tBlueAmmo,\r\n\tOrangeAmmo,\r\n\tVest,\r\n\tMedkit,\r\n\tGranade,\r\n\tSmoke,\r\n\tScope2,\r\n\tScope4,\r\n\tScope6\r\n}\r\n","import Model from './Model';\r\nimport Socket from './Socket';\r\nimport ServerClientSync from './ServerClientSync';\r\nimport { Snapshot } from './Snapshot';\r\nimport MyHtmlElements from './MyHtmlElements';\r\nimport Editor from './Editor';\r\nimport Point from './Point';\r\nimport OpenGame from './OpenGame';\r\nimport MapData from './MapData';\r\nimport PlayerStats from './PlayerStats';\r\n\r\ndeclare const io: {\r\n\tconnect(url?: string): Socket;\r\n};\r\n\r\nenum AppVariant {\r\n\tProduction,\r\n\tLocalhost,\r\n}\r\n\r\nexport type Keys = {\r\n\tw: boolean;\r\n\ta: boolean;\r\n\ts: boolean;\r\n\td: boolean;\r\n\te: boolean;\r\n\tr: boolean;\r\n};\r\n\r\nexport type Mouse = {\r\n\tx: number;\r\n\ty: number;\r\n\tleft: boolean;\r\n\tmiddle: boolean;\r\n\tright: boolean;\r\n};\r\n\r\nexport class Controller {\r\n\tprivate static instance: Controller;\r\n\tprivate myHtmlElements: MyHtmlElements;\r\n\tprivate model: Model;\r\n\tprivate editor: Editor;\r\n\tprivate socket: Socket;\r\n\tprivate serverClientSync: ServerClientSync;\r\n\tprivate canvas: HTMLCanvasElement;\r\n\tprivate appVariant: AppVariant;\r\n\tprivate keys: Keys = {\r\n\t\tw: false,\r\n\t\ta: false,\r\n\t\ts: false,\r\n\t\td: false,\r\n\t\te: false,\r\n\t\tr: false,\r\n\t};\r\n\tprivate mouse: Mouse = {\r\n\t\tx: 0,\r\n\t\ty: 0,\r\n\t\tleft: false,\r\n\t\tmiddle: false,\r\n\t\tright: false,\r\n\t};\r\n\r\n\tprivate playerAngle: number = 0;\r\n\r\n\tprivate constructor() {\r\n\t\tthis.appVariant = window.location.hostname === 'localhost' ? AppVariant.Localhost : AppVariant.Production;\r\n\t\tthis.myHtmlElements = new MyHtmlElements();\r\n\t\tthis.canvas = document.getElementsByTagName('canvas')[0];\r\n\t\tif (this.appVariant === AppVariant.Localhost) {\r\n\t\t\tthis.socket = io.connect('http://localhost:8000');\r\n\t\t} else {\r\n\t\t\tthis.socket = io.connect();\r\n\t\t}\r\n\t\tthis.serverClientSync = new ServerClientSync();\r\n\t\tthis.editor = new Editor(this.myHtmlElements, this.socket);\r\n\t\tthis.model = new Model(this.mouse, this.socket, this.serverClientSync, this.myHtmlElements, this.editor);\r\n\t\twindow.addEventListener('resize', () => {\r\n\t\t\tthis.model.view.screenResize();\r\n\t\t\tconst event = new Event('mousemove');\r\n\t\t\tthis.canvas.dispatchEvent(event);\r\n\t\t});\r\n\t\twindow.addEventListener('beforeunload', (e) => {\r\n\t\t\t// Cancel the event as stated by the standard.\r\n\t\t\te.preventDefault();\r\n\t\t\t// Chrome requires returnValue to be set.\r\n\t\t\te.returnValue = '';\r\n\t\t});\r\n\t\tthis.keysController();\r\n\t\tthis.mouseController();\r\n\t\tthis.socketController();\r\n\t\tthis.menuController();\r\n\t}\r\n\r\n\tstatic run(): void {\r\n\t\tif (!Controller.instance) {\r\n\t\t\tController.instance = new Controller();\r\n\t\t} else {\r\n\t\t\tthrow new Error('Only one controller!');\r\n\t\t}\r\n\t}\r\n\r\n\tprivate changePlayerName(): void {\r\n\t\tconst el = this.myHtmlElements;\r\n\t\tlet nameOk = false;\r\n\t\tif ((<HTMLInputElement>el.mainMenu.name).value.length) {\r\n\t\t\tnameOk = true;\r\n\t\t\t//save name\r\n\t\t\tlocalStorage.setItem('playerName', (<HTMLInputElement>el.mainMenu.name).value);\r\n\t\t}\r\n\t\t(<HTMLInputElement>el.mainMenu.create).disabled = !nameOk;\r\n\t\t(<HTMLInputElement>el.mainMenu.maps).disabled = !nameOk;\r\n\t\tlet gameExists = false;\r\n\t\tif ((<HTMLInputElement>el.mainMenu.games).value) gameExists = true;\r\n\t\tlet joinDisabled = true;\r\n\t\tif (nameOk && gameExists) joinDisabled = false;\r\n\t\t(<HTMLInputElement>el.mainMenu.join).disabled = joinDisabled;\r\n\t\t(<HTMLInputElement>el.mainMenu.games).disabled = joinDisabled;\r\n\t}\r\n\r\n\tprivate socketController(): void {\r\n\t\tconst el = this.myHtmlElements;\r\n\r\n\t\tthis.socket.on('debug', (data: any) => {\r\n\t\t\tconsole.log('debug:', data);\r\n\t\t});\r\n\r\n\t\t//gameOver\r\n\t\tthis.socket.on('winner', (stats: PlayerStats) => {\r\n\t\t\tthis.model.view.gameOver(stats, true);\r\n\t\t});\r\n\r\n\t\tthis.socket.on('loser', (stats: PlayerStats) => {\r\n\t\t\tthis.model.view.gameOver(stats, false);\r\n\t\t});\r\n\r\n\t\tthis.socket.on('stopGame', () => {\r\n\t\t\tthis.model.stop();\r\n\t\t});\r\n\r\n\t\tthis.socket.on('stopSpectate', (stats: PlayerStats, winnerName) => {\r\n\t\t\tthis.model.view.gameOver(stats, true, winnerName);\r\n\t\t});\r\n\r\n\t\t//startGame\r\n\t\tthis.socket.on('startGame', (mapData: MapData) => {\r\n\t\t\tthis.model.map.openMap(mapData);\r\n\t\t\tthis.model.gameStart();\r\n\t\t\tel.close(el.lobbyMenu.main);\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tel.close(el.hideGame);\r\n\t\t\t}, 100);\r\n\t\t});\r\n\r\n\t\t//playerId\r\n\t\tthis.socket.on('playerId', (playerId: number) => {\r\n\t\t\tthis.model.setPlayerId(playerId);\r\n\t\t});\r\n\r\n\t\t//createGame\r\n\t\tthis.socket.on('createGame', (gameId: number, playerName: string) => {\r\n\t\t\tthis.model.setGameId(gameId);\r\n\t\t\tel.close(el.mainMenu.main, el.lobbyMenu.forJoinPlayers);\r\n\t\t\tel.open(el.lobbyMenu.main, el.lobbyMenu.forCreatePlayer);\r\n\t\t});\r\n\r\n\t\t//joinGame\r\n\t\tthis.socket.on('joinGame', (gameId: number, playerName: string) => {\r\n\t\t\tthis.model.setGameId(gameId);\r\n\t\t\tel.close(el.mainMenu.main, el.lobbyMenu.forCreatePlayer);\r\n\t\t\tel.open(el.lobbyMenu.main, el.lobbyMenu.forJoinPlayers);\r\n\t\t});\r\n\r\n\t\t//leave lobby\r\n\t\tthis.socket.on('leaveLobby', () => {\r\n\t\t\tthis.model.setGameId(-1);\r\n\t\t\tel.close(el.lobbyMenu.main);\r\n\t\t\tel.open(el.mainMenu.main);\r\n\t\t});\r\n\r\n\t\t//cancel lobby\r\n\t\tthis.socket.on('cancelLobby', () => {\r\n\t\t\tthis.model.setGameId(-1);\r\n\t\t\tel.close(el.lobbyMenu.main);\r\n\t\t\tel.open(el.gameCanceledMenu.main);\r\n\t\t});\r\n\r\n\t\t//updateListOpenGames\r\n\t\tthis.socket.on('updateListOpenGames', (openGames: OpenGame[]) => {\r\n\t\t\tel.mainMenu.games.innerHTML = '';\r\n\t\t\tfor (const openGame of openGames) {\r\n\t\t\t\tconst option = document.createElement('option');\r\n\t\t\t\toption.textContent = openGame.name + \"'s game\";\r\n\t\t\t\toption.setAttribute('value', openGame.index.toString());\r\n\t\t\t\tel.mainMenu.games.appendChild(option);\r\n\t\t\t}\r\n\r\n\t\t\tif (openGames.length && (<HTMLInputElement>el.mainMenu.name).value.length) {\r\n\t\t\t\t(<HTMLInputElement>el.mainMenu.games).disabled = false;\r\n\t\t\t\t(<HTMLInputElement>el.mainMenu.join).disabled = false;\r\n\t\t\t} else {\r\n\t\t\t\t(<HTMLInputElement>el.mainMenu.games).disabled = true;\r\n\t\t\t\t(<HTMLInputElement>el.mainMenu.join).disabled = true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//update listOfPlayers in lobby\r\n\t\tthis.socket.on('listOfPlayers', (playerNames: string[]) => {\r\n\t\t\t//title\r\n\t\t\tel.lobbyMenu.gameName.textContent = playerNames[0] + \"'s game\";\r\n\t\t\t//list\r\n\t\t\tel.lobbyMenu.players.innerHTML = '';\r\n\t\t\tfor (const playerName of playerNames) {\r\n\t\t\t\tconst li = document.createElement('li');\r\n\t\t\t\tli.textContent = playerName;\r\n\t\t\t\tel.lobbyMenu.players.appendChild(li);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.socket.on('collisionPoints', (body: Point[], hand: Point[], hammer: Point[][]) => {\r\n\t\t\tthis.model.collisionPoints.setData(body, hand, hammer);\r\n\t\t});\r\n\r\n\t\t//map\r\n\t\tthis.socket.on('sendMap', (map) => {\r\n\t\t\tthis.model.map.openMap(map);\r\n\t\t});\r\n\r\n\t\t//map saved\r\n\t\tthis.socket.on('mapSaved', () => {\r\n\t\t\tel.close(el.mapEditorMenu.main, el.editor.container);\r\n\t\t\tel.open(el.saveMapMenu.main);\r\n\t\t\tthis.editor.close();\r\n\t\t});\r\n\r\n\t\t//uodate listOfMaps\r\n\t\tthis.socket.on('listOfMaps', (maps: string[]) => {\r\n\t\t\tel.openMapMenu.maps.innerHTML = '';\r\n\t\t\tel.mainMenu.maps.innerHTML = '';\r\n\t\t\tfor (const map of maps) {\r\n\t\t\t\tconst option = document.createElement('option');\r\n\t\t\t\toption.setAttribute('value', map);\r\n\t\t\t\toption.textContent = map;\r\n\t\t\t\tel.mainMenu.maps.appendChild(option);\r\n\t\t\t\tconst optionCopy = option.cloneNode(true);\r\n\t\t\t\tel.openMapMenu.maps.appendChild(optionCopy);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.socket.on('createPlayer', (name: string) => {\r\n\t\t\tif (name) {\r\n\t\t\t\tthis.model.setName(name);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log('err: created player');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//sync\r\n\t\tthis.socket.on('serverClientSync', (clientDateNow, serverDateNow) => {\r\n\t\t\tconst timeNow = Date.now();\r\n\t\t\tconst ping = timeNow - clientDateNow;\r\n\t\t\tconst timeDiferenceClientServer = serverDateNow - (timeNow - ping / 2);\r\n\t\t\tthis.serverClientSync.addData(ping, timeDiferenceClientServer);\r\n\t\t});\r\n\r\n\t\t//u === update positions\r\n\t\tthis.socket.on('u', (snapshot: Snapshot) => {\r\n\t\t\tthis.model.snapshotManager.addSnapshot(snapshot);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate mouseController(): void {\r\n\t\t//deny right click menu\r\n\t\tdocument.addEventListener('contextmenu', function (e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\t\t//deny middle button\r\n\t\tdocument.addEventListener('mousedown', function (e) {\r\n\t\t\tif (e.which === 2) e.preventDefault();\r\n\t\t});\r\n\r\n\t\t//player angle\r\n\t\tthis.myHtmlElements.transparentLayer.addEventListener('mousemove', (e: MouseEvent) => {\r\n\t\t\tif (!this.model.gameActive()) return;\r\n\t\t\tif (e.x == undefined) {\r\n\t\t\t\tthis.mouse.x = this.canvas.width / 2;\r\n\t\t\t\tthis.mouse.y = this.canvas.height / 2;\r\n\t\t\t} else {\r\n\t\t\t\tthis.mouse.x = e.x;\r\n\t\t\t\tthis.mouse.y = e.y;\r\n\t\t\t}\r\n\r\n\t\t\tconst previousPlayerAngle = this.playerAngle;\r\n\t\t\tthis.rotatePlayer(this.mouse.x, this.mouse.y);\r\n\t\t\t//change\r\n\t\t\tif (this.playerAngle !== previousPlayerAngle) {\r\n\t\t\t\tthis.socket.emit('a', this.model.getGameId(), this.playerAngle);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.myHtmlElements.transparentLayer.addEventListener('mousedown', (e: MouseEvent) => {\r\n\t\t\tif (!this.model.gameActive()) return;\r\n\t\t\tthis.mouse.left = true;\r\n\t\t\tconst clickPoint = new Point(e.clientX, e.clientY);\r\n\t\t\tconst serverPosition = this.model.view.calculateServerPosition(clickPoint);\r\n\t\t\tthis.socket.emit('m', this.model.getGameId(), 'l', serverPosition);\r\n\t\t});\r\n\t\tthis.myHtmlElements.transparentLayer.addEventListener('mouseup', (e: MouseEvent) => {\r\n\t\t\tif (!this.model.gameActive()) return;\r\n\t\t\tthis.mouse.left = false;\r\n\t\t\tthis.socket.emit('m', this.model.getGameId(), '-l');\r\n\t\t});\r\n\t}\r\n\r\n\tprivate rotatePlayer(mouseX: number, mouseY: number): void {\r\n\t\t//triangular sides\r\n\t\tconst centerX = this.canvas.width / 2;\r\n\t\tconst centerY = this.canvas.height / 2;\r\n\t\tlet x = centerX - mouseX;\r\n\t\tlet y = centerY - mouseY;\r\n\t\t//can not set x and y to 0 because angle\r\n\t\tif (x === 0) x = 0.1;\r\n\t\t//atangens\r\n\t\tlet angle = Math.abs((Math.atan(x / y) * 180) / Math.PI);\r\n\t\t//1..2..3..4.. Q; 0 - 90, 90 - 180...\r\n\t\t//1\r\n\t\tif (mouseX >= centerX && mouseY < centerY) {\r\n\t\t\tthis.playerAngle = angle;\r\n\t\t}\r\n\t\t//2\r\n\t\tif (mouseX >= centerX && mouseY >= centerY) {\r\n\t\t\tthis.playerAngle = 90 + 90 - angle;\r\n\t\t}\r\n\t\t//3\r\n\t\tif (mouseX < centerX && mouseY >= centerY) {\r\n\t\t\tthis.playerAngle = 180 + angle;\r\n\t\t}\r\n\t\t//4\r\n\t\tif (mouseX < centerX && mouseY < centerY) {\r\n\t\t\tthis.playerAngle = 270 + 90 - angle;\r\n\t\t}\r\n\t\tthis.playerAngle = Math.round(this.playerAngle);\r\n\t\tif (this.playerAngle === 360) this.playerAngle = 0;\r\n\t}\r\n\r\n\tprivate keysController(): void {\r\n\t\tdocument.addEventListener('keydown', (e: KeyboardEvent) => {\r\n\t\t\t//esc\r\n\t\t\tif (e.which === 27) {\r\n\t\t\t\tif (this.model.gameActive() || this.model.getSpectate()) {\r\n\t\t\t\t\tthis.myHtmlElements.escFromGameMenu.main.style.display = 'block';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!this.model.gameActive()) return;\r\n\t\t\t//w\r\n\t\t\tswitch (e.which) {\r\n\t\t\t\tcase 87:\r\n\t\t\t\t\tif (!this.keys.w) this.socket.emit('c', this.model.getGameId(), 'u');\r\n\t\t\t\t\tthis.keys.w = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//a\r\n\t\t\t\tcase 65:\r\n\t\t\t\t\tif (!this.keys.a) this.socket.emit('c', this.model.getGameId(), 'l');\r\n\t\t\t\t\tthis.keys.a = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//s\r\n\t\t\t\tcase 83:\r\n\t\t\t\t\tif (!this.keys.s) this.socket.emit('c', this.model.getGameId(), 'd');\r\n\t\t\t\t\tthis.keys.s = true;\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//d\r\n\t\t\t\tcase 68:\r\n\t\t\t\t\tif (!this.keys.d) this.socket.emit('c', this.model.getGameId(), 'r');\r\n\t\t\t\t\tthis.keys.d = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//e\r\n\t\t\t\tcase 69:\r\n\t\t\t\t\tif (!this.keys.e) this.socket.emit('c', this.model.getGameId(), 'e');\r\n\t\t\t\t\tthis.keys.e = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//r\r\n\t\t\t\tcase 82:\r\n\t\t\t\t\tif (!this.keys.e) this.socket.emit('c', this.model.getGameId(), 're');\r\n\t\t\t\t\tthis.keys.r = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//0\r\n\t\t\t\tcase 48:\r\n\t\t\t\t\tthis.socket.emit('i', this.model.getGameId(), 0);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//1\r\n\t\t\t\tcase 49:\r\n\t\t\t\t\tthis.socket.emit('i', this.model.getGameId(), 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//2\r\n\t\t\t\tcase 50:\r\n\t\t\t\t\tthis.socket.emit('i', this.model.getGameId(), 2);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//3\r\n\t\t\t\tcase 51:\r\n\t\t\t\t\tthis.socket.emit('i', this.model.getGameId(), 3);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//4\r\n\t\t\t\tcase 52:\r\n\t\t\t\t\tthis.socket.emit('i', this.model.getGameId(), 4);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//5\r\n\t\t\t\tcase 53:\r\n\t\t\t\t\tthis.socket.emit('i', this.model.getGameId(), 5);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//6\r\n\t\t\t\tcase 54:\r\n\t\t\t\t\tthis.socket.emit('i', this.model.getGameId(), 6);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//7\r\n\t\t\t\tcase 55:\r\n\t\t\t\t\tthis.socket.emit('i', this.model.getGameId(), 7);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//8\r\n\t\t\t\tcase 56:\r\n\t\t\t\t\tthis.socket.emit('i', this.model.getGameId(), 8);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdocument.addEventListener('keyup', (e: KeyboardEvent) => {\r\n\t\t\tif (!this.model.gameActive()) return;\r\n\t\t\tswitch (e.which) {\r\n\t\t\t\t//w\r\n\t\t\t\tcase 87:\r\n\t\t\t\t\tif (this.keys.w) this.socket.emit('c', this.model.getGameId(), '-u');\r\n\t\t\t\t\tthis.keys.w = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//a\r\n\t\t\t\tcase 65:\r\n\t\t\t\t\tif (this.keys.a) this.socket.emit('c', this.model.getGameId(), '-l');\r\n\t\t\t\t\tthis.keys.a = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//s\r\n\t\t\t\tcase 83:\r\n\t\t\t\t\tif (this.keys.s) this.socket.emit('c', this.model.getGameId(), '-d');\r\n\t\t\t\t\tthis.keys.s = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//d\r\n\t\t\t\tcase 68:\r\n\t\t\t\t\tif (this.keys.d) this.socket.emit('c', this.model.getGameId(), '-r');\r\n\t\t\t\t\tthis.keys.d = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//e\r\n\t\t\t\tcase 69:\r\n\t\t\t\t\tthis.keys.e = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//r\r\n\t\t\t\tcase 82:\r\n\t\t\t\t\tthis.keys.r = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate menuController(): void {\r\n\t\tconst el = this.myHtmlElements;\r\n\r\n\t\t//load player name\r\n\t\tif (localStorage.getItem('playerName')) {\r\n\t\t\t(<HTMLInputElement>el.mainMenu.name).value = localStorage.getItem('playerName');\r\n\t\t\tthis.changePlayerName();\r\n\t\t}\r\n\r\n\t\t//+++++++++++++ ESC MENU\r\n\t\tel.escFromGameMenu.back.addEventListener('click', () => {\r\n\t\t\tel.escFromGameMenu.main.style.display = 'none';\r\n\t\t});\r\n\r\n\t\tel.escFromGameMenu.leave.addEventListener('click', () => {\r\n\t\t\tel.escFromGameMenu.main.style.display = 'none';\r\n\t\t\tthis.socket.emit('leaveGame', this.model.getGameId());\r\n\t\t\tthis.model.reset();\r\n\t\t});\r\n\r\n\t\t//+++++++++++++ GAME OVER MENU\r\n\t\tel.gameOverMenu.back.addEventListener('click', () => {\r\n\t\t\tthis.socket.emit('leaveGame', this.model.getGameId());\r\n\t\t\tthis.model.reset();\r\n\t\t});\r\n\r\n\t\tel.gameOverMenu.spectate.addEventListener('click', () => {\r\n\t\t\tthis.socket.emit('spectate', this.model.getGameId());\r\n\t\t\tel.close(el.gameOverMenu.main);\r\n\t\t\tthis.model.startSpectate();\r\n\t\t});\r\n\r\n\t\t//+++++++++++++ MAP SIZE MENU\r\n\t\t//mapSize ok button\r\n\t\tel.mapSizeMenu.ok.addEventListener('click', () => {\r\n\t\t\tthis.editor.changeSize(parseInt((<HTMLInputElement>document.getElementById('mapSizeValue')).value));\r\n\t\t\tel.open(el.editor.container);\r\n\t\t\tel.close(el.mapSizeMenu.main);\r\n\t\t});\r\n\t\t//mapSize back button\r\n\t\tel.mapSizeMenu.back.addEventListener('click', () => {\r\n\t\t\tel.close(el.mapSizeMenu.main);\r\n\t\t\tif (this.editor.isActive()) {\r\n\t\t\t\tel.open(el.mapEditorMenu.main);\r\n\t\t\t} else {\r\n\t\t\t\tel.open(el.mapMenu.main);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//+++++++++++++ MAP EDITOR MAIN MENU\r\n\t\t//create a new map\r\n\t\tel.mapMenu.create.addEventListener('click', () => {\r\n\t\t\tthis.editor.create();\r\n\t\t\tel.close(el.mapMenu.main);\r\n\t\t\tel.open(el.mapSizeMenu.main);\r\n\t\t});\r\n\t\t//open maps\r\n\t\tel.mapMenu.open.addEventListener('click', () => {\r\n\t\t\tel.close(el.mapMenu.main);\r\n\t\t\tel.open(el.openMapMenu.main);\r\n\t\t});\r\n\t\t//close mapMenu\r\n\t\tel.mapMenu.back.addEventListener('click', () => {\r\n\t\t\tel.close(el.mapMenu.main);\r\n\t\t\tel.open(el.mainMenu.main);\r\n\t\t});\r\n\r\n\t\t//+++++++++++++ OPEN MAP MENU\r\n\t\t//back\r\n\t\tel.openMapMenu.back.addEventListener('click', () => {\r\n\t\t\tel.close(el.openMapMenu.main);\r\n\t\t\tel.open(el.mapMenu.main);\r\n\t\t});\r\n\t\t//open\r\n\t\tel.openMapMenu.ok.addEventListener('click', () => {\r\n\t\t\tconst mapName = (<HTMLInputElement>el.openMapMenu.maps).value;\r\n\t\t\tthis.socket.emit('openMapInEditor', mapName);\r\n\t\t});\r\n\t\t//+++++++++++++ EDITOR MENU - from editor...\r\n\t\t//open menu\r\n\t\tel.editor.openMenu.addEventListener('click', () => {\r\n\t\t\tel.open(el.mapEditorMenu.main);\r\n\t\t});\r\n\t\t//back\r\n\t\tel.mapEditorMenu.back.addEventListener('click', () => {\r\n\t\t\tel.close(el.mapEditorMenu.main);\r\n\t\t});\r\n\t\t//close editor\r\n\t\tel.mapEditorMenu.close.addEventListener('click', () => {\r\n\t\t\tel.close(el.mapEditorMenu.main, el.editor.container);\r\n\t\t\tel.open(el.mainMenu.main);\r\n\t\t\tthis.editor.close();\r\n\t\t});\r\n\t\t//save\r\n\t\tel.mapEditorMenu.save.addEventListener('click', () => {\r\n\t\t\tconst mapData = this.editor.getMapData();\r\n\t\t\tconst mapName = (<HTMLInputElement>el.mapEditorMenu.name).value;\r\n\t\t\tif (this.model.isNameOk(mapName)) {\r\n\t\t\t\tthis.socket.emit('editorSaveMap', mapName, mapData);\r\n\t\t\t} else {\r\n\t\t\t\tel.open(el.alertMenu.main);\r\n\t\t\t}\r\n\t\t});\r\n\t\t//change size\r\n\t\tel.mapEditorMenu.changeSize.addEventListener('click', () => {\r\n\t\t\tel.close(el.mapEditorMenu.main);\r\n\t\t\tel.open(el.mapSizeMenu.main);\r\n\t\t});\r\n\r\n\t\t//+++++++++++++ SAVE MAP MENU\r\n\t\t//return to main menu\r\n\t\tel.saveMapMenu.back.addEventListener('click', () => {\r\n\t\t\tel.close(el.saveMapMenu.main);\r\n\t\t\tel.open(el.mainMenu.main);\r\n\t\t});\r\n\r\n\t\t//+++++++++++++ MAIN MENU\r\n\t\t//open editor menu and close main menu\r\n\t\tel.mainMenu.openEditor.addEventListener('click', () => {\r\n\t\t\tel.open(el.mapMenu.main);\r\n\t\t\tel.close(el.mainMenu.main);\r\n\t\t});\r\n\t\t//change player name and allow create game\r\n\t\tel.mainMenu.name.addEventListener('input', () => {\r\n\t\t\tthis.changePlayerName();\r\n\t\t});\r\n\t\t//select game - allow join\r\n\t\t/*\r\n\t\tel.mainMenu.games.addEventListener('change', () => {\r\n\t\t\tlet disabled = true;\r\n\t\t\tif ((<HTMLInputElement>el.mainMenu.name).value.length) disabled = false;\r\n\t\t\tlet disabled2 = true;\r\n\t\t\tif ((<HTMLInputElement>el.mainMenu.games).value) disabled2 = false;\r\n\t\t\tif (!disabled && !disabled2) (<HTMLInputElement>el.mainMenu.join).disabled = false;\r\n\t\t});\r\n\t\t*/\r\n\t\t//create a new game\r\n\t\tel.mainMenu.create.addEventListener('click', () => {\r\n\t\t\tif ((<HTMLInputElement>el.mainMenu.name).value.length) {\r\n\t\t\t\tconst playerName = (<HTMLInputElement>el.mainMenu.name).value;\r\n\t\t\t\tconst selectedMap = (<HTMLInputElement>el.mainMenu.maps).value;\r\n\t\t\t\tif (this.model.isNameOk(playerName)) {\r\n\t\t\t\t\tthis.socket.emit('createGame', playerName, selectedMap);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tel.open(el.alertMenu.main);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t//join\r\n\t\tel.mainMenu.join.addEventListener('click', () => {\r\n\t\t\tif ((<HTMLInputElement>el.mainMenu.name).value.length && (<HTMLInputElement>el.mainMenu.games).value) {\r\n\t\t\t\tconst playerName = (<HTMLInputElement>el.mainMenu.name).value;\r\n\t\t\t\tconst gameIndex = parseInt((<HTMLInputElement>el.mainMenu.games).value);\r\n\t\t\t\tif (this.model.isNameOk(playerName)) {\r\n\t\t\t\t\tthis.socket.emit('joinGame', playerName, gameIndex);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tel.open(el.alertMenu.main);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t//cancel lobby\r\n\t\tel.gameCanceledMenu.back.addEventListener('click', () => {\r\n\t\t\tel.close(el.gameCanceledMenu.main);\r\n\t\t\tel.open(el.mainMenu.main);\r\n\t\t});\r\n\t\t//controls\r\n\t\tel.mainMenu.controls.addEventListener('click', () => {\r\n\t\t\tel.open(el.controlsMenu.main);\r\n\t\t\tel.close(el.mainMenu.main);\r\n\t\t});\r\n\t\t//+++++++++++++ ALERT MENU\r\n\t\tel.alertMenu.ok.addEventListener('click', () => {\r\n\t\t\tel.close(el.alertMenu.main);\r\n\t\t});\r\n\r\n\t\t//+++++++++++++ LOBBY MENU\r\n\t\t//leave join in lobby\r\n\t\tel.lobbyMenu.leave.addEventListener('click', () => {\r\n\t\t\tthis.socket.emit('leaveLobby', this.model.getGameId());\r\n\t\t});\r\n\t\t//cancel game in lobby\r\n\t\tel.lobbyMenu.cancel.addEventListener('click', () => {\r\n\t\t\tthis.socket.emit('cancelLobby', this.model.getGameId());\r\n\t\t});\r\n\t\t//start game\r\n\t\tel.lobbyMenu.start.addEventListener('click', () => {\r\n\t\t\tel.close(el.lobbyMenu.main);\r\n\t\t\tthis.socket.emit('startGame', this.model.getGameId());\r\n\t\t});\r\n\r\n\t\t//+++++++++++++ CONTROLS MENU\r\n\t\tel.controlsMenu.back.addEventListener('click', () => {\r\n\t\t\tel.open(el.mainMenu.main);\r\n\t\t\tel.close(el.controlsMenu.main);\r\n\t\t});\r\n\t}\r\n}\r\n","import Point from './Point';\r\n\r\nexport default abstract class RoundObstacle {\r\n\treadonly id: number;\r\n\tprotected changed: boolean = false;\r\n\treadonly x: number;\r\n\treadonly y: number;\r\n\tprotected opacity: number = 1;\r\n\treadonly size: number;\r\n\treadonly radius: number;\r\n\tprivate active: boolean = true;\r\n\r\n\r\n\tconstructor(id: number, x: number, y: number, size: number) {\r\n\t\tthis.id = id;\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.size = size;\r\n\t\tthis.radius = size / 2;\r\n\t}\r\n\r\n\tgetChanged(): boolean {\r\n\t\treturn this.changed;\r\n\t}\r\n\r\n\tnullChanged(): void {\r\n\t\tthis.changed = false;\r\n\t}\r\n\r\n\tupdate(opacity: number): void {\r\n\t\tthis.opacity = opacity;\r\n\t}\r\n\r\n\tisPointIn(point: Point): boolean {\r\n\t\t//triangle\r\n\t\tconst x = this.x + this.radius - point.x;\r\n\t\tconst y = this.y + this.radius - point.y;\r\n\t\tconst radius = Math.sqrt(x * x + y * y);\r\n\t\tif (radius <= this.radius) return true;\r\n\t\treturn false;\r\n\t}\r\n\r\n\tgetCenterX(): number {\r\n\t\treturn this.x + this.size / 2;\r\n\t}\r\n\r\n\tgetCenterY(): number {\r\n\t\treturn this.y + this.size / 2;\r\n\t}\r\n\r\n\tgetOpacity(): number {\r\n\t\treturn this.opacity;\r\n\t}\r\n\r\n\tisActive(): boolean {\r\n\t\treturn this.active;\r\n\t}\r\n}\r\n","import RoundObstacle from './RoundObstacle';\r\n\r\nexport default class Tree extends RoundObstacle {\r\n\treadonly treeTrankRadius: number;\r\n\treadonly angle: number;\r\n\r\n\tconstructor(id: number, x: number, y: number, angle: number) {\r\n\t\tconst size = 500;\r\n\t\tsuper(id, x, y, size);\r\n\t\tthis.treeTrankRadius = 35;\r\n\t\t//this.opacity = 1;\r\n\t\tthis.angle = angle;\r\n\t}\r\n}\r\n","import RoundObstacle from './RoundObstacle';\r\n\r\nexport default class Rock extends RoundObstacle {\r\n\tconstructor(id: number,x: number, y: number) {\r\n\t\tconst size = 100;\r\n\t\tsuper(id, x, y, size);\r\n\t\tthis.opacity = 1;\r\n\t}\r\n}\r\n","import RoundObstacle from './RoundObstacle';\r\n\r\nexport default class Bush extends RoundObstacle {\r\n\treadonly angle: number;\r\n\r\n\tconstructor(id: number, x: number, y: number, angle: number) {\r\n\t\tconst size = 350;\r\n\t\tsuper(id, x, y, size);\r\n\t\t//this.opacity = 1;\r\n\t\tthis.angle = angle;\r\n\t}\r\n}\r\n","import Point from './Point';\r\n\r\nexport default abstract class RectangleObstacle {\r\n\treadonly id: number;\r\n\tprotected changed: boolean = false;\r\n\treadonly x: number;\r\n\treadonly y: number;\r\n\tprotected opacity: number = 1;\r\n\treadonly width: number;\r\n\treadonly height: number;\r\n\tprivate active: boolean = true;\r\n\r\n\tconstructor(id: number, x: number, y: number, width: number, height: number) {\r\n\t\tthis.id = id;\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t}\r\n\r\n\tgetChanged(): boolean {\r\n\t\treturn this.changed;\r\n\t}\r\n\r\n\tnullChanged(): void {\r\n\t\tthis.changed = false;\r\n\t}\r\n\r\n\tgetChangedData(): any {\r\n\t\treturn { id: this.id, opacity: this.opacity };\r\n\t}\r\n\r\n\tupdate(opacity: number): void {\r\n\t\tthis.opacity = opacity;\r\n\t}\r\n\r\n\tisPointIn(point: Point): boolean {\r\n\t\tconst { x, y } = point;\r\n\t\tif (x < this.x + this.width && x >= this.x && y >= this.y && y < this.y + this.height) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tgetOpacity(): number {\r\n\t\treturn this.opacity;\r\n\t}\r\n\r\n\tisActive(): boolean {\r\n\t\treturn this.active;\r\n\t}\r\n\r\n\tacceptHit(): void {\r\n\t\tif (this.active) {\r\n\t\t\tif (this.opacity > 0.1) this.opacity -= 0.1;\r\n\t\t\tif (this.opacity < 0.1) {\r\n\t\t\t\tthis.active = false;\r\n\t\t\t}\r\n\t\t\tthis.changed = true;\r\n\t\t}\r\n\t}\r\n}\r\n","import RectangleObstacle from './RectangleObstacle';\r\n\r\nexport default class Wall extends RectangleObstacle {\r\n\tconstructor(id: number, x: number, y: number, width: number, height: number) {\r\n\t\tsuper(id, x, y, width, height);\r\n\t}\r\n}\r\n","export default class Colors {\r\n\treadonly water: string = '#69A2E0';\r\n\treadonly grass: string = '#A2CB69';\r\n\treadonly blockFrame: string = 'gray';\r\n\treadonly blockFrameActive: string = 'red';\r\n\treadonly bullet: string = 'red';\r\n\treadonly text: string = 'white';\r\n\treadonly collisionPoint: string = 'red';\r\n\treadonly player: string = '#FFC878';\r\n\treadonly hand: string = '#FFC878';\r\n\treadonly handBorder: string = '#424242';\r\n\treadonly vest: string = '#424242';\r\n\treadonly waterCircle: string = '#2871C1';\r\n}\r\n","export default class PartBulletLine {\r\n\treadonly startX: number;\r\n\treadonly startY: number;\r\n\treadonly endX: number;\r\n\treadonly endY: number;\r\n\tprivate active: boolean = true;\r\n\tprivate age: number = 0;\r\n\tprivate maxAge: number = 10;\r\n\r\n\tconstructor(startX: number, startY: number, endX: number, endY: number) {\r\n\t\tthis.startX = startX;\r\n\t\tthis.startY = startY;\r\n\t\tthis.endX = endX;\r\n\t\tthis.endY = endY;\r\n\t}\r\n\r\n\tincreaseAge(): void {\r\n\t\tif (this.age++ === this.maxAge) {\r\n\t\t\tthis.active = false;\r\n\t\t}\r\n\t}\r\n\r\n\tisActive(): boolean {\r\n\t\treturn this.active;\r\n\t}\r\n\r\n\tgetAge(): number {\r\n\t\treturn this.age;\r\n\t}\r\n}\r\n","import PartBulletLine from './PartBulletLine';\r\n\r\nexport default class BulletLine {\r\n\treadonly id: number;\r\n\tprivate startX: number;\r\n\tprivate startY: number;\r\n\tparts: PartBulletLine[] = [];\r\n\r\n\tconstructor(id: number, startX: number, startY: number) {\r\n\t\tthis.id = id;\r\n\t\tthis.startX = startX;\r\n\t\tthis.startY = startY;\r\n\t}\r\n\r\n\tsetEnd(endX: number, endY: number): void {\r\n\t\t//part line\r\n\t\tlet startX = this.startX;\r\n\t\tlet startY = this.startY;\r\n\t\tif (this.parts.length) {\r\n\t\t\tstartX = this.parts[this.parts.length - 1].endX;\r\n\t\t\tstartY = this.parts[this.parts.length - 1].endY;\r\n\t\t}\r\n\t\tthis.parts.push(new PartBulletLine(startX, startY, endX, endY));\r\n\t}\r\n\r\n\tisActive(): boolean {\r\n\t\tif (this.parts.length) {\r\n\t\t\treturn this.parts[this.parts.length - 1].isActive();\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n}\r\n","export default class Point {\r\n\treadonly x: number;\r\n\treadonly y: number;\r\n\r\n\tconstructor(x: number, y: number) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n}\r\n","export default class Scope {\r\n\tprivate loadingMax: number = 40;\r\n\tprivate loading: number = this.loadingMax;\r\n\tprivate scope: number = 0.3; //1\r\n\tprivate scopeLoadingChange: number = 0;\r\n\tprivate scopeResolutionAdjustment: number = 0.3; //1\r\n\r\n\tsetScope(newScope: number): void {\r\n\t\tswitch (newScope) {\r\n\t\t\tcase 2:\r\n\t\t\t\tnewScope = 1.2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tnewScope = 1.4;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 6:\r\n\t\t\t\tnewScope = 1.6;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tconst oldScope = this.scope;\r\n\t\tthis.scope = newScope;\r\n\t\tif (newScope !== oldScope) {\r\n\t\t\tthis.scopeLoadingChange = (newScope - oldScope) / this.loadingMax;\r\n\t\t\tthis.loading = 0;\r\n\t\t}\r\n\t}\r\n\r\n\tgetFinalResolutionAdjustment(resolutionAdjustment: number): number {\r\n\t\tif (this.loading !== this.loadingMax) {\r\n\t\t\tthis.scopeResolutionAdjustment += this.scopeLoadingChange;\r\n\t\t\tthis.loading++;\r\n\t\t}\r\n\t\treturn resolutionAdjustment / this.scopeResolutionAdjustment;\r\n\t}\r\n}\r\n","import Player from './Player';\r\nimport { Weapon } from './Weapon';\r\nimport Map from './Map';\r\nimport { Mouse } from './Controller';\r\nimport WaterTerrainData from './WaterTerrainData';\r\nimport { TerrainType } from './Terrain';\r\nimport RoundObstacle from './RoundObstacle';\r\nimport RectangleObstacle from './RectangleObstacle';\r\nimport Tree from './Tree';\r\nimport Rock from './Rock';\r\nimport Bush from './Bush';\r\nimport Wall from './Wall';\r\nimport ServerClientSync from './ServerClientSync';\r\nimport MyHtmlElements from './MyHtmlElements';\r\nimport Editor from './Editor';\r\nimport Colors from './Colors';\r\nimport BulletLine from './BulletLine';\r\nimport CollisionPoints from './CollisionPoints';\r\nimport Point from './Point';\r\nimport SnapshotManager from './SnapshotManager';\r\nimport { LootType } from './LootType';\r\nimport Scope from './Scope';\r\nimport PlayerStats from './PlayerStats';\r\n\r\ntype DrawData = {\r\n\tx: number;\r\n\ty: number;\r\n\tsize: number;\r\n\twidth: number;\r\n\theight: number;\r\n\tisOnScreen: boolean;\r\n};\r\n\r\ninterface RoundObject {\r\n\tx: number;\r\n\ty: number;\r\n\tsize: number;\r\n}\r\n\r\ninterface RectObject {\r\n\tx: number;\r\n\ty: number;\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\nexport default class View {\r\n\tprivate scope: Scope;\r\n\tprivate snapshotManager: SnapshotManager;\r\n\tprivate gameScreen: HTMLCanvasElement;\r\n\tprivate editorScreen: HTMLCanvasElement;\r\n\tprivate mapScreen: HTMLCanvasElement;\r\n\tprivate helperScreen: HTMLCanvasElement;\r\n\tprivate ctxGame: CanvasRenderingContext2D;\r\n\tprivate ctxMap: CanvasRenderingContext2D;\r\n\tprivate ctxEditor: CanvasRenderingContext2D;\r\n\tprivate bushSVG: HTMLImageElement;\r\n\tprivate rockSVG: HTMLImageElement;\r\n\tprivate treeSVG: HTMLImageElement;\r\n\tprivate horizontalWallSVG: HTMLImageElement;\r\n\tprivate verticalWallSVG: HTMLImageElement;\r\n\tprivate pistolSVG: HTMLImageElement;\r\n\tprivate machinegunSVG: HTMLImageElement;\r\n\tprivate shotgunSVG: HTMLImageElement;\r\n\tprivate rifleSVG: HTMLImageElement;\r\n\tprivate hammerSVG: HTMLImageElement;\r\n\tprivate cursorSVG: HTMLImageElement;\r\n\tprivate granadeSVG: HTMLImageElement;\r\n\tprivate smokeSVG: HTMLImageElement;\r\n\tprivate medkitSVG: HTMLImageElement;\r\n\tprivate smokeCloudSVG: HTMLImageElement;\r\n\tprivate loadingProgresSVG: HTMLImageElement;\r\n\tprivate loadingCircleSVG: HTMLImageElement;\r\n\tprivate waterTrianglePNG: HTMLImageElement;\r\n\tprivate pistolLootSVG: HTMLImageElement;\r\n\tprivate shotgunLootSVG: HTMLImageElement;\r\n\tprivate machinegunLootSVG: HTMLImageElement;\r\n\tprivate rifleLootSVG: HTMLImageElement;\r\n\tprivate hammerLootSVG: HTMLImageElement;\r\n\tprivate granadeLootSVG: HTMLImageElement;\r\n\tprivate smokeLootSVG: HTMLImageElement;\r\n\tprivate redAmmoLootSVG: HTMLImageElement;\r\n\tprivate greenAmmoLootSVG: HTMLImageElement;\r\n\tprivate blueAmmoLootSVG: HTMLImageElement;\r\n\tprivate orangeAmmoLootSVG: HTMLImageElement;\r\n\tprivate medkitLootSVG: HTMLImageElement;\r\n\tprivate vestLootSVG: HTMLImageElement;\r\n\tprivate scope2LootSVG: HTMLImageElement;\r\n\tprivate scope4LootSVG: HTMLImageElement;\r\n\tprivate scope6LootSVG: HTMLImageElement;\r\n\tprivate deadPlayer: HTMLImageElement;\r\n\tprivate waterTerrainData: WaterTerrainData;\r\n\tprivate resolutionAdjustment: number = 1;\r\n\tprivate finalResolutionAdjustment: number = 1;\r\n\tprivate screenCenterX: number;\r\n\tprivate screenCenterY: number;\r\n\tprivate map: Map;\r\n\tprivate mouse: Mouse;\r\n\tmyPlayer: Player;\r\n\tprivate myHtmlElements: MyHtmlElements;\r\n\tprivate colors: Colors;\r\n\tprivate bulletLines: BulletLine[] = [];\r\n\tprivate collisionPoints: CollisionPoints;\r\n\r\n\tprivate lastdrawTime = Date.now();\r\n\r\n\tconstructor(\r\n\t\tmap: Map,\r\n\t\tmouse: Mouse,\r\n\t\twaterTerrainData: WaterTerrainData,\r\n\t\tmyHtmlElements: MyHtmlElements,\r\n\t\tcollisionPoints: CollisionPoints,\r\n\t\tsnapshotManager: SnapshotManager\r\n\t) {\r\n\t\tthis.scope = new Scope();\r\n\t\tthis.snapshotManager = snapshotManager;\r\n\t\tthis.colors = new Colors();\r\n\t\tthis.myHtmlElements = myHtmlElements;\r\n\t\tthis.map = map;\r\n\t\tthis.collisionPoints = collisionPoints;\r\n\t\tthis.mouse = mouse;\r\n\t\tthis.gameScreen = <HTMLCanvasElement>this.myHtmlElements.gameScreen;\r\n\t\tthis.editorScreen = <HTMLCanvasElement>this.myHtmlElements.editor.screen;\r\n\t\tthis.mapScreen = <HTMLCanvasElement>this.myHtmlElements.mapScreen;\r\n\t\tthis.helperScreen = <HTMLCanvasElement>this.myHtmlElements.helperScreen;\r\n\t\tthis.ctxGame = this.gameScreen.getContext('2d');\r\n\t\tthis.ctxMap = this.mapScreen.getContext('2d');\r\n\t\tthis.ctxEditor = this.editorScreen.getContext('2d');\r\n\r\n\t\tthis.horizontalWallSVG = new Image();\r\n\t\tthis.horizontalWallSVG.src = 'img/horizontalWall.svg';\r\n\r\n\t\tthis.verticalWallSVG = new Image();\r\n\t\tthis.verticalWallSVG.src = 'img/verticalWall.svg';\r\n\r\n\t\tthis.bushSVG = new Image();\r\n\t\tthis.bushSVG.src = 'img/bush.svg';\r\n\r\n\t\tthis.rockSVG = new Image();\r\n\t\tthis.rockSVG.src = 'img/rock.svg';\r\n\r\n\t\tthis.treeSVG = new Image();\r\n\t\tthis.treeSVG.src = 'img/tree.svg';\r\n\r\n\t\tthis.cursorSVG = new Image();\r\n\t\tthis.cursorSVG.src = 'img/cursor.svg';\r\n\r\n\t\tthis.loadingProgresSVG = new Image();\r\n\t\tthis.loadingProgresSVG.src = 'img/loadingProgres.svg';\r\n\r\n\t\tthis.loadingCircleSVG = new Image();\r\n\t\tthis.loadingCircleSVG.src = 'img/loadingCircle.svg';\r\n\r\n\t\tthis.pistolSVG = new Image();\r\n\t\tthis.pistolSVG.src = 'img/pistol.svg';\r\n\r\n\t\tthis.machinegunSVG = new Image();\r\n\t\tthis.machinegunSVG.src = 'img/machinegun.svg';\r\n\r\n\t\tthis.rifleSVG = new Image();\r\n\t\tthis.rifleSVG.src = 'img/rifle.svg';\r\n\r\n\t\tthis.shotgunSVG = new Image();\r\n\t\tthis.shotgunSVG.src = 'img/shotgun.svg';\r\n\r\n\t\tthis.hammerSVG = new Image();\r\n\t\tthis.hammerSVG.src = 'img/hammer.svg';\r\n\r\n\t\tthis.granadeSVG = new Image();\r\n\t\tthis.granadeSVG.src = 'img/granade.svg';\r\n\r\n\t\tthis.smokeSVG = new Image();\r\n\t\tthis.smokeSVG.src = 'img/smoke.svg';\r\n\r\n\t\tthis.medkitSVG = new Image();\r\n\t\tthis.medkitSVG.src = 'img/medkit.svg';\r\n\r\n\t\tthis.smokeCloudSVG = new Image();\r\n\t\tthis.smokeCloudSVG.src = 'img/smokeCloud.svg';\r\n\r\n\t\tthis.rifleLootSVG = new Image();\r\n\t\tthis.rifleLootSVG.src = 'img/rifleLoot.svg';\r\n\r\n\t\tthis.pistolLootSVG = new Image();\r\n\t\tthis.pistolLootSVG.src = 'img/pistolLoot.svg';\r\n\r\n\t\tthis.shotgunLootSVG = new Image();\r\n\t\tthis.shotgunLootSVG.src = 'img/shotgunLoot.svg';\r\n\r\n\t\tthis.machinegunLootSVG = new Image();\r\n\t\tthis.machinegunLootSVG.src = 'img/machinegunLoot.svg';\r\n\r\n\t\tthis.hammerLootSVG = new Image();\r\n\t\tthis.hammerLootSVG.src = 'img/hammerLoot.svg';\r\n\r\n\t\tthis.granadeLootSVG = new Image();\r\n\t\tthis.granadeLootSVG.src = 'img/granadeLoot.svg';\r\n\r\n\t\tthis.smokeLootSVG = new Image();\r\n\t\tthis.smokeLootSVG.src = 'img/smokeLoot.svg';\r\n\r\n\t\tthis.redAmmoLootSVG = new Image();\r\n\t\tthis.redAmmoLootSVG.src = 'img/redAmmoLoot.svg';\r\n\r\n\t\tthis.greenAmmoLootSVG = new Image();\r\n\t\tthis.greenAmmoLootSVG.src = 'img/greenAmmoLoot.svg';\r\n\r\n\t\tthis.blueAmmoLootSVG = new Image();\r\n\t\tthis.blueAmmoLootSVG.src = 'img/blueAmmoLoot.svg';\r\n\r\n\t\tthis.orangeAmmoLootSVG = new Image();\r\n\t\tthis.orangeAmmoLootSVG.src = 'img/orangeAmmoLoot.svg';\r\n\r\n\t\tthis.medkitLootSVG = new Image();\r\n\t\tthis.medkitLootSVG.src = 'img/medkitLoot.svg';\r\n\t\tthis.vestLootSVG = new Image();\r\n\t\tthis.vestLootSVG.src = 'img/vestLoot.svg';\r\n\t\tthis.scope2LootSVG = new Image();\r\n\t\tthis.scope2LootSVG.src = 'img/scope2Loot.svg';\r\n\t\tthis.scope4LootSVG = new Image();\r\n\t\tthis.scope4LootSVG.src = 'img/scope4Loot.svg';\r\n\t\tthis.scope6LootSVG = new Image();\r\n\t\tthis.scope6LootSVG.src = 'img/scope6Loot.svg';\r\n\r\n\t\tthis.deadPlayer = new Image();\r\n\t\tthis.deadPlayer.src = 'img/deadPlayer.svg';\r\n\r\n\t\tthis.waterTrianglePNG = new Image();\r\n\t\tthis.waterTrianglePNG.src = 'img/waterTriangle.png';\r\n\r\n\t\tthis.waterTerrainData = waterTerrainData;\r\n\r\n\t\t/*\r\n\t\t//water data\r\n\t\tthis.waterTrianglePNG.onload = () => {\r\n\t\t\tthis.saveWaterPixels(TerrainType.WaterTriangle1);\r\n\t\t\tthis.saveWaterPixels(TerrainType.WaterTriangle2);\r\n\t\t\tthis.saveWaterPixels(TerrainType.WaterTriangle3);\r\n\t\t\tthis.saveWaterPixels(TerrainType.WaterTriangle4);\r\n\t\t\tthis.waterTerrainData.write();\r\n\t\t};\r\n\t\t*/\r\n\r\n\t\tthis.screenResize();\r\n\t}\r\n\r\n\treset(): void {\r\n\t\tthis.myPlayer = null;\r\n\t\tthis.scope = new Scope();\r\n\t}\r\n\r\n\tscreenResize(): void {\r\n\t\tconst el = this.myHtmlElements;\r\n\t\t//gameScreen\r\n\t\tthis.gameScreen.width = window.innerWidth;\r\n\t\tthis.gameScreen.height = window.innerHeight;\r\n\t\tel.zoneSVG.setAttribute('width', window.innerWidth.toString());\r\n\t\tel.zoneSVG.setAttribute('height', window.innerHeight.toString());\r\n\t\t//mapScreen\r\n\t\tconst mapSize = Math.floor((window.innerWidth / 5 + window.innerHeight / 5) / 2);\r\n\t\tthis.mapScreen.width = mapSize;\r\n\t\tthis.mapScreen.height = mapSize;\r\n\t\tel.mapZoneSVG.setAttribute('width', mapSize.toString());\r\n\t\tel.mapZoneSVG.setAttribute('height', mapSize.toString());\r\n\t\tel.mapContainer.style.width = (mapSize + 10).toString() + 'px';\r\n\t\tel.mapContainer.style.height = (mapSize + 10).toString() + 'px';\r\n\t\t//center\r\n\t\tthis.screenCenterX = window.innerWidth / 2;\r\n\t\tthis.screenCenterY = window.innerHeight / 2;\r\n\t\tthis.changeResolutionAdjustment();\r\n\t\tif (this.myPlayer) {\r\n\t\t\tthis.drawGame(this.myPlayer.id);\r\n\t\t}\r\n\t}\r\n\r\n\tcalculateServerPosition(point: Point): Point {\r\n\t\tlet x, y;\r\n\t\tif (this.screenCenterX > point.x) {\r\n\t\t\tx = (this.screenCenterX - point.x) * -1;\r\n\t\t} else {\r\n\t\t\tx = point.x - this.screenCenterX;\r\n\t\t}\r\n\t\tif (this.screenCenterY > point.y) {\r\n\t\t\ty = (this.screenCenterY - point.y) * -1;\r\n\t\t} else {\r\n\t\t\ty = point.y - this.screenCenterY;\r\n\t\t}\r\n\t\tx /= this.finalResolutionAdjustment;\r\n\t\ty /= this.finalResolutionAdjustment;\r\n\t\tx += this.myPlayer.getCenterX();\r\n\t\ty += this.myPlayer.getCenterY();\r\n\t\treturn new Point(x, y);\r\n\t}\r\n\r\n\t/*\r\n\tprivate isPointInZone(serverPoint: Point, zoneSnapshot: ZoneSnapshot): boolean {\r\n\t\t//triangle\r\n\t\tconst x = zoneSnapshot.oX - serverPoint.x;\r\n\t\tconst y = zoneSnapshot.oY - serverPoint.y;\r\n\t\tconst radius = Math.sqrt(x * x + y * y);\r\n\t\tif (radius <= zoneSnapshot.oR) return true;\r\n\t\treturn false;\r\n\t}\r\n\t*/\r\n\r\n\tprivate changeResolutionAdjustment(): void {\r\n\t\tconst defaultWidth = 1920;\r\n\t\tconst defaultHeight = 1050;\r\n\t\tconst width = this.gameScreen.width / defaultWidth;\r\n\t\tconst height = this.gameScreen.height / defaultHeight;\r\n\t\tconst finalAdjustment = (width + height) / 2;\r\n\t\tthis.resolutionAdjustment = finalAdjustment;\r\n\t}\r\n\r\n\tprivate saveWaterPixels(waterType: TerrainType): void {\r\n\t\tconst ctx = this.helperScreen.getContext('2d');\r\n\t\tthis.helperScreen.width = this.waterTrianglePNG.width;\r\n\t\tthis.helperScreen.height = this.waterTrianglePNG.height;\r\n\t\t//white background\r\n\t\tctx.fillStyle = '#FFFFFF';\r\n\t\tctx.fillRect(0, 0, this.helperScreen.width, this.helperScreen.height);\r\n\t\tlet middleImage = this.waterTrianglePNG.width / 2;\r\n\t\tctx.save();\r\n\t\tctx.translate(middleImage, middleImage);\r\n\t\tswitch (waterType) {\r\n\t\t\tcase TerrainType.WaterTriangle1:\r\n\t\t\t\tctx.rotate((0 * Math.PI) / 180);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle2:\r\n\t\t\t\tctx.rotate((90 * Math.PI) / 180);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle3:\r\n\t\t\t\tctx.rotate((180 * Math.PI) / 180);\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle4:\r\n\t\t\t\tctx.rotate((270 * Math.PI) / 180);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tctx.drawImage(this.waterTrianglePNG, -middleImage, -middleImage);\r\n\t\tctx.restore();\r\n\r\n\t\t//worker\r\n\t\tif (typeof Worker !== 'undefined') {\r\n\t\t\tconst worker = new Worker('js/workerFindWater.js');\r\n\t\t\tworker.onmessage = (e) => {\r\n\t\t\t\tthis.waterTerrainData.setData(e.data.type, e.data.data);\r\n\t\t\t};\r\n\t\t\tconst data = ctx.getImageData(0, 0, this.waterTrianglePNG.width, this.waterTrianglePNG.height).data;\r\n\t\t\tworker.postMessage({\r\n\t\t\t\tdata,\r\n\t\t\t\tsize: this.waterTrianglePNG.width,\r\n\t\t\t\ttype: waterType,\r\n\t\t\t\ttime: new Date().getTime(),\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.log(\"err: Your browser doesn't support web workers.\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate drawMap(): void {\r\n\t\tconst ctx = this.ctxMap;\r\n\t\tconst el = this.myHtmlElements;\r\n\t\t//clear canvas\r\n\t\tctx.clearRect(0, 0, this.mapScreen.width, this.mapScreen.height);\r\n\t\t//background\r\n\t\tctx.fillStyle = this.colors.grass;\r\n\t\tctx.fillRect(0, 0, this.mapScreen.width, this.mapScreen.height);\r\n\t\tconst blockSize = this.mapScreen.width / (this.map.getSize() / this.map.getBlockSize());\r\n\t\tconst sizeReduction = blockSize / this.map.getBlockSize();\r\n\t\tconst biggerBlockSize = blockSize + blockSize / 50;\r\n\t\t//terrain\r\n\t\tfor (const terrain of this.map.terrain) {\r\n\t\t\tconst x = terrain.x * sizeReduction;\r\n\t\t\tconst y = terrain.y * sizeReduction;\r\n\t\t\tif (terrain.type === TerrainType.Water) {\r\n\t\t\t\tctx.fillStyle = this.colors.water;\r\n\t\t\t\tctx.fillRect(x, y, biggerBlockSize, biggerBlockSize);\r\n\t\t\t}\r\n\t\t\tif (terrain.type !== TerrainType.Water) {\r\n\t\t\t\tconst middleImage = biggerBlockSize / 2;\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\tctx.rotate((terrain.angle * Math.PI) / 180);\r\n\t\t\t\tctx.drawImage(this.waterTrianglePNG, -middleImage, -middleImage, blockSize, blockSize);\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\t\t//player\r\n\t\t{\r\n\t\t\tconst playerSize = this.mapScreen.width / 30;\r\n\t\t\tconst x = this.myPlayer.getCenterX() * sizeReduction;\r\n\t\t\tconst y = this.myPlayer.getCenterY() * sizeReduction;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(x, y, playerSize / 2, 0, 2 * Math.PI);\r\n\t\t\tctx.fillStyle = 'red';\r\n\t\t\tctx.fill();\r\n\t\t}\r\n\t\t//zone\r\n\t\t//inner\r\n\t\t{\r\n\t\t\tconst x = this.snapshotManager.zone.innerCircle.getCenterX() * sizeReduction;\r\n\t\t\tconst y = this.snapshotManager.zone.innerCircle.getCenterY() * sizeReduction;\r\n\t\t\tconst radius = this.snapshotManager.zone.innerCircle.getRadius() * sizeReduction;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(x, y, radius, 0, 2 * Math.PI);\r\n\t\t\tctx.strokeStyle = 'green';\r\n\t\t\tctx.stroke();\r\n\t\t}\r\n\t\t//outer\r\n\t\t{\r\n\t\t\tconst x = this.snapshotManager.zone.outerCircle.getCenterX() * sizeReduction;\r\n\t\t\tconst y = this.snapshotManager.zone.outerCircle.getCenterY() * sizeReduction;\r\n\t\t\tconst radius = this.snapshotManager.zone.outerCircle.getRadius() * sizeReduction;\r\n\t\t\t//SVG change\r\n\t\t\tel.mapZoneCircle.setAttribute('r', radius.toString());\r\n\t\t\tel.mapZoneCircle.setAttribute('cx', x.toString());\r\n\t\t\tel.mapZoneCircle.setAttribute('cy', y.toString());\r\n\t\t}\r\n\t}\r\n\r\n\tdrawEditor(editor: Editor): void {\r\n\t\tconst ctx = this.ctxEditor;\r\n\t\t//clear canvas\r\n\t\tctx.clearRect(0, 0, this.editorScreen.width, this.editorScreen.height);\r\n\r\n\t\t//grass\r\n\t\tctx.fillStyle = this.colors.grass;\r\n\t\tctx.fillRect(0, 0, this.editorScreen.width, this.editorScreen.height);\r\n\r\n\t\t//terrain blocks\r\n\t\tctx.fillStyle = this.colors.water;\r\n\t\tfor (const terrain of editor.terrains) {\r\n\t\t\tswitch (terrain.type) {\r\n\t\t\t\tcase TerrainType.Water:\r\n\t\t\t\t\tctx.fillRect(terrain.x, terrain.y, editor.blockSize, editor.blockSize);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase TerrainType.WaterTriangle1:\r\n\t\t\t\t\tctx.drawImage(this.waterTrianglePNG, terrain.x, terrain.y, editor.blockSize, editor.blockSize);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase TerrainType.WaterTriangle2:\r\n\t\t\t\tcase TerrainType.WaterTriangle3:\r\n\t\t\t\tcase TerrainType.WaterTriangle4:\r\n\t\t\t\t\tlet middleImage = editor.blockSize / 2;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.translate(terrain.x + middleImage, terrain.y + middleImage);\r\n\t\t\t\t\tctx.rotate((terrain.angle * Math.PI) / 180);\r\n\t\t\t\t\tctx.drawImage(this.waterTrianglePNG, -middleImage, -middleImage, editor.blockSize, editor.blockSize);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//terrain blocks under mouse\r\n\t\tlet blockX, blockY;\r\n\t\tif (editor.getTerrainType() != null) {\r\n\t\t\t//x, y to [blocks]\r\n\t\t\tblockX = Math.floor(editor.getX() / editor.blockSize) * editor.blockSize;\r\n\t\t\tblockY = Math.floor(editor.getY() / editor.blockSize) * editor.blockSize;\r\n\t\t\tlet angle = -1;\r\n\t\t\tswitch (editor.getTerrainType()) {\r\n\t\t\t\tcase TerrainType.Water:\r\n\t\t\t\t\tctx.fillStyle = this.colors.water;\r\n\t\t\t\t\tctx.fillRect(blockX, blockY, editor.blockSize, editor.blockSize);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase TerrainType.Grass:\r\n\t\t\t\t\tctx.fillStyle = this.colors.grass;\r\n\t\t\t\t\tctx.fillRect(blockX, blockY, editor.blockSize, editor.blockSize);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase TerrainType.WaterTriangle1:\r\n\t\t\t\t\tangle = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase TerrainType.WaterTriangle2:\r\n\t\t\t\t\tangle = 90;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase TerrainType.WaterTriangle3:\r\n\t\t\t\t\tangle = 180;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase TerrainType.WaterTriangle4:\r\n\t\t\t\t\tangle = 270;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (angle !== -1) {\r\n\t\t\t\t//grass\r\n\t\t\t\tctx.fillStyle = this.colors.grass;\r\n\t\t\t\tctx.fillRect(blockX, blockY, editor.blockSize, editor.blockSize);\r\n\t\t\t\tlet middleImage = editor.blockSize / 2;\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.translate(blockX + middleImage, blockY + middleImage);\r\n\t\t\t\tctx.rotate((angle * Math.PI) / 180);\r\n\t\t\t\tctx.drawImage(this.waterTrianglePNG, -middleImage, -middleImage, editor.blockSize, editor.blockSize);\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//mapGrid\r\n\t\tctx.fillStyle = this.colors.blockFrame;\r\n\t\tfor (let i = 0; i < editor.getSize(); i++) {\r\n\t\t\tctx.fillRect(i * editor.blockSize, 0, 1, editor.getSize() * editor.blockSize);\r\n\t\t}\r\n\t\tfor (let i = 0; i < editor.getSize(); i++) {\r\n\t\t\tctx.fillRect(0, i * editor.blockSize, editor.getSize() * editor.blockSize, 1);\r\n\t\t}\r\n\r\n\t\tif (editor.getTerrainType() != null) {\r\n\t\t\t//frame\r\n\t\t\tctx.fillStyle = this.colors.blockFrameActive;\r\n\t\t\tctx.fillRect(blockX, blockY, editor.blockSize, 1);\r\n\t\t\tctx.fillRect(blockX, blockY + editor.blockSize, editor.blockSize, 1);\r\n\r\n\t\t\tctx.fillRect(blockX, blockY, 1, editor.blockSize);\r\n\t\t\tctx.fillRect(blockX + editor.blockSize, blockY, 1, editor.blockSize);\r\n\t\t}\r\n\r\n\t\t//objects\r\n\t\tctx.save();\r\n\t\tif (editor.getObjectType() === 'delete') ctx.globalAlpha = 0.6;\r\n\r\n\t\tfor (const rock of editor.rocks) {\r\n\t\t\tctx.drawImage(this.rockSVG, rock.x, rock.y, rock.size, rock.size);\r\n\t\t}\r\n\r\n\t\tfor (const wall of editor.walls) {\r\n\t\t\tlet svgSource = this.horizontalWallSVG;\r\n\t\t\tif (wall.width < wall.height) svgSource = this.verticalWallSVG;\r\n\t\t\tif (wall.width < wall.height || wall.width > wall.height) {\r\n\t\t\t\tctx.drawImage(svgSource, wall.x, wall.y, wall.width, wall.height);\r\n\t\t\t}\r\n\t\t\tif (wall.width === wall.height) {\r\n\t\t\t\tctx.fillStyle = 'black';\r\n\t\t\t\tctx.fillRect(wall.x, wall.y, wall.width, wall.height);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (const bush of editor.bushes) {\r\n\t\t\tctx.drawImage(this.bushSVG, bush.x, bush.y, bush.size, bush.size);\r\n\t\t}\r\n\t\tfor (const tree of editor.trees) {\r\n\t\t\tctx.drawImage(this.treeSVG, tree.x, tree.y, tree.size, tree.size);\r\n\t\t}\r\n\t\tctx.restore();\r\n\r\n\t\tif (editor.getObjectType() === 'delete') {\r\n\t\t\t//delete object\r\n\t\t\tlet deleteObject;\r\n\t\t\tfor (const rock of editor.rocks) {\r\n\t\t\t\tconst object = rock;\r\n\t\t\t\tif (\r\n\t\t\t\t\tobject.x <= editor.getX() &&\r\n\t\t\t\t\tobject.x + object.size >= editor.getX() &&\r\n\t\t\t\t\tobject.y <= editor.getY() &&\r\n\t\t\t\t\tobject.y + object.size >= editor.getY()\r\n\t\t\t\t) {\r\n\t\t\t\t\tdeleteObject = object;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (const wall of editor.walls) {\r\n\t\t\t\tconst object = wall;\r\n\t\t\t\tif (\r\n\t\t\t\t\tobject.x <= editor.getX() &&\r\n\t\t\t\t\tobject.x + object.width >= editor.getX() &&\r\n\t\t\t\t\tobject.y <= editor.getY() &&\r\n\t\t\t\t\tobject.y + object.height >= editor.getY()\r\n\t\t\t\t) {\r\n\t\t\t\t\tdeleteObject = object;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (const bush of editor.bushes) {\r\n\t\t\t\tconst object = bush;\r\n\t\t\t\tif (\r\n\t\t\t\t\tobject.x <= editor.getX() &&\r\n\t\t\t\t\tobject.x + object.size >= editor.getX() &&\r\n\t\t\t\t\tobject.y <= editor.getY() &&\r\n\t\t\t\t\tobject.y + object.size >= editor.getY()\r\n\t\t\t\t) {\r\n\t\t\t\t\tdeleteObject = object;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (const tree of editor.trees) {\r\n\t\t\t\tconst object = tree;\r\n\t\t\t\tif (\r\n\t\t\t\t\tobject.x <= editor.getX() &&\r\n\t\t\t\t\tobject.x + object.size >= editor.getX() &&\r\n\t\t\t\t\tobject.y <= editor.getY() &&\r\n\t\t\t\t\tobject.y + object.size >= editor.getY()\r\n\t\t\t\t) {\r\n\t\t\t\t\tdeleteObject = object;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (deleteObject instanceof Rock) {\r\n\t\t\t\tctx.drawImage(this.rockSVG, deleteObject.x, deleteObject.y, deleteObject.size, deleteObject.size);\r\n\t\t\t}\r\n\t\t\tif (deleteObject instanceof Bush) {\r\n\t\t\t\tctx.drawImage(this.bushSVG, deleteObject.x, deleteObject.y, deleteObject.size, deleteObject.size);\r\n\t\t\t}\r\n\t\t\tif (deleteObject instanceof Tree) {\r\n\t\t\t\tctx.drawImage(this.treeSVG, deleteObject.x, deleteObject.y, deleteObject.size, deleteObject.size);\r\n\t\t\t}\r\n\t\t\tif (deleteObject instanceof Wall) {\r\n\t\t\t\tctx.fillRect(deleteObject.x, deleteObject.y, deleteObject.width, deleteObject.height);\r\n\t\t\t\tlet wallSVG = this.verticalWallSVG;\r\n\t\t\t\tif (deleteObject.width > deleteObject.height) {\r\n\t\t\t\t\twallSVG = this.horizontalWallSVG;\r\n\t\t\t\t}\r\n\t\t\t\tctx.drawImage(wallSVG, deleteObject.x, deleteObject.y, deleteObject.width, deleteObject.height);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//objects under mouse\r\n\t\tif (editor.getObjectType()) {\r\n\t\t\tlet size;\r\n\t\t\tswitch (editor.getObjectType()) {\r\n\t\t\t\tcase 'bush':\r\n\t\t\t\t\tsize = editor.bush.size;\r\n\t\t\t\t\tctx.drawImage(this.bushSVG, editor.getX() - size / 2, editor.getY() - size / 2, size, size);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'rock':\r\n\t\t\t\t\tsize = editor.rock.size;\r\n\t\t\t\t\tctx.drawImage(this.rockSVG, editor.getX() - size / 2, editor.getY() - size / 2, size, size);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'tree':\r\n\t\t\t\t\tsize = editor.tree.size;\r\n\t\t\t\t\tctx.drawImage(this.treeSVG, editor.getX() - size / 2, editor.getY() - size / 2, size, size);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'rect':\r\n\t\t\t\t\tsize = editor.rock.size;\r\n\t\t\t\t\tctx.fillStyle = 'black';\r\n\t\t\t\t\tctx.fillRect(editor.getX() - size / 2, editor.getY() - size / 2, size, size);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'verticalWall':\r\n\t\t\t\t\tctx.drawImage(\r\n\t\t\t\t\t\tthis.verticalWallSVG,\r\n\t\t\t\t\t\teditor.getX() - editor.verticalWall.width / 2,\r\n\t\t\t\t\t\teditor.getY() - editor.verticalWall.height / 2,\r\n\t\t\t\t\t\teditor.verticalWall.width,\r\n\t\t\t\t\t\teditor.verticalWall.height\r\n\t\t\t\t\t);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'horizontalWall':\r\n\t\t\t\t\tctx.drawImage(\r\n\t\t\t\t\t\tthis.horizontalWallSVG,\r\n\t\t\t\t\t\teditor.getX() - editor.horizontalWall.width / 2,\r\n\t\t\t\t\t\teditor.getY() - editor.horizontalWall.height / 2,\r\n\t\t\t\t\t\teditor.horizontalWall.width,\r\n\t\t\t\t\t\teditor.horizontalWall.height\r\n\t\t\t\t\t);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate frameRateAdjuster() {\r\n\t\tconst now = Date.now();\r\n\t\tconst delayFromLastFrame = now - this.lastdrawTime;\r\n\t\tconst defaultDelayBetweenFrame = 16.66666;\r\n\t\tthis.lastdrawTime = now;\r\n\t\treturn delayFromLastFrame / defaultDelayBetweenFrame;\r\n\t}\r\n\r\n\tprivate isPlayerUnderRoundObject(player: Player, roudObject: Tree | Bush): boolean {\r\n\t\t//triangle\r\n\t\tconst x = player.getCenterX() - roudObject.getCenterX();\r\n\t\tconst y = player.getCenterY() - roudObject.getCenterY();\r\n\t\tconst radius = Math.sqrt(x * x + y * y);\r\n\t\treturn radius < player.radius + roudObject.radius;\r\n\t}\r\n\r\n\tdrawGame(myPlayerId: number): void {\r\n\t\tconst betweenSnapshot = this.snapshotManager.betweenSnapshot;\r\n\t\tconst players = this.snapshotManager.players;\r\n\t\tif (!betweenSnapshot) return;\r\n\r\n\t\t//spectate\r\n\t\tif (betweenSnapshot.i.spectate !== -1) {\r\n\t\t\tmyPlayerId = betweenSnapshot.i.spectate;\r\n\t\t}\r\n\r\n\t\t//my player or spectate\r\n\t\tfor (const player of players) {\r\n\t\t\tif (player.id === myPlayerId) {\r\n\t\t\t\tthis.myPlayer = player;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!this.myPlayer) return;\r\n\r\n\t\t//scope\r\n\t\tthis.scope.setScope(this.snapshotManager.betweenSnapshot.i.s);\r\n\t\tthis.finalResolutionAdjustment = this.scope.getFinalResolutionAdjustment(this.resolutionAdjustment);\r\n\r\n\t\tthis.drawMap();\r\n\r\n\t\tconst ctx = this.ctxGame;\r\n\t\tconst el = this.myHtmlElements;\r\n\r\n\t\t//clear canvas\r\n\t\tctx.clearRect(0, 0, this.gameScreen.width, this.gameScreen.height);\r\n\r\n\t\t//water\r\n\t\tctx.fillStyle = this.colors.water;\r\n\t\tctx.fillRect(0, 0, this.gameScreen.width, this.gameScreen.height);\r\n\r\n\t\t//grass blocks\r\n\t\tctx.fillStyle = this.colors.grass;\r\n\t\tconst blockSize = 300;\r\n\t\tfor (const block of this.map.blocks) {\r\n\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({ x: block.x, y: block.y, size: blockSize });\r\n\t\t\tif (isOnScreen) {\r\n\t\t\t\tctx.fillRect(x, y, size, size);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//water terrain blocks\r\n\t\tctx.fillStyle = this.colors.water;\r\n\t\tfor (const terrain of this.map.terrain) {\r\n\t\t\tconst { x, y, width, height, isOnScreen } = this.howToDraw({\r\n\t\t\t\tx: terrain.x,\r\n\t\t\t\ty: terrain.y,\r\n\t\t\t\tsize: terrain.size,\r\n\t\t\t});\r\n\t\t\tif (isOnScreen) {\r\n\t\t\t\tif (terrain.type === TerrainType.Water) {\r\n\t\t\t\t\tctx.fillRect(x, y, width, height);\r\n\t\t\t\t} else if (terrain.type === TerrainType.WaterTriangle1) {\r\n\t\t\t\t\tctx.drawImage(this.waterTrianglePNG, x, y, width, height);\r\n\t\t\t\t} else if (\r\n\t\t\t\t\tterrain.type === TerrainType.WaterTriangle2 ||\r\n\t\t\t\t\tterrain.type === TerrainType.WaterTriangle3 ||\r\n\t\t\t\t\tterrain.type === TerrainType.WaterTriangle4\r\n\t\t\t\t) {\r\n\t\t\t\t\tlet middleImage = width / 2;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\t\tctx.rotate((terrain.angle * Math.PI) / 180);\r\n\t\t\t\t\tctx.drawImage(this.waterTrianglePNG, -middleImage, -middleImage, width, height);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//water circles\r\n\t\tctx.fillStyle = this.colors.waterCircle;\r\n\r\n\t\tconst adjustFrameRate = this.frameRateAdjuster();\r\n\t\tfor (const waterCircle of this.snapshotManager.waterCircles) {\r\n\t\t\tif (!waterCircle.isActive()) continue;\r\n\t\t\twaterCircle.flow(adjustFrameRate);\r\n\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\tx: waterCircle.getX(),\r\n\t\t\t\ty: waterCircle.getY(),\r\n\t\t\t\tsize: waterCircle.getSize(),\r\n\t\t\t});\r\n\t\t\tif (isOnScreen) {\r\n\t\t\t\tconst radius = size / 2;\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.globalAlpha = waterCircle.getOpacity();\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.arc(x + radius, y + radius, radius, 0, 2 * Math.PI);\r\n\t\t\t\tctx.fill();\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//mapGrid\r\n\t\tctx.fillStyle = this.colors.blockFrame;\r\n\t\tconst size2 = 1 * this.resolutionAdjustment;\r\n\t\tfor (const block of this.map.blocks) {\r\n\t\t\t//top\r\n\t\t\tif (block.y === 0) {\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\tx: block.x,\r\n\t\t\t\t\ty: block.y,\r\n\t\t\t\t\tsize: blockSize,\r\n\t\t\t\t});\r\n\t\t\t\tif (isOnScreen) ctx.fillRect(x, y, size, size2);\r\n\t\t\t}\r\n\t\t\t//bottom\r\n\t\t\t{\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\tx: block.x,\r\n\t\t\t\t\ty: block.y + blockSize,\r\n\t\t\t\t\tsize: blockSize,\r\n\t\t\t\t});\r\n\t\t\t\tif (isOnScreen) ctx.fillRect(x, y, size, size2);\r\n\t\t\t}\r\n\t\t\t//left\r\n\t\t\tif (block.x === 0) {\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\tx: block.x,\r\n\t\t\t\t\ty: block.y,\r\n\t\t\t\t\tsize: blockSize,\r\n\t\t\t\t});\r\n\t\t\t\tif (isOnScreen) ctx.fillRect(x, y, size2, size);\r\n\t\t\t}\r\n\t\t\t//right\r\n\t\t\t{\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\tx: block.x + blockSize,\r\n\t\t\t\t\ty: block.y,\r\n\t\t\t\t\tsize: blockSize,\r\n\t\t\t\t});\r\n\t\t\t\tif (isOnScreen) ctx.fillRect(x, y, size2, size);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//rocks\r\n\t\tfor (const rock of this.map.rocks) {\r\n\t\t\tif (rock.isActive()) {\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw(rock);\r\n\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.globalAlpha = rock.getOpacity();\r\n\t\t\t\t\tctx.drawImage(this.rockSVG, x, y, size, size);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//walls\r\n\t\tctx.fillStyle = 'black';\r\n\t\tfor (const rectangleObstacle of this.map.rectangleObstacles) {\r\n\t\t\tif (rectangleObstacle.isActive()) {\r\n\t\t\t\tconst { x, y, width, height, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\tx: rectangleObstacle.x,\r\n\t\t\t\t\ty: rectangleObstacle.y,\r\n\t\t\t\t\twidth: rectangleObstacle.width,\r\n\t\t\t\t\theight: rectangleObstacle.height,\r\n\t\t\t\t});\r\n\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\tlet svgSource = this.horizontalWallSVG;\r\n\t\t\t\t\tif (rectangleObstacle.width < rectangleObstacle.height) svgSource = this.verticalWallSVG;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.globalAlpha = rectangleObstacle.getOpacity();\r\n\t\t\t\t\tctx.drawImage(svgSource, x, y, width, height);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/*\r\n\t\t\tif (rectangleObstacle.isActive()) {\r\n\t\t\t\tconst { x, y, width, height, isOnScreen } = this.howToDraw(rectangleObstacle);\r\n\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.globalAlpha = rectangleObstacle.getOpacity();\r\n\t\t\t\t\tctx.fillRect(x, y, width, height);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t}\r\n\r\n\t\t//dead players\r\n\t\tfor (const player of players) {\r\n\t\t\tif (player.alive()) continue;\r\n\t\t\tconst { x, y, width, height, isOnScreen } = this.howToDraw({\r\n\t\t\t\tx: player.getX(),\r\n\t\t\t\ty: player.getY(),\r\n\t\t\t\tsize: player.size,\r\n\t\t\t});\r\n\t\t\tif (isOnScreen) {\r\n\t\t\t\tctx.drawImage(this.deadPlayer, x, y, width, height);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//loot\r\n\t\tfor (const loot of betweenSnapshot.l) {\r\n\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw(loot);\r\n\t\t\tlet lootSVG;\r\n\t\t\tswitch (loot.type) {\r\n\t\t\t\tcase LootType.Pistol:\r\n\t\t\t\t\tlootSVG = this.pistolLootSVG;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase LootType.Machinegun:\r\n\t\t\t\t\tlootSVG = this.machinegunLootSVG;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase LootType.Shotgun:\r\n\t\t\t\t\tlootSVG = this.shotgunLootSVG;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase LootType.Rifle:\r\n\t\t\t\t\tlootSVG = this.rifleLootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.Smoke:\r\n\t\t\t\t\tlootSVG = this.smokeLootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.Granade:\r\n\t\t\t\t\tlootSVG = this.granadeLootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.Hammer:\r\n\t\t\t\t\tlootSVG = this.hammerLootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.RedAmmo:\r\n\t\t\t\t\tlootSVG = this.redAmmoLootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.BlueAmmo:\r\n\t\t\t\t\tlootSVG = this.blueAmmoLootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.GreenAmmo:\r\n\t\t\t\t\tlootSVG = this.greenAmmoLootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.OrangeAmmo:\r\n\t\t\t\t\tlootSVG = this.orangeAmmoLootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.Vest:\r\n\t\t\t\t\tlootSVG = this.vestLootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.Medkit:\r\n\t\t\t\t\tlootSVG = this.medkitLootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.Scope2:\r\n\t\t\t\t\tlootSVG = this.scope2LootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.Scope4:\r\n\t\t\t\t\tlootSVG = this.scope4LootSVG;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase LootType.Scope6:\r\n\t\t\t\t\tlootSVG = this.scope6LootSVG;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tctx.drawImage(lootSVG, x, y, size, size);\r\n\t\t}\r\n\r\n\t\t//players\r\n\t\tfor (const player of players) {\r\n\t\t\tif (!player.alive()) continue;\r\n\r\n\t\t\t//player body\r\n\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\tx: player.getX(),\r\n\t\t\t\ty: player.getY(),\r\n\t\t\t\tsize: player.size,\r\n\t\t\t});\r\n\t\t\tif (isOnScreen) {\r\n\t\t\t\t//vest\r\n\t\t\t\tconst radius = size / 2;\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.arc(x + radius, y + radius, radius, 0, 2 * Math.PI);\r\n\t\t\t\tlet colorVest = this.colors.player;\r\n\t\t\t\tif (player.getVest()) colorVest = this.colors.vest;\r\n\t\t\t\tctx.fillStyle = colorVest;\r\n\t\t\t\tctx.fill();\r\n\t\t\t\t//body\r\n\t\t\t\tlet bodyRadius = radius * 0.92;\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.arc(x + radius, y + radius, bodyRadius, 0, 2 * Math.PI);\r\n\t\t\t\tctx.fillStyle = this.colors.player;\r\n\t\t\t\tctx.fill();\r\n\t\t\t\t/*\r\n\t\t\t\t//collisionPoints\r\n\t\t\t\tif (this.collisionPoints.isReady()){\r\n\t\t\t\t\tctx.fillStyle = this.colors.collisionPoint;\r\n\t\t\t\t\tfor (const point of this.collisionPoints.body) {\r\n\t\t\t\t\t\tconst { x, y, size } = this.howToDraw({\r\n\t\t\t\t\t\t\tx: player.getCenterX() + point.x,\r\n\t\t\t\t\t\t\ty: player.getCenterY() + point.y,\r\n\t\t\t\t\t\t\tsize: 1\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tctx.fillRect(x, y, size, size);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\r\n\t\t\tconst gunSize = 280;\r\n\t\t\t//pistol\r\n\t\t\tif (player.getWeapon() === Weapon.Pistol) {\r\n\t\t\t\t//draw pistol\r\n\t\t\t\tconst gunX = player.getCenterX() - gunSize / 2;\r\n\t\t\t\tconst gunY = player.getCenterY() - gunSize / 2;\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\tx: gunX,\r\n\t\t\t\t\ty: gunY,\r\n\t\t\t\t\tsize: gunSize,\r\n\t\t\t\t});\r\n\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\tlet middleImage = size / 2;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\t\tctx.rotate((player.getAngle() * Math.PI) / 180);\r\n\t\t\t\t\tctx.drawImage(this.pistolSVG, -middleImage, -middleImage, size, size);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//machinegun\r\n\t\t\tif (player.getWeapon() === Weapon.Machinegun) {\r\n\t\t\t\tconst gunX = player.getCenterX() - gunSize / 2;\r\n\t\t\t\tconst gunY = player.getCenterY() - gunSize / 2;\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\tx: gunX,\r\n\t\t\t\t\ty: gunY,\r\n\t\t\t\t\tsize: gunSize,\r\n\t\t\t\t});\r\n\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\tlet middleImage = size / 2;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\t\tctx.rotate((player.getAngle() * Math.PI) / 180);\r\n\t\t\t\t\tctx.drawImage(this.machinegunSVG, -middleImage, -middleImage, size, size);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//shotgun\r\n\t\t\tif (player.getWeapon() === Weapon.Shotgun) {\r\n\t\t\t\tconst gunX = player.getCenterX() - gunSize / 2;\r\n\t\t\t\tconst gunY = player.getCenterY() - gunSize / 2;\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\tx: gunX,\r\n\t\t\t\t\ty: gunY,\r\n\t\t\t\t\tsize: gunSize,\r\n\t\t\t\t});\r\n\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\tlet middleImage = size / 2;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\t\tctx.rotate((player.getAngle() * Math.PI) / 180);\r\n\t\t\t\t\tctx.drawImage(this.shotgunSVG, -middleImage, -middleImage, size, size);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//rifle\r\n\t\t\tif (player.getWeapon() === Weapon.Rifle) {\r\n\t\t\t\tconst gunX = player.getCenterX() - gunSize / 2;\r\n\t\t\t\tconst gunY = player.getCenterY() - gunSize / 2;\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\tx: gunX,\r\n\t\t\t\t\ty: gunY,\r\n\t\t\t\t\tsize: gunSize,\r\n\t\t\t\t});\r\n\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\tlet middleImage = size / 2;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\t\tctx.rotate((player.getAngle() * Math.PI) / 180);\r\n\t\t\t\t\tctx.drawImage(this.rifleSVG, -middleImage, -middleImage, size, size);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//hammer\r\n\t\t\tif (player.getWeapon() === Weapon.Hammer) {\r\n\t\t\t\tconst gunX = player.getCenterX() - gunSize / 2;\r\n\t\t\t\tconst gunY = player.getCenterY() - gunSize / 2;\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\tx: gunX,\r\n\t\t\t\t\ty: gunY,\r\n\t\t\t\t\tsize: gunSize,\r\n\t\t\t\t});\r\n\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\tlet middleImage = size / 2;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\t\tctx.rotate((player.getHammerAngle() * Math.PI) / 180);\r\n\t\t\t\t\tctx.drawImage(this.hammerSVG, -middleImage, -middleImage, size, size);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t\t/*\r\n\t\t\t\t\tif (this.collisionPoints.isReady()) {\r\n\t\t\t\t\t\t//collisionPoints\r\n\t\t\t\t\t\tctx.fillStyle = this.colors.collisionPoint;\r\n\t\t\t\t\t\tfor (const point of this.collisionPoints.hammer[player.getHammerAngle()]) {\r\n\t\t\t\t\t\t\tconst { x, y, size } = this.howToDraw({\r\n\t\t\t\t\t\t\t\tx: player.getCenterX() - gunSize / 2 + point.x,\r\n\t\t\t\t\t\t\t\ty: player.getCenterY() - gunSize / 2 + point.y,\r\n\t\t\t\t\t\t\t\tsize: 1\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tctx.fillRect(x, y, size, size);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t*/\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//player hands\r\n\t\t\tif (\r\n\t\t\t\tplayer.getWeapon() === Weapon.Hand ||\r\n\t\t\t\tplayer.getWeapon() === Weapon.Granade ||\r\n\t\t\t\tplayer.getWeapon() === Weapon.Smoke ||\r\n\t\t\t\tplayer.getWeapon() === Weapon.Medkit\r\n\t\t\t) {\r\n\t\t\t\tfor (let i = 0; i < 2; i++) {\r\n\t\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\t\tx: player.hands[i].getX(),\r\n\t\t\t\t\t\ty: player.hands[i].getY(),\r\n\t\t\t\t\t\tsize: player.hands[i].size,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\t\tconst radius = size / 2;\r\n\t\t\t\t\t\t//hand border\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.arc(x + radius, y + radius, radius, 0, 2 * Math.PI);\r\n\t\t\t\t\t\tctx.fillStyle = this.colors.handBorder;\r\n\t\t\t\t\t\tctx.fill();\r\n\t\t\t\t\t\t//hand\r\n\t\t\t\t\t\tconst radiusHand = radius * 0.8;\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.arc(x + radius, y + radius, radiusHand, 0, 2 * Math.PI);\r\n\t\t\t\t\t\tctx.fillStyle = this.colors.hand;\r\n\t\t\t\t\t\tctx.fill();\r\n\t\t\t\t\t\t//hand collisionPoints\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\tif (this.collisionPoints.isReady()){\r\n\t\t\t\t\t\t\tctx.fillStyle = this.colors.collisionPoint;\r\n\t\t\t\t\t\t\tfor (const point of this.collisionPoints.hand) {\r\n\t\t\t\t\t\t\t\tconst { x, y, size } = this.howToDraw({\r\n\t\t\t\t\t\t\t\t\tx: player.hands[i].getCenterX() + point.x,\r\n\t\t\t\t\t\t\t\t\ty: player.hands[i].getCenterY() + point.y,\r\n\t\t\t\t\t\t\t\t\tsize: 1\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tctx.fillRect(x, y, size, size);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t*/\r\n\r\n\t\t\t\t\t\t//granade || smoke || medkit in hand\r\n\t\t\t\t\t\tif ((player.getWeapon() === Weapon.Granade || player.getWeapon() === Weapon.Smoke || player.getWeapon() === Weapon.Medkit) && i === 1) {\r\n\t\t\t\t\t\t\tconst playerAngle = player.getAngle();\r\n\t\t\t\t\t\t\tconst percentSize = 1.2;\r\n\t\t\t\t\t\t\tconst shiftZ = player.hands[i].radius * percentSize;\r\n\t\t\t\t\t\t\t//triangle\r\n\t\t\t\t\t\t\tconst shiftX = Math.sin((playerAngle * Math.PI) / 180) * shiftZ;\r\n\t\t\t\t\t\t\tconst shiftY = Math.cos((playerAngle * Math.PI) / 180) * shiftZ;\r\n\r\n\t\t\t\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\t\t\t\tx: player.hands[i].getCenterX() + shiftX - player.hands[i].radius * percentSize,\r\n\t\t\t\t\t\t\t\ty: player.hands[i].getCenterY() - shiftY - player.hands[i].radius * percentSize,\r\n\t\t\t\t\t\t\t\tsize: player.hands[i].size * percentSize,\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\t\t\t\tconst granadeShiftAngle = 30;\r\n\t\t\t\t\t\t\t\tlet middleImage = size / 2;\r\n\t\t\t\t\t\t\t\tctx.save();\r\n\t\t\t\t\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\t\t\t\t\tctx.rotate(((playerAngle - granadeShiftAngle) * Math.PI) / 180);\r\n\t\t\t\t\t\t\t\tlet SVG;\r\n\t\t\t\t\t\t\t\tif (player.getWeapon() === Weapon.Granade) SVG = this.granadeSVG;\r\n\t\t\t\t\t\t\t\tif (player.getWeapon() === Weapon.Smoke) SVG = this.smokeSVG;\r\n\t\t\t\t\t\t\t\tif (player.getWeapon() === Weapon.Medkit) SVG = this.medkitSVG;\r\n\t\t\t\t\t\t\t\tctx.drawImage(SVG, -middleImage, -middleImage, size, size);\r\n\t\t\t\t\t\t\t\tctx.restore();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//hand on weapon\r\n\t\t\tif (player.getWeapon() === Weapon.Pistol) {\r\n\t\t\t\tthis.drawHandOnWeapon(player, 27, 0);\r\n\t\t\t\tthis.drawHandOnWeapon(player, 60, 12);\r\n\t\t\t}\r\n\t\t\tif (player.getWeapon() === Weapon.Machinegun) {\r\n\t\t\t\tthis.drawHandOnWeapon(player, 27, 0);\r\n\t\t\t\tthis.drawHandOnWeapon(player, 75, 10);\r\n\t\t\t}\r\n\t\t\tif (player.getWeapon() === Weapon.Shotgun) {\r\n\t\t\t\tthis.drawHandOnWeapon(player, 27, 0);\r\n\t\t\t\tthis.drawHandOnWeapon(player, 75, 10);\r\n\t\t\t}\r\n\t\t\tif (player.getWeapon() === Weapon.Rifle) {\r\n\t\t\t\tthis.drawHandOnWeapon(player, 27, 0);\r\n\t\t\t\tthis.drawHandOnWeapon(player, 80, 9);\r\n\t\t\t}\r\n\t\t\tif (player.getWeapon() === Weapon.Hammer) {\r\n\t\t\t\tthis.drawHandOnWeapon(player, 40, 30);\r\n\t\t\t\tthis.drawHandOnWeapon(player, 40, -30);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//blood\r\n\t\tfor (const player of this.snapshotManager.players) {\r\n\t\t\tctx.fillStyle = this.colors.collisionPoint;\r\n\t\t\tfor (let i = player.bloods.length - 1; i >= 0; i--) {\r\n\t\t\t\tconst blood = player.bloods[i];\r\n\t\t\t\tif (blood.getTimer() < blood.timerMax) {\r\n\t\t\t\t\tblood.shift();\r\n\t\t\t\t\tconst bloodX = player.getCenterX() + blood.getX();\r\n\t\t\t\t\tconst bloodY = player.getCenterY() + blood.getY();\r\n\t\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\t\t\tx: bloodX,\r\n\t\t\t\t\t\ty: bloodY,\r\n\t\t\t\t\t\tsize: blood.size,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\t\tconst alpha = 1 - blood.getTimer() / blood.timerMax;\r\n\t\t\t\t\t\tctx.save();\r\n\t\t\t\t\t\tctx.globalAlpha = alpha;\r\n\t\t\t\t\t\tctx.fillRect(x, y, size, size);\r\n\t\t\t\t\t\tctx.restore();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tplayer.bloods.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//granades\r\n\t\tfor (const granade of betweenSnapshot.g) {\r\n\t\t\tconst granadeSize = 40 * granade.b;\r\n\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\tx: granade.x - granadeSize / 2,\r\n\t\t\t\ty: granade.y - granadeSize / 2,\r\n\t\t\t\tsize: granadeSize,\r\n\t\t\t});\r\n\t\t\tif (isOnScreen) {\r\n\t\t\t\tlet middleImage = size / 2;\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\tctx.rotate((granade.a * Math.PI) / 180);\r\n\t\t\t\tif (granade.t === 'g') {\r\n\t\t\t\t\tctx.drawImage(this.granadeSVG, -middleImage, -middleImage, size, size);\r\n\t\t\t\t}\r\n\t\t\t\tif (granade.t === 's') {\r\n\t\t\t\t\tctx.drawImage(this.smokeSVG, -middleImage, -middleImage, size, size);\r\n\t\t\t\t}\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//bullet points\r\n\t\t/*\r\n\t\tctx.fillStyle = 'red';\r\n\t\tfor (const bullet of betweenSnapshot.b) {\r\n\t\t\t//bullet point\r\n\t\t\tconst bulletRadius = 2;\r\n\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\tx: bullet.x - bulletRadius,\r\n\t\t\t\ty: bullet.y - bulletRadius,\r\n\t\t\t\tsize: bulletRadius * 2\r\n\t\t\t});\r\n\t\t\tif (isOnScreen) {\r\n\t\t\t\tctx.fillRect(x, y, size, size);\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\r\n\t\tthis.createBulletLines();\r\n\t\t//draw bullet lines\r\n\t\tfor (const line of this.bulletLines) {\r\n\t\t\tlet partCounter = 0;\r\n\t\t\tfor (const partLine of line.parts) {\r\n\t\t\t\tpartCounter++;\r\n\t\t\t\tlet baseAlpha = partCounter * 0.05 + 0.1;\r\n\t\t\t\tif (baseAlpha > 0.8) baseAlpha = 0.8;\r\n\t\t\t\tif (partLine.isActive()) {\r\n\t\t\t\t\tlet finalAlpha = baseAlpha - partLine.getAge() / 14.3;\r\n\t\t\t\t\tif (finalAlpha < 0) finalAlpha = 0;\r\n\t\t\t\t\tconst { x: startX, y: startY } = this.howToDraw({\r\n\t\t\t\t\t\tx: partLine.startX,\r\n\t\t\t\t\t\ty: partLine.startY,\r\n\t\t\t\t\t\tsize: 1,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tconst { x: endX, y: endY } = this.howToDraw({\r\n\t\t\t\t\t\tx: partLine.endX,\r\n\t\t\t\t\t\ty: partLine.endY,\r\n\t\t\t\t\t\tsize: 1,\r\n\t\t\t\t\t});\r\n\t\t\t\t\t//bug long bullet lines\r\n\t\t\t\t\tif (Math.abs(startX - endX) > 100 || Math.abs(startY - endY) > 100) {\r\n\t\t\t\t\t\tconsole.log('err: bullet lines');\r\n\t\t\t\t\t\tconsole.log('partLine', partLine);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t//draw part\r\n\t\t\t\t\t\tctx.save();\r\n\t\t\t\t\t\tctx.globalAlpha = finalAlpha;\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(startX, startY);\r\n\t\t\t\t\t\tctx.lineTo(endX, endY);\r\n\t\t\t\t\t\tctx.lineWidth = (6 - partLine.getAge() / 3.33) * this.finalResolutionAdjustment;\r\n\t\t\t\t\t\tctx.strokeStyle = 'white';\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\tctx.restore();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpartLine.increaseAge();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//bushes\r\n\t\tfor (const bush of this.map.bushes) {\r\n\t\t\tif (bush.isActive()) {\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw(bush);\r\n\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\t// am i under the tree?\r\n\t\t\t\t\tlet opacityUnderTree = 1;\r\n\t\t\t\t\tif (this.isPlayerUnderRoundObject(this.myPlayer, bush)) opacityUnderTree = 0.8;\r\n\r\n\t\t\t\t\tlet middleImage = size / 2;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\t\tctx.rotate((bush.angle * Math.PI) / 180);\r\n\t\t\t\t\tctx.globalAlpha = bush.getOpacity() * opacityUnderTree;\r\n\t\t\t\t\tctx.drawImage(this.bushSVG, -middleImage, -middleImage, size, size);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//trees\r\n\t\tfor (const tree of this.map.trees) {\r\n\t\t\tif (tree.isActive()) {\r\n\t\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw(tree);\r\n\t\t\t\tif (isOnScreen) {\r\n\t\t\t\t\t// am i under the tree?\r\n\t\t\t\t\tlet opacityUnderTree = 1;\r\n\t\t\t\t\tif (this.isPlayerUnderRoundObject(this.myPlayer, tree)) opacityUnderTree = 0.8;\r\n\r\n\t\t\t\t\tlet middleImage = size / 2;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.translate(x + middleImage, y + middleImage);\r\n\t\t\t\t\tctx.rotate((tree.angle * Math.PI) / 180);\r\n\t\t\t\t\tctx.globalAlpha = tree.getOpacity() * opacityUnderTree;\r\n\t\t\t\t\tctx.drawImage(this.treeSVG, -middleImage, -middleImage, size, size);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//smokes\r\n\t\tfor (const smoke of betweenSnapshot.s) {\r\n\t\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\t\tx: smoke.x - smoke.s / 2,\r\n\t\t\t\ty: smoke.y - smoke.s / 2,\r\n\t\t\t\tsize: smoke.s,\r\n\t\t\t});\r\n\t\t\tif (isOnScreen) {\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.globalAlpha = smoke.o;\r\n\t\t\t\tctx.drawImage(this.smokeCloudSVG, x, y, size, size);\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//zone\r\n\t\tconst {\r\n\t\t\tx,\r\n\t\t\ty,\r\n\t\t\tsize: outerRadius,\r\n\t\t} = this.howToDraw({\r\n\t\t\tx: this.snapshotManager.zone.outerCircle.getCenterX(),\r\n\t\t\ty: this.snapshotManager.zone.outerCircle.getCenterY(),\r\n\t\t\tsize: this.snapshotManager.zone.outerCircle.getRadius(),\r\n\t\t});\r\n\r\n\t\tel.zoneCircle.setAttribute('r', outerRadius.toString());\r\n\t\tel.zoneCircle.setAttribute('cx', x.toString());\r\n\t\tel.zoneCircle.setAttribute('cy', y.toString());\r\n\r\n\t\t//info\r\n\t\t/*\r\n\t\t{\r\n\t\t\tctx.font = '20px Arial';\r\n\t\t\tctx.fillStyle = this.colors.text;\r\n\t\t\tconst x = 15;\r\n\t\t\tlet row = 30;\r\n\t\t\tlet rowMultiple = 8;\r\n\t\t\t//ctx.fillText('snapshots: ' + this.snapshots.length, x, row * ++rowMultiple);\r\n\t\t\tctx.fillText('newerSnapshots: ' + this.snapshotManager.sumaNewer, x, row * ++rowMultiple);\r\n\t\t\tctx.fillText('ping: ' + this.serverClientSync.getPing(), x, row * ++rowMultiple);\r\n\t\t\tctx.fillText('timeDiference: ' + this.serverClientSync.getTimeDiference(), x, row * ++rowMultiple);\r\n\t\t\tctx.fillText('drawDelay: ' + this.serverClientSync.getDrawDelay(), x, row * ++rowMultiple);\r\n\t\t\tif (!this.snapshotManager.olderExists) {\r\n\t\t\t\tctx.fillText('olderSnapshot missing', x, row * ++rowMultiple);\r\n\t\t\t}\r\n\t\t\tif (!this.snapshotManager.newerExists) {\r\n\t\t\t\tctx.fillText('newerSnapshot missing', x, row * ++rowMultiple);\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\r\n\t\t//healthBar\r\n\t\tel.healthBar.in.style.width = betweenSnapshot.i.h + '%';\r\n\r\n\t\t//loading\r\n\t\tconst progres = Math.round((betweenSnapshot.i.l / betweenSnapshot.i.lE) * 100);\r\n\t\tconst seconds = Math.round(((betweenSnapshot.i.lE - betweenSnapshot.i.l) / 1000) * 10) / 10;\r\n\t\tif (seconds && this.myPlayer.alive()) {\r\n\t\t\tel.takeLoot.style.display = 'none';\r\n\t\t\tel.loading.main.style.visibility = 'visible';\r\n\t\t\tel.loading.text.style.display = 'block';\r\n\t\t\tel.loading.text.textContent = betweenSnapshot.i.lT;\r\n\t\t\tlet secondsString = seconds.toString();\r\n\t\t\tswitch (secondsString) {\r\n\t\t\t\tcase '0':\r\n\t\t\t\t\tsecondsString = ' 0.0';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase '1':\r\n\t\t\t\t\tsecondsString = ' 1.0';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase '2':\r\n\t\t\t\t\tsecondsString = ' 2.0';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase '3':\r\n\t\t\t\t\tsecondsString = ' 3.0';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase '4':\r\n\t\t\t\t\tsecondsString = ' 4.0';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase '5':\r\n\t\t\t\t\tsecondsString = ' 5.0';\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tel.loading.counter.textContent = secondsString;\r\n\t\t\tel.loading.circle.setAttribute('stroke-dasharray', progres + ', 100');\r\n\t\t} else {\r\n\t\t\tel.loading.main.style.visibility = 'hidden';\r\n\t\t\tel.loading.text.style.display = 'none';\r\n\t\t\t//take loot info\r\n\t\t\tel.takeLoot.style.display = 'block';\r\n\t\t\tthis.takeLootInfo();\r\n\t\t}\r\n\r\n\t\t//items\r\n\t\tel.items.redAmmo.textContent = this.snapshotManager.betweenSnapshot.i.r.toString();\r\n\t\tel.items.greenAmmo.textContent = this.snapshotManager.betweenSnapshot.i.g.toString();\r\n\t\tel.items.blueAmmo.textContent = this.snapshotManager.betweenSnapshot.i.b.toString();\r\n\t\tel.items.orangeAmmo.textContent = this.snapshotManager.betweenSnapshot.i.o.toString();\r\n\r\n\t\tel.items.item1in.textContent = this.itemName(this.snapshotManager.betweenSnapshot.i.i1);\r\n\t\tel.items.item2in.textContent = this.itemName(this.snapshotManager.betweenSnapshot.i.i2);\r\n\t\t//ammo color\r\n\t\tthis.itemAmmoColor(1, this.snapshotManager.betweenSnapshot.i.i1);\r\n\t\tthis.itemAmmoColor(2, this.snapshotManager.betweenSnapshot.i.i2);\r\n\t\tel.items.item3in.textContent = this.itemName(this.snapshotManager.betweenSnapshot.i.i3);\r\n\t\tlet item4Text = this.itemName(this.snapshotManager.betweenSnapshot.i.i4);\r\n\t\tconst item4Count = this.snapshotManager.betweenSnapshot.i.s4;\r\n\t\tif (item4Text) item4Text += ' ' + item4Count;\r\n\t\tel.items.item4in.textContent = item4Text;\r\n\r\n\t\tlet item5Text = this.itemName(this.snapshotManager.betweenSnapshot.i.i5);\r\n\t\tconst item5Count = this.snapshotManager.betweenSnapshot.i.s5;\r\n\t\tif (item5Text) item5Text += ' ' + item5Count;\r\n\t\tel.items.item5in.textContent = item5Text;\r\n\r\n\t\t//active item\r\n\t\tthis.activeItem(betweenSnapshot.i.ai);\r\n\r\n\t\t//activeGunAmmo\r\n\t\tlet ammo = '';\r\n\t\tif (\r\n\t\t\tthis.myPlayer.getWeapon() === Weapon.Pistol ||\r\n\t\t\tthis.myPlayer.getWeapon() === Weapon.Rifle ||\r\n\t\t\tthis.myPlayer.getWeapon() === Weapon.Machinegun ||\r\n\t\t\tthis.myPlayer.getWeapon() === Weapon.Shotgun\r\n\t\t) {\r\n\t\t\tlet extraAmmoForActiveGun = 0;\r\n\t\t\tswitch (this.myPlayer.getWeapon()) {\r\n\t\t\t\t// r g b o\r\n\t\t\t\tcase Weapon.Pistol:\r\n\t\t\t\t\textraAmmoForActiveGun = betweenSnapshot.i.o;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Weapon.Rifle:\r\n\t\t\t\t\textraAmmoForActiveGun = betweenSnapshot.i.g;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Weapon.Machinegun:\r\n\t\t\t\t\textraAmmoForActiveGun = betweenSnapshot.i.b;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Weapon.Shotgun:\r\n\t\t\t\t\textraAmmoForActiveGun = betweenSnapshot.i.r;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tammo = betweenSnapshot.i.a.toString() + ' / ' + extraAmmoForActiveGun;\r\n\t\t} else if (this.myPlayer.getWeapon() === Weapon.Hand || this.myPlayer.getWeapon() === Weapon.Hammer) {\r\n\t\t\tammo = '';\r\n\t\t} else if (this.myPlayer.getWeapon() === Weapon.Granade || this.myPlayer.getWeapon() === Weapon.Smoke) {\r\n\t\t\tammo = item4Count.toString();\r\n\t\t} else if (this.myPlayer.getWeapon() === Weapon.Medkit) {\r\n\t\t\tammo = item5Count.toString();\r\n\t\t}\r\n\t\tel.activeGunAmmo.textContent = ammo;\r\n\r\n\t\t//alive\r\n\t\tlet count = 0;\r\n\t\tfor (const player of this.snapshotManager.players) {\r\n\t\t\tif (player.alive()) count++;\r\n\t\t}\r\n\t\tel.alive.textContent = count.toString();\r\n\r\n\t\t//top items\r\n\t\tlet display = 'none';\r\n\t\tif (this.snapshotManager.betweenSnapshot.i.s !== 1) {\r\n\t\t\tdisplay = 'block';\r\n\t\t\tswitch (this.snapshotManager.betweenSnapshot.i.s) {\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tel.items.scope2.style.display = 'block';\r\n\t\t\t\t\tel.items.scope4.style.display = 'none';\r\n\t\t\t\t\tel.items.scope6.style.display = 'none';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tel.items.scope2.style.display = 'none';\r\n\t\t\t\t\tel.items.scope4.style.display = 'block';\r\n\t\t\t\t\tel.items.scope6.style.display = 'none';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 6:\r\n\t\t\t\t\tel.items.scope2.style.display = 'none';\r\n\t\t\t\t\tel.items.scope4.style.display = 'none';\r\n\t\t\t\t\tel.items.scope6.style.display = 'block';\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tel.items.scope.style.display = display;\r\n\t\tdisplay = 'none';\r\n\t\tif (this.snapshotManager.betweenSnapshot.i.v) display = 'block';\r\n\t\tel.items.vest.style.display = display;\r\n\r\n\t\t//messages\r\n\t\tthis.snapshotManager.messageManager();\r\n\t\tel.messages.innerHTML = '';\r\n\t\tfor (let i = this.snapshotManager.messages.length - 1; i >= 0; i--) {\r\n\t\t\tconst message = this.snapshotManager.messages[i];\r\n\t\t\tconst element = document.createElement('p');\r\n\t\t\telement.textContent = message.text;\r\n\t\t\tel.messages.appendChild(element);\r\n\t\t}\r\n\r\n\t\t//zone time\r\n\t\tif (this.snapshotManager.betweenSnapshot.z.hasOwnProperty('d')) {\r\n\t\t\tlet text = '';\r\n\t\t\tif (this.snapshotManager.betweenSnapshot.z.d > 0) {\r\n\t\t\t\ttext += this.snapshotManager.betweenSnapshot.z.d;\r\n\t\t\t} else {\r\n\t\t\t\ttext = 'Zone is moving!';\r\n\t\t\t}\r\n\t\t\tel.zoneTimer.innerText = text;\r\n\t\t}\r\n\r\n\t\t//spectate text\r\n\t\tel.spectate.style.display = 'none';\r\n\t\tif (betweenSnapshot.i.spectateName) {\r\n\t\t\tel.spectateName.innerText = betweenSnapshot.i.spectateName;\r\n\t\t\tel.spectate.style.display = 'block';\r\n\t\t}\r\n\t}\r\n\r\n\tprivate drawHandOnWeapon(player: Player, shiftHandZ: number, shiftHandAngle: number): void {\r\n\t\tconst ctx = this.ctxGame;\r\n\t\tlet finalAngle = shiftHandAngle + player.getAngle();\r\n\t\tif (player.getWeapon() === Weapon.Hammer) finalAngle = shiftHandAngle + player.getHammerAngle();\r\n\t\tif (finalAngle >= 360) finalAngle -= 360;\r\n\t\tconst shiftHandX = Math.sin((finalAngle * Math.PI) / 180) * shiftHandZ;\r\n\t\tconst shiftHandY = Math.cos((finalAngle * Math.PI) / 180) * shiftHandZ;\r\n\t\tconst handX = player.getCenterX() + shiftHandX - player.hands[0].radius;\r\n\t\tconst handY = player.getCenterY() - shiftHandY - player.hands[0].radius;\r\n\t\tconst { x, y, size, isOnScreen } = this.howToDraw({\r\n\t\t\tx: handX,\r\n\t\t\ty: handY,\r\n\t\t\tsize: player.hands[0].size,\r\n\t\t});\r\n\t\tif (isOnScreen) {\r\n\t\t\tconst radius = size / 2;\r\n\t\t\t//hand border\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(x + radius, y + radius, radius, 0, 2 * Math.PI);\r\n\t\t\tctx.fillStyle = this.colors.handBorder;\r\n\t\t\tctx.fill();\r\n\t\t\t//hand\r\n\t\t\tconst radiusHand = radius * 0.8;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(x + radius, y + radius, radiusHand, 0, 2 * Math.PI);\r\n\t\t\tctx.fillStyle = this.colors.hand;\r\n\t\t\tctx.fill();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate createBulletLines(): void {\r\n\t\tfor (const bullet of this.snapshotManager.betweenSnapshot.b) {\r\n\t\t\tlet thereIsLine = false;\r\n\t\t\t//set end in line\r\n\t\t\tfor (const line of this.bulletLines) {\r\n\t\t\t\tif (line.id === bullet.id) {\r\n\t\t\t\t\tline.setEnd(bullet.x, bullet.y);\r\n\t\t\t\t\tthereIsLine = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//create new line\r\n\t\t\tif (!thereIsLine) this.bulletLines.push(new BulletLine(bullet.id, bullet.x, bullet.y));\r\n\t\t}\r\n\t\t//delete old bullet lines\r\n\t\tfor (let i = this.bulletLines.length - 1; i >= 0; i--) {\r\n\t\t\tif (!this.bulletLines[i].isActive()) {\r\n\t\t\t\tthis.bulletLines.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate activeItem(activeItem: number): void {\r\n\t\tconst el = this.myHtmlElements;\r\n\t\tel.items.item1.classList.remove('active');\r\n\t\tel.items.item2.classList.remove('active');\r\n\t\tel.items.item3.classList.remove('active');\r\n\t\tel.items.item4.classList.remove('active');\r\n\t\tel.items.item5.classList.remove('active');\r\n\r\n\t\tswitch (activeItem) {\r\n\t\t\tcase 1:\r\n\t\t\t\tel.items.item1.classList.add('active');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tel.items.item2.classList.add('active');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tel.items.item3.classList.add('active');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tel.items.item4.classList.add('active');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 5:\r\n\t\t\t\tel.items.item5.classList.add('active');\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate itemAmmoColor(item: number, weapon: Weapon): void {\r\n\t\tlet el;\r\n\t\tif (item === 1) {\r\n\t\t\tel = this.myHtmlElements.items.item1Ammo;\r\n\t\t} else if (item === 2) {\r\n\t\t\tel = this.myHtmlElements.items.item2Ammo;\r\n\t\t}\r\n\t\tlet background = 'transparent';\r\n\t\tswitch (weapon) {\r\n\t\t\tcase Weapon.Pistol:\r\n\t\t\t\tbackground = 'orange';\r\n\t\t\t\tbreak;\r\n\t\t\tcase Weapon.Machinegun:\r\n\t\t\t\tbackground = 'blue';\r\n\t\t\t\tbreak;\r\n\t\t\tcase Weapon.Rifle:\r\n\t\t\t\tbackground = 'Green';\r\n\t\t\t\tbreak;\r\n\t\t\tcase Weapon.Shotgun:\r\n\t\t\t\tbackground = 'red';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (el) el.style.background = background;\r\n\t}\r\n\r\n\tprivate itemName(item: any): string {\r\n\t\tlet weaponName: string = '';\r\n\t\tif (item === Weapon.Pistol) weaponName = 'Pistol';\r\n\t\tif (item === Weapon.Rifle) weaponName = 'Rifle';\r\n\t\tif (item === Weapon.Machinegun) weaponName = 'Machinegun';\r\n\t\tif (item === Weapon.Shotgun) weaponName = 'Shotgun';\r\n\t\tif (item === Weapon.Granade) weaponName = 'Granade';\r\n\t\tif (item === Weapon.Smoke) weaponName = 'Smoke';\r\n\t\tif (item === Weapon.Hand) weaponName = 'Hands';\r\n\t\tif (item === Weapon.Hammer) weaponName = 'Hammer';\r\n\t\tif (item === Weapon.Medkit) weaponName = 'Medkit';\r\n\t\treturn weaponName;\r\n\t}\r\n\r\n\tprivate takeLootInfo(): void {\r\n\t\tconst el = this.myHtmlElements;\r\n\t\tlet takeLootText = '';\r\n\t\tif (!this.snapshotManager.betweenSnapshot || !this.myPlayer.alive()) {\r\n\t\t\tel.takeLoot.innerText = takeLootText;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor (const loot of this.snapshotManager.betweenSnapshot.l) {\r\n\t\t\tconst x = this.myPlayer.getCenterX() - (loot.x + loot.size / 2);\r\n\t\t\tconst y = this.myPlayer.getCenterY() - (loot.y + loot.size / 2);\r\n\t\t\tconst distance = Math.sqrt(x * x + y * y);\r\n\t\t\tconst lootAndPlayerRadius = this.snapshotManager.players[0].radius + loot.size / 2;\r\n\t\t\tif (distance < lootAndPlayerRadius) {\r\n\t\t\t\tlet lootName = '';\r\n\t\t\t\tswitch (loot.type) {\r\n\t\t\t\t\tcase LootType.BlueAmmo:\r\n\t\t\t\t\tcase LootType.RedAmmo:\r\n\t\t\t\t\tcase LootType.GreenAmmo:\r\n\t\t\t\t\tcase LootType.OrangeAmmo:\r\n\t\t\t\t\t\tlootName = 'Ammo';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Pistol:\r\n\t\t\t\t\t\tlootName = 'Pistol';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Rifle:\r\n\t\t\t\t\t\tlootName = 'Rifle';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Machinegun:\r\n\t\t\t\t\t\tlootName = 'Machinegun';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Shotgun:\r\n\t\t\t\t\t\tlootName = 'Shotgun';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Scope2:\r\n\t\t\t\t\t\tlootName = '2X scope';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Scope4:\r\n\t\t\t\t\t\tlootName = '4X scope';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Scope6:\r\n\t\t\t\t\t\tlootName = '6X scope';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Granade:\r\n\t\t\t\t\t\tlootName = 'Granade';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Smoke:\r\n\t\t\t\t\t\tlootName = 'Smoke';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Medkit:\r\n\t\t\t\t\t\tlootName = 'Medkit';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Vest:\r\n\t\t\t\t\t\tlootName = 'Vest';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase LootType.Hammer:\r\n\t\t\t\t\t\tlootName = 'Hammer';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet quantity = '';\r\n\t\t\t\tif (loot.quantity) quantity += loot.quantity;\r\n\t\t\t\ttakeLootText = lootName + ' ' + quantity + ' (E)';\r\n\t\t\t\tel.takeLoot.innerText = takeLootText;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tel.takeLoot.innerText = takeLootText;\r\n\t}\r\n\r\n\tprivate howToDraw(gameObject: RoundObject | RectObject | RectangleObstacle | RoundObstacle): DrawData {\r\n\t\t//size\r\n\t\tlet size = 0;\r\n\t\tlet width = 0;\r\n\t\tlet height = 0;\r\n\t\t//round or square\r\n\t\tif ((<RoundObject>gameObject).size) {\r\n\t\t\tsize = (<RoundObject>gameObject).size * this.finalResolutionAdjustment;\r\n\t\t\twidth = size;\r\n\t\t\theight = size;\r\n\t\t} else {\r\n\t\t\t//rect\r\n\t\t\twidth = (<RectObject>gameObject).width * this.finalResolutionAdjustment;\r\n\t\t\theight = (<RectObject>gameObject).height * this.finalResolutionAdjustment;\r\n\t\t}\r\n\r\n\t\t//positions on screen\r\n\t\tconst x = this.screenCenterX + (gameObject.x - this.myPlayer.getCenterX()) * this.finalResolutionAdjustment;\r\n\t\tconst y = this.screenCenterY + (gameObject.y - this.myPlayer.getCenterY()) * this.finalResolutionAdjustment;\r\n\t\t//Is is on the screen?\r\n\t\tlet isOnScreen = true;\r\n\t\tif (x > this.gameScreen.width || x < -width || y > this.gameScreen.height || y < -height) {\r\n\t\t\tisOnScreen = false;\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tx,\r\n\t\t\ty,\r\n\t\t\tsize,\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\tisOnScreen,\r\n\t\t};\r\n\t}\r\n\r\n\tgameOver(stats: PlayerStats, win: boolean, winnerName?: string): void {\r\n\t\tsetTimeout(() => {\r\n\t\t\tconst el = this.myHtmlElements;\r\n\t\t\tif (win || winnerName) {\r\n\t\t\t\tel.gameOverMenu.h1.textContent = 'Winner!';\r\n\t\t\t\tif (winnerName) el.gameOverMenu.h1.textContent = winnerName + ' win';\r\n\t\t\t\tel.gameOverMenu.spectate.style.display = 'none';\r\n\t\t\t} else {\r\n\t\t\t\tel.gameOverMenu.h1.textContent = 'You died';\r\n\t\t\t\tel.gameOverMenu.spectate.style.display = 'block';\r\n\t\t\t}\r\n\t\t\tel.open(el.gameOverMenu.main);\r\n\t\t\t//remove stats\r\n\t\t\tel.gameOverMenu.stats.innerHTML = '';\r\n\t\t\tconst kills = document.createElement('p');\r\n\t\t\tkills.textContent = 'Kills: ' + stats.kills.toString();\r\n\t\t\tconst damageDealt = document.createElement('p');\r\n\t\t\tdamageDealt.textContent = 'Damage dealt: ' + stats.damageDealt.toString();\r\n\t\t\tconst damageTaken = document.createElement('p');\r\n\t\t\tdamageTaken.textContent = 'Damage taken: ' + stats.damageTaken.toString();\r\n\t\t\tconst survive = document.createElement('p');\r\n\t\t\tconst minutes = Math.floor(stats.survive / 60);\r\n\t\t\tconst seconds = stats.survive - minutes * 60;\r\n\t\t\tconst surviveTime = minutes + 'm ' + seconds + 's';\r\n\t\t\tsurvive.textContent = 'Survive: ' + surviveTime;\r\n\t\t\tel.gameOverMenu.stats.appendChild(kills);\r\n\t\t\tel.gameOverMenu.stats.appendChild(damageDealt);\r\n\t\t\tel.gameOverMenu.stats.appendChild(damageTaken);\r\n\t\t\tif (!win) el.gameOverMenu.stats.appendChild(survive);\r\n\t\t}, 2000);\r\n\t}\r\n}\r\n","import { Terrain } from './Terrain';\r\nimport Bush from './Bush';\r\nimport Tree from './Tree';\r\nimport Rock from './Rock';\r\nimport Wall from './Wall';\r\nimport WaterTerrainData from './WaterTerrainData';\r\nimport RoundObstacle from './RoundObstacle';\r\nimport RectangleObstacle from './RectangleObstacle';\r\nimport MapData from './MapData';\r\n\r\ntype Block = {\r\n\tx: number;\r\n\ty: number;\r\n};\r\n\r\nexport default class Map {\r\n\tprivate size: number;\r\n\tprivate blockSize: number;\r\n\treadonly blocks: Block[] = [];\r\n\treadonly terrain: Terrain[] = [];\r\n\treadonly impassableRoundObstacles: RoundObstacle[] = [];\r\n\treadonly bushes: Bush[] = [];\r\n\treadonly trees: Tree[] = [];\r\n\treadonly rocks: Rock[] = [];\r\n\treadonly rectangleObstacles: RectangleObstacle[] = [];\r\n\treadonly waterTerrainData: WaterTerrainData;\r\n\r\n\tconstructor(waterTerrainData: WaterTerrainData) {\r\n\t\tthis.waterTerrainData = waterTerrainData;\r\n\t}\r\n\r\n\treset(): void {\r\n\t\tthis.blocks.splice(0, this.blocks.length);\r\n\t\tthis.terrain.splice(0, this.terrain.length);\r\n\t\tthis.impassableRoundObstacles.splice(0, this.impassableRoundObstacles.length);\r\n\t\tthis.bushes.splice(0, this.bushes.length);\r\n\t\tthis.trees.splice(0, this.trees.length);\r\n\t\tthis.rocks.splice(0, this.rocks.length);\r\n\t\tthis.rectangleObstacles.splice(0, this.rectangleObstacles.length);\r\n\t}\r\n\r\n\tgetSize(): number {\r\n\t\treturn this.size;\r\n\t}\r\n\r\n\tgetBlockSize(): number {\r\n\t\treturn this.blockSize;\r\n\t}\r\n\r\n\topenMap(map: MapData): void {\r\n\t\tthis.size = map.size * map.blockSize;\r\n\t\tthis.blockSize = map.blockSize;\r\n\t\t//Create blocks\r\n\t\tfor (let yy = 0; yy < map.size; yy++) {\r\n\t\t\tfor (let xx = 0; xx < map.size; xx++) {\r\n\t\t\t\tthis.blocks.push({ x: xx * map.blockSize, y: yy * map.blockSize });\r\n\t\t\t}\r\n\t\t}\r\n\t\t//terrains\r\n\t\tfor (const terrain of map.terrains) {\r\n\t\t\tthis.terrain.push(new Terrain(terrain.type, terrain.x, terrain.y, terrain.size));\r\n\t\t}\r\n\t\t//rocks\r\n\t\tlet id = 0;\r\n\t\tfor (const rock of map.rocks) {\r\n\t\t\tconst newRock = new Rock(id++, rock.x, rock.y);\r\n\t\t\tthis.rocks.push(newRock);\r\n\t\t\tthis.impassableRoundObstacles.push(newRock);\r\n\t\t}\r\n\t\t//bushes\r\n\t\tfor (const bush of map.bushes) {\r\n\t\t\tthis.bushes.push(new Bush(id++, bush.x, bush.y, bush.angle));\r\n\t\t}\r\n\t\t//trees\r\n\t\tfor (const tree of map.trees) {\r\n\t\t\tconst newTree = new Tree(id++, tree.x, tree.y, tree.angle);\r\n\t\t\tthis.trees.push(newTree);\r\n\t\t\tthis.impassableRoundObstacles.push(newTree);\r\n\t\t}\r\n\t\t//walls\r\n\t\tfor (const wall of map.rects) {\r\n\t\t\tthis.rectangleObstacles.push(new Wall(id++, wall.x, wall.y, wall.width, wall.height));\r\n\t\t}\r\n\t}\r\n}\r\n","import { TerrainType } from './Terrain';\r\n\r\n/*\r\nimport { triangel1 } from './triangel1Data';\r\nimport { triangel2 } from './triangel2Data';\r\nimport { triangel3 } from './triangel3Data';\r\nimport { triangel4 } from './triangel4Data';\r\n*/\r\n\r\nexport default class WaterTerrainData {\r\n\tprivate waterTriangle1: boolean[][] = [];\r\n\tprivate waterTriangle2: boolean[][] = [];\r\n\tprivate waterTriangle3: boolean[][] = [];\r\n\tprivate waterTriangle4: boolean[][] = [];\r\n\r\n\t/*\r\n\tprivate waterTriangle1: number[][] = triangel1;\r\n\tprivate waterTriangle2: number[][] = triangel2;\r\n\tprivate waterTriangle3: number[][] = triangel3;\r\n\tprivate waterTriangle4: number[][] = triangel4;\r\n\t*/\r\n\r\n\tconstructor() {}\r\n\r\n\tsetData(type: TerrainType, data: boolean[][]): void {\r\n\t\tswitch (type) {\r\n\t\t\tcase TerrainType.WaterTriangle1:\r\n\t\t\t\tthis.waterTriangle1 = data;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle2:\r\n\t\t\t\tthis.waterTriangle2 = data;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle3:\r\n\t\t\t\tthis.waterTriangle3 = data;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle4:\r\n\t\t\t\tthis.waterTriangle4 = data;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error('Unknown water type');\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tincludeWater(type: TerrainType, x: number, y: number): boolean {\r\n\t\tlet state = false;\r\n\t\tlet waterData;\r\n\t\tswitch (type) {\r\n\t\t\tcase TerrainType.WaterTriangle1:\r\n\t\t\t\twaterData = this.waterTriangle1;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle2:\r\n\t\t\t\twaterData = this.waterTriangle2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle3:\r\n\t\t\t\twaterData = this.waterTriangle3;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TerrainType.WaterTriangle4:\r\n\t\t\t\twaterData = this.waterTriangle4;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error('Unknown water type');\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (x < waterData.length && y < waterData[x].length) {\r\n\t\t\tif (waterData[x][y]) state = true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//no water data yet\r\n\t\t\t//no water data == we are in water\r\n\t\t\tif (waterData.length === 0) {\r\n\t\t\t\tstate = true;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthrow new Error('Out of range on water type');\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn state;\r\n\t}\r\n\r\n\t/*\r\n\twrite(): void {\r\n\t\tconst el = document.createElement('p');\r\n\t\tel.style.position = 'absolute';\r\n\t\tel.style.top = '0';\r\n\t\tel.style.left = '0';\r\n\r\n\t\tel.textContent = JSON.stringify(this.waterTriangle4);\r\n\t\tdocument.body.appendChild(el);\r\n\t}\r\n\t*/\r\n}\r\n","import Point from './Point';\r\n\r\nexport default class CollisionPoints {\r\n\tbody: Point[] = [];\r\n\thand: Point[] = [];\r\n\thammer: Point[][] = [];\r\n\tready: boolean = false;\r\n\r\n\tsetData(body: Point[], hand: Point[], hammer: Point[][]) {\r\n\t\tthis.body = body;\r\n\t\tthis.hand = hand;\r\n        this.hammer = hammer;\r\n        this.ready = true;\r\n    }\r\n    \r\n    isReady(): boolean{\r\n        return this.ready;\r\n    }\r\n}\r\n","export default class Hand {\r\n\treadonly size: number;\r\n\treadonly radius: number;\r\n\tprivate x: number;\r\n\tprivate y: number;\r\n\r\n\tconstructor(x: number, y: number, size: number) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.size = size;\r\n\t\tthis.radius = size / 2;\r\n\t}\r\n\r\n\tsetX(x: number): void {\r\n\t\tthis.x = x;\r\n\t}\r\n\r\n\tsetY(y: number): void {\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n\tgetX(): number {\r\n\t\treturn this.x;\r\n\t}\r\n\r\n\tgetY(): number {\r\n\t\treturn this.y;\r\n\t}\r\n\r\n\tgetCenterX(): number {\r\n\t\treturn this.x + this.radius;\r\n\t}\r\n\r\n\tgetCenterY(): number {\r\n\t\treturn this.y + this.radius;\r\n\t}\r\n}\r\n","export default class Blood {\r\n\treadonly size: number = 8;\r\n\tprivate x: number;\r\n\tprivate y: number;\r\n\tprivate timer: number = 0;\r\n\treadonly timerMax: number = 60;\r\n\r\n\tconstructor() {\r\n\t\tthis.x = Math.round(Math.random() * 30) * -1;\r\n\t\tthis.y = Math.round(Math.random() * 30);\r\n\t}\r\n\r\n\tshift(): void {\r\n\t\tthis.x += 0.7;\r\n\t\tthis.y -= 0.7;\r\n\t\tthis.timer++;\r\n\t}\r\n\r\n\tgetX(): number {\r\n\t\treturn this.x;\r\n\t}\r\n\r\n\tgetY(): number {\r\n\t\treturn this.y;\r\n\t}\r\n\r\n\tgetTimer(): number {\r\n\t\treturn this.timer;\r\n\t}\r\n}\r\n","import Hand from './Hand';\r\nimport { Weapon } from './Weapon';\r\nimport PlayerSnapshot from './PlayerSnapshot';\r\nimport Blood from './Blood';\r\n\r\nexport default class Player {\r\n\treadonly id: number;\r\n\treadonly size: number;\r\n\treadonly radius: number;\r\n\tprivate live: boolean = true;\r\n\tprivate x: number;\r\n\tprivate y: number;\r\n\tprivate angle: number;\r\n\tprivate hammerAngle: number;\r\n\treadonly hands: Hand[] = [];\r\n\tprivate weapon: Weapon;\r\n\treadonly bloods: Blood[] = [];\r\n\tprivate vest: boolean = false;\r\n\r\n\tconstructor(playerSnapshot: PlayerSnapshot) {\r\n\t\tthis.id = playerSnapshot.i;\r\n\t\tthis.x = playerSnapshot.x;\r\n\t\tthis.y = playerSnapshot.y;\r\n\t\tthis.angle = playerSnapshot.a;\r\n\t\tthis.hammerAngle = playerSnapshot.m;\r\n\t\tthis.weapon = playerSnapshot.w;\r\n\t\tthis.size = playerSnapshot.size;\r\n\t\tthis.radius = this.size / 2;\r\n\t\tthis.hands.push(new Hand(playerSnapshot.lX, playerSnapshot.lY, playerSnapshot.hSize));\r\n\t\tthis.hands.push(new Hand(playerSnapshot.rX, playerSnapshot.rY, playerSnapshot.hSize));\r\n\t}\r\n\r\n\tcreateInjury(power: number): void {\r\n\t\tconst powerToBlood = 2;\r\n\t\tfor (let i = 0; i < power / powerToBlood; i++) {\r\n\t\t\tthis.bloods.push(new Blood());\r\n\t\t}\r\n\t}\r\n\r\n\tgetVest(): boolean {\r\n\t\treturn this.vest;\r\n\t}\r\n\t\r\n\tsetVest(vest: boolean): void {\r\n\t\tthis.vest = vest;\r\n\t}\r\n\r\n\tdie(): void {\r\n\t\tthis.live = false;\r\n\t}\r\n\r\n\talive(): boolean {\r\n\t\treturn this.live;\r\n\t}\r\n\r\n\tsetX(x: number): void {\r\n\t\tthis.x = x;\r\n\t}\r\n\r\n\tsetY(y: number): void {\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n\tsetAngle(angle: number): void {\r\n\t\tthis.angle = angle;\r\n\t}\r\n\r\n\tsetHammerAngle(hammerAngle: number): void {\r\n\t\tthis.hammerAngle = hammerAngle;\r\n\t}\r\n\r\n\tsetWeapon(weapon: Weapon): void {\r\n\t\tthis.weapon = weapon;\r\n\t}\r\n\r\n\tgetX(): number {\r\n\t\treturn this.x;\r\n\t}\r\n\r\n\tgetY(): number {\r\n\t\treturn this.y;\r\n\t}\r\n\r\n\tgetAngle(): number {\r\n\t\treturn this.angle;\r\n\t}\r\n\r\n\tgetHammerAngle(): number {\r\n\t\treturn this.hammerAngle;\r\n\t}\r\n\r\n\tgetWeapon(): Weapon {\r\n\t\treturn this.weapon;\r\n\t}\r\n\r\n\tgetCenterX(): number {\r\n\t\treturn this.x + this.radius;\r\n\t}\r\n\r\n\tgetCenterY(): number {\r\n\t\treturn this.y + this.radius;\r\n\t}\r\n}\r\n","export default class ZoneCircle {\r\n\tprivate centerX: number;\r\n\tprivate centerY: number;\r\n\tprivate radius: number;\r\n\r\n\tconstructor(centerX: number, centerY: number, radius: number) {\r\n\t\tthis.centerX = centerX;\r\n\t\tthis.centerY = centerY;\r\n\t\tthis.radius = radius;\r\n\t}\r\n\r\n\tsetCenterX(x: number): void {\r\n\t\tthis.centerX = x;\r\n\t}\r\n\r\n\tsetCenterY(y: number): void {\r\n\t\tthis.centerY = y;\r\n\t}\r\n\r\n\tsetRadius(radius: number): void {\r\n\t\tthis.radius = radius;\r\n\t}\r\n\r\n\tgetCenterX(): number {\r\n\t\treturn this.centerX;\r\n\t}\r\n\r\n\tgetCenterY(): number {\r\n\t\treturn this.centerY;\r\n\t}\r\n\r\n\tgetRadius(): number {\r\n\t\treturn this.radius;\r\n\t}\r\n}\r\n","import ZoneCircle from './ZoneCircle';\r\n\r\nexport default class Zone {\r\n\tinnerCircle: ZoneCircle;\r\n\touterCircle: ZoneCircle;\r\n\r\n\tconstructor() {\r\n        this.innerCircle = new ZoneCircle(0, 0, 0);\r\n        this.outerCircle = new ZoneCircle(0, 0, 0);\r\n    }\r\n    \r\n}\r\n","export default class Message{\r\n    readonly text: string;\r\n    readonly time: number;\r\n\r\n    constructor(time: number, text: string){\r\n        this.time = time;\r\n        this.text = text;\r\n    }\r\n}","import WaterCircleSnapshot from './WaterCircleSnapshot';\r\n\r\nexport default class WaterCircle {\r\n\tprivate centerX: number;\r\n\tprivate centerY: number;\r\n\tprivate size: number = 30;\r\n\tprivate opacity: number = 1;\r\n\r\n\tconstructor(waterCircleSnapshot: WaterCircleSnapshot) {\r\n\t\tthis.centerX = waterCircleSnapshot.x;\r\n\t\tthis.centerY = waterCircleSnapshot.y;\r\n\t}\r\n\r\n\tgetX(): number {\r\n\t\treturn this.centerX - this.size / 2;\r\n\t}\r\n\r\n\tgetY(): number {\r\n\t\treturn this.centerY - this.size / 2;\r\n\t}\r\n\r\n\tgetSize(): number {\r\n\t\treturn this.size;\r\n\t}\r\n\r\n\tgetOpacity(): number {\r\n\t\treturn this.opacity;\r\n\t}\r\n\r\n\tflow(frameRateAdjust: number = 1) {\r\n\t\tthis.size += 2 * frameRateAdjust;\r\n\t\tthis.opacity -= 0.02 * frameRateAdjust;\r\n\t}\r\n\r\n\tisActive(): boolean {\r\n\t\treturn this.opacity > 0.04;\r\n\t}\r\n}\r\n","import { Snapshot } from './Snapshot';\r\nimport ServerClientSync from './ServerClientSync';\r\nimport Player from './Player';\r\nimport PlayerSnapshot from './PlayerSnapshot';\r\nimport Zone from './Zone';\r\nimport ZoneSnapshot from './ZoneSnapshot';\r\nimport LootSnapshot from './LootSnapshot';\r\nimport Map from './Map';\r\nimport MyPlayerSnapshot from './MyPlayerSnapshot';\r\nimport Message from './Message';\r\nimport WaterCircle from './WaterCircle';\r\n\r\nexport default class SnapshotManager {\r\n\tprivate serverClientSync: ServerClientSync;\r\n\tprivate snapshots: Snapshot[] = [];\r\n\tprivate map: Map;\r\n\tmessages: Message[] = [];\r\n\tbetweenSnapshot: Snapshot | null;\r\n\tplayers: Player[] = [];\r\n\tzone: Zone;\r\n\twaterCircles: WaterCircle[] = [];\r\n\tnewerExists: boolean = false;\r\n\tolderExists: boolean = false;\r\n\tsumaNewer: number = 0;\r\n\tprivate averageSumaNewer: number[] = [];\r\n\tprivate beforeSnapshotForTestBullets: Snapshot;\r\n\r\n\tconstructor(serverClientSync: ServerClientSync, map: Map) {\r\n\t\tthis.serverClientSync = serverClientSync;\r\n\t\tthis.zone = new Zone();\r\n\t\tthis.map = map;\r\n\t}\r\n\r\n\tprivate addSumaNewer(sumaNewer: number): void {\r\n\t\tconst max = 100;\r\n\t\tthis.averageSumaNewer.push(sumaNewer);\r\n\t\tif (this.averageSumaNewer.length > max) {\r\n\t\t\tthis.averageSumaNewer.splice(0, 1);\r\n\t\t\tlet totalSuma = 0;\r\n\t\t\tfor (const suma of this.averageSumaNewer) {\r\n\t\t\t\ttotalSuma += suma;\r\n\t\t\t}\r\n\t\t\tconsole.log('averageSumaNewer: ', totalSuma / max);\r\n\t\t}\r\n\t}\r\n\r\n\treset(): void {\r\n\t\tthis.snapshots.splice(0, this.snapshots.length);\r\n\t\tthis.players.splice(0, this.players.length);\r\n\t\tthis.betweenSnapshot = null;\r\n\t\tthis.beforeSnapshotForTestBullets = null;\r\n\t}\r\n\r\n\tmessageManager(): void {\r\n\t\t//delete old messages\r\n\t\tconst viewTime = 1000 * 5;\r\n\t\tfor (let i = this.messages.length - 1; i >= 0; i--) {\r\n\t\t\tconst message = this.messages[i];\r\n\t\t\tif (message.time + viewTime < Date.now()) this.messages.splice(i, 1);\r\n\t\t}\r\n\t\t//max 5 messages\r\n\t\tif (this.messages.length > 5) {\r\n\t\t\tconst cut = this.messages.length - 5;\r\n\t\t\tthis.messages.splice(0, cut);\r\n\t\t}\r\n\t}\r\n\r\n\taddSnapshot(snapshot: Snapshot): void {\r\n\t\t/*\r\n\t\t//bullet test\r\n\t\tif (this.beforeSnapshotForTestBullets && snapshot.b) {\r\n\t\t\tconst shift = 400;\r\n\t\t\t//test\r\n\t\t\tfor (const bulletNow of snapshot.b) {\r\n\t\t\t\tfor (const bulletBefore of this.beforeSnapshotForTestBullets.b) {\r\n\t\t\t\t\tif (bulletNow.id === bulletBefore.id) {\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tMath.abs(bulletNow.x - bulletBefore.x) > shift ||\r\n\t\t\t\t\t\t\tMath.abs(bulletNow.y - bulletBefore.y) > shift\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tconsole.log('err: bullet shift');\r\n\t\t\t\t\t\t\tconsole.log('before:', this.beforeSnapshotForTestBullets);\r\n\t\t\t\t\t\t\tconsole.log('now:', snapshot);\r\n\t\t\t\t\t\t\tdebugger;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t//save snapshot\r\n\t\tif (this.beforeSnapshotForTestBullets && this.beforeSnapshotForTestBullets.b) {\r\n\t\t\tthis.beforeSnapshotForTestBullets = snapshot;\r\n\t\t}\r\n\t\t*/\r\n\r\n\t\tlet updateDelay = this.serverClientSync.getDrawDelay() - (this.serverClientSync.getServerTime() - snapshot.t);\r\n\t\tif (updateDelay < 0) updateDelay = 0;\r\n\r\n\t\t//water circles\r\n\t\tif (snapshot.w) {\r\n\t\t\tfor (const waterCircleSnapshot of snapshot.w) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.waterCircles.push(new WaterCircle(waterCircleSnapshot));\r\n\t\t\t\t}, updateDelay);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//delete old water circles\r\n\t\tfor (let i = this.waterCircles.length - 1; i >= 0; i--) {\r\n\t\t\tconst waterCircle = this.waterCircles[i];\r\n\t\t\tif (!waterCircle.isActive()) this.waterCircles.splice(i, 1);\r\n\t\t}\r\n\r\n\t\t//blood animate + vest\r\n\t\tif (snapshot.p) {\r\n\t\t\tfor (const playerSnapshot of snapshot.p) {\r\n\t\t\t\tif (playerSnapshot.d) {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tfor (const player of this.players) {\r\n\t\t\t\t\t\t\tif (player.id === playerSnapshot.i) {\r\n\t\t\t\t\t\t\t\tplayer.createInjury(playerSnapshot.d);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, updateDelay);\r\n\t\t\t\t}\r\n\t\t\t\tif (playerSnapshot.hasOwnProperty('v')) {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tfor (const player of this.players) {\r\n\t\t\t\t\t\t\tif (player.id === playerSnapshot.i) {\r\n\t\t\t\t\t\t\t\tlet vest = false;\r\n\t\t\t\t\t\t\t\tif (playerSnapshot.v === 1) vest = true;\r\n\t\t\t\t\t\t\t\tplayer.setVest(vest);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, updateDelay);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.snapshots.push(snapshot);\r\n\t\tif (this.snapshots.length > 1) {\r\n\t\t\tthis.completeSnapshot(this.snapshots[this.snapshots.length - 2], snapshot);\r\n\t\t}\r\n\t\t//add message\r\n\t\tif (snapshot.m) {\r\n\t\t\tfor (const message of snapshot.m) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.messages.push(new Message(Date.now(), message));\r\n\t\t\t\t}, updateDelay);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//update map\r\n\t\tthis.updateMap(snapshot, updateDelay);\r\n\r\n\t\t//delete old snapshots\r\n\t\tif (this.snapshots.length > 50) {\r\n\t\t\tthis.snapshots.splice(0, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateMap(snapshot: Snapshot, updateDelay: number): void {\r\n\t\tconst obsacleSnapshots = snapshot.o;\r\n\t\tfor (const obstacleSnapshot of obsacleSnapshots) {\r\n\t\t\tswitch (obstacleSnapshot.t) {\r\n\t\t\t\tcase 'w':\r\n\t\t\t\t\tfor (const obstacle of this.map.rectangleObstacles) {\r\n\t\t\t\t\t\tif (obstacle.id === obstacleSnapshot.i) {\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tobstacle.update(obstacleSnapshot.o);\r\n\t\t\t\t\t\t\t}, updateDelay);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'r':\r\n\t\t\t\t\tfor (const obstacle of this.map.rocks) {\r\n\t\t\t\t\t\tif (obstacle.id === obstacleSnapshot.i) {\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tobstacle.update(obstacleSnapshot.o);\r\n\t\t\t\t\t\t\t}, updateDelay);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 't':\r\n\t\t\t\t\tfor (const obstacle of this.map.trees) {\r\n\t\t\t\t\t\tif (obstacle.id === obstacleSnapshot.i) {\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tobstacle.update(obstacleSnapshot.o);\r\n\t\t\t\t\t\t\t}, updateDelay);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'b':\r\n\t\t\t\t\tfor (const obstacle of this.map.bushes) {\r\n\t\t\t\t\t\tif (obstacle.id === obstacleSnapshot.i) {\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tobstacle.update(obstacleSnapshot.o);\r\n\t\t\t\t\t\t\t}, updateDelay);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateZone(): void {\r\n\t\tif (!this.betweenSnapshot) return;\r\n\t\tconst zoneSnapshot = this.betweenSnapshot.z;\r\n\t\t//inner\r\n\t\tthis.zone.innerCircle.setRadius(zoneSnapshot.iR);\r\n\t\tthis.zone.innerCircle.setCenterX(zoneSnapshot.iX);\r\n\t\tthis.zone.innerCircle.setCenterY(zoneSnapshot.iY);\r\n\t\t//outer\r\n\t\tthis.zone.outerCircle.setRadius(zoneSnapshot.oR);\r\n\t\tthis.zone.outerCircle.setCenterX(zoneSnapshot.oX);\r\n\t\tthis.zone.outerCircle.setCenterY(zoneSnapshot.oY);\r\n\t}\r\n\r\n\tprivate completeSnapshot(previousSnapshot: Snapshot, lastSnapshot: Snapshot): void {\r\n\t\tthis.completePlayerSnapshots(previousSnapshot.p, lastSnapshot.p);\r\n\t\tthis.completeMyPlayerSnapshot(previousSnapshot.i, lastSnapshot.i);\r\n\t\tthis.completeLootSnapshots(previousSnapshot.l, lastSnapshot.l);\r\n\t\tthis.completeZoneSnapshot(previousSnapshot.z, lastSnapshot.z);\r\n\t\t//zone delay\r\n\t\tif (!lastSnapshot.z.hasOwnProperty('d')) lastSnapshot.z.d = previousSnapshot.z.d;\r\n\t}\r\n\r\n\tprivate completeMyPlayerSnapshot(\r\n\t\tpreviousMyPlayerSnapshot: MyPlayerSnapshot,\r\n\t\tlastMyPlayerSnapshot: MyPlayerSnapshot\r\n\t): void {\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('h')) lastMyPlayerSnapshot.h = previousMyPlayerSnapshot.h;\r\n\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('i1')) lastMyPlayerSnapshot.i1 = previousMyPlayerSnapshot.i1;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('i2')) lastMyPlayerSnapshot.i2 = previousMyPlayerSnapshot.i2;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('i3')) lastMyPlayerSnapshot.i3 = previousMyPlayerSnapshot.i3;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('i4')) lastMyPlayerSnapshot.i4 = previousMyPlayerSnapshot.i4;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('i5')) lastMyPlayerSnapshot.i5 = previousMyPlayerSnapshot.i5;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('s4')) lastMyPlayerSnapshot.s4 = previousMyPlayerSnapshot.s4;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('s5')) lastMyPlayerSnapshot.s5 = previousMyPlayerSnapshot.s5;\r\n\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('a')) lastMyPlayerSnapshot.a = previousMyPlayerSnapshot.a;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('aM')) lastMyPlayerSnapshot.aM = previousMyPlayerSnapshot.aM;\r\n\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('r')) lastMyPlayerSnapshot.r = previousMyPlayerSnapshot.r;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('g')) lastMyPlayerSnapshot.g = previousMyPlayerSnapshot.g;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('b')) lastMyPlayerSnapshot.b = previousMyPlayerSnapshot.b;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('o')) lastMyPlayerSnapshot.o = previousMyPlayerSnapshot.o;\r\n\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('s')) lastMyPlayerSnapshot.s = previousMyPlayerSnapshot.s;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('v')) lastMyPlayerSnapshot.v = previousMyPlayerSnapshot.v;\r\n\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('l')) lastMyPlayerSnapshot.l = previousMyPlayerSnapshot.l;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('lE')) lastMyPlayerSnapshot.lE = previousMyPlayerSnapshot.lE;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('lT')) lastMyPlayerSnapshot.lT = previousMyPlayerSnapshot.lT;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('spectate'))\r\n\t\t\tlastMyPlayerSnapshot.spectate = previousMyPlayerSnapshot.spectate;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('spectateName'))\r\n\t\t\tlastMyPlayerSnapshot.spectateName = previousMyPlayerSnapshot.spectateName;\r\n\t\tif (!lastMyPlayerSnapshot.hasOwnProperty('ai')) lastMyPlayerSnapshot.ai = previousMyPlayerSnapshot.ai;\r\n\t}\r\n\r\n\tprivate completeZoneSnapshot(previousZoneSnapshot: ZoneSnapshot, lastZoneSnapshot: ZoneSnapshot): void {\r\n\t\tif (!lastZoneSnapshot.hasOwnProperty('iX')) lastZoneSnapshot.iX = previousZoneSnapshot.iX;\r\n\t\tif (!lastZoneSnapshot.hasOwnProperty('iY')) lastZoneSnapshot.iY = previousZoneSnapshot.iY;\r\n\t\tif (!lastZoneSnapshot.hasOwnProperty('iR')) lastZoneSnapshot.iR = previousZoneSnapshot.iR;\r\n\t\tif (!lastZoneSnapshot.hasOwnProperty('oX')) lastZoneSnapshot.oX = previousZoneSnapshot.oX;\r\n\t\tif (!lastZoneSnapshot.hasOwnProperty('oY')) lastZoneSnapshot.oY = previousZoneSnapshot.oY;\r\n\t\tif (!lastZoneSnapshot.hasOwnProperty('oR')) lastZoneSnapshot.oR = previousZoneSnapshot.oR;\r\n\t}\r\n\r\n\tprivate completeLootSnapshots(previousSnapshotLoots: LootSnapshot[], lastSnapshotLoots: LootSnapshot[]): void {\r\n\t\t//copy missing values\r\n\t\tfor (const lastSnapshotLoot of lastSnapshotLoots) {\r\n\t\t\tlet previousSnapshotLoot;\r\n\t\t\tfor (const loot of previousSnapshotLoots) {\r\n\t\t\t\tif (loot.i === lastSnapshotLoot.i) previousSnapshotLoot = loot;\r\n\t\t\t}\r\n\t\t\tif (previousSnapshotLoot) {\r\n\t\t\t\tif (!lastSnapshotLoot.hasOwnProperty('size')) lastSnapshotLoot.size = previousSnapshotLoot.size;\r\n\t\t\t\tif (!lastSnapshotLoot.hasOwnProperty('type')) lastSnapshotLoot.type = previousSnapshotLoot.type;\r\n\t\t\t\tif (!lastSnapshotLoot.hasOwnProperty('x')) lastSnapshotLoot.x = previousSnapshotLoot.x;\r\n\t\t\t\tif (!lastSnapshotLoot.hasOwnProperty('y')) lastSnapshotLoot.y = previousSnapshotLoot.y;\r\n\t\t\t\tif (!lastSnapshotLoot.hasOwnProperty('quantity') && previousSnapshotLoot.hasOwnProperty('quantity'))\r\n\t\t\t\t\tlastSnapshotLoot.quantity = previousSnapshotLoot.quantity;\r\n\t\t\t}\r\n\t\t}\r\n\t\t//find missing objects and copy previous values\r\n\t\tconst missingLoots = [];\r\n\t\tfor (const previous of previousSnapshotLoots) {\r\n\t\t\tlet lootExists = false;\r\n\t\t\tfor (const last of lastSnapshotLoots) {\r\n\t\t\t\tif (previous.i === last.i) {\r\n\t\t\t\t\tlootExists = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!lootExists) {\r\n\t\t\t\tmissingLoots.push(previous);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (const missingLoot of missingLoots) {\r\n\t\t\tlastSnapshotLoots.push(missingLoot);\r\n\t\t}\r\n\r\n\t\t//delete !active loot\r\n\t\tfor (let i = lastSnapshotLoots.length - 1; i >= 0; i--) {\r\n\t\t\tif (lastSnapshotLoots[i].hasOwnProperty('del')) {\r\n\t\t\t\tlastSnapshotLoots.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate completePlayerSnapshots(\r\n\t\tpreviousSnapshotPlayers: PlayerSnapshot[],\r\n\t\tlastSnapshotPlayers: PlayerSnapshot[]\r\n\t): void {\r\n\t\t//copy missing values\r\n\t\tfor (const lastSnapshotPlayer of lastSnapshotPlayers) {\r\n\t\t\tlet previousSnapshotPlayer;\r\n\t\t\tfor (const player of previousSnapshotPlayers) {\r\n\t\t\t\tif (player.i === lastSnapshotPlayer.i) previousSnapshotPlayer = player;\r\n\t\t\t}\r\n\t\t\tif (previousSnapshotPlayer) {\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('a')) lastSnapshotPlayer.a = previousSnapshotPlayer.a;\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('m')) lastSnapshotPlayer.m = previousSnapshotPlayer.m;\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('size')) lastSnapshotPlayer.size = previousSnapshotPlayer.size;\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('w')) lastSnapshotPlayer.w = previousSnapshotPlayer.w;\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('x')) lastSnapshotPlayer.x = previousSnapshotPlayer.x;\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('y')) lastSnapshotPlayer.y = previousSnapshotPlayer.y;\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('l')) lastSnapshotPlayer.l = previousSnapshotPlayer.l;\r\n\t\t\t\t//hands\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('hSize'))\r\n\t\t\t\t\tlastSnapshotPlayer.hSize = previousSnapshotPlayer.hSize;\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('lX')) lastSnapshotPlayer.lX = previousSnapshotPlayer.lX;\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('lY')) lastSnapshotPlayer.lY = previousSnapshotPlayer.lY;\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('rX')) lastSnapshotPlayer.rX = previousSnapshotPlayer.rX;\r\n\t\t\t\tif (!lastSnapshotPlayer.hasOwnProperty('rY')) lastSnapshotPlayer.rY = previousSnapshotPlayer.rY;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//find missing players and copy previous values\r\n\t\tconst missingPlayerIds = [];\r\n\t\tfor (const previousSnapshotPlayer of previousSnapshotPlayers) {\r\n\t\t\tlet playerExists = false;\r\n\t\t\tfor (const lastSnapshotPlayer of lastSnapshotPlayers) {\r\n\t\t\t\tif (previousSnapshotPlayer.i === lastSnapshotPlayer.i) {\r\n\t\t\t\t\tplayerExists = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!playerExists) {\r\n\t\t\t\tmissingPlayerIds.push(previousSnapshotPlayer.i);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//copy previous snapshot\r\n\t\tfor (const missingPlayerId of missingPlayerIds) {\r\n\t\t\tfor (const previousSnapshotPlayer of previousSnapshotPlayers) {\r\n\t\t\t\tif (missingPlayerId === previousSnapshotPlayer.i) {\r\n\t\t\t\t\tlastSnapshotPlayers.push(previousSnapshotPlayer);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t//sort by id!\r\n\t\tlastSnapshotPlayers.sort((a: PlayerSnapshot, b: PlayerSnapshot) => {\r\n\t\t\treturn a.i - b.i;\r\n\t\t});\r\n\t}\r\n\r\n\t//1. urcime si cas pred nejakou dobou a budeme hledat snimky hry pred timto a za timto bodem (ServerClientSync class)\r\n\t//2. nemuzeme se spolehnout jen na cas klienta a musime nejperve synchronizovat (ServerClientSync class)\r\n\t//3. dopocitame stav mezi snimky\r\n\tcreateBetweenSnapshot(): void {\r\n\t\tif (this.snapshots.length && this.serverClientSync.ready()) {\r\n\t\t\tlet percentShift = 0;\r\n\t\t\tthis.sumaNewer = 0;\r\n\t\t\tthis.newerExists = false;\r\n\t\t\tthis.olderExists = false;\r\n\t\t\tlet newerSnapshot: Snapshot;\r\n\t\t\tlet olderSnapshot: Snapshot;\r\n\r\n\t\t\tconst wantedSnapshotTime = this.serverClientSync.getServerTime() - this.serverClientSync.getDrawDelay();\r\n\t\t\t//find last older (or same <=) snapshot\r\n\t\t\tfor (const snapshot of this.snapshots) {\r\n\t\t\t\tif (snapshot.t <= wantedSnapshotTime) {\r\n\t\t\t\t\tolderSnapshot = snapshot;\r\n\t\t\t\t\tthis.olderExists = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//find first newer (or same >=) snapshot\r\n\t\t\tfor (const snapshot of this.snapshots) {\r\n\t\t\t\tif (snapshot.t >= wantedSnapshotTime) {\r\n\t\t\t\t\tif (!newerSnapshot) {\r\n\t\t\t\t\t\tnewerSnapshot = snapshot;\r\n\t\t\t\t\t\tthis.newerExists = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.sumaNewer++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//if newerSnapshot is missing use older...\r\n\t\t\tif (!newerSnapshot) {\r\n\t\t\t\tnewerSnapshot = olderSnapshot;\r\n\t\t\t}\r\n\r\n\t\t\t//change draw delay\r\n\t\t\tthis.serverClientSync.changeSumaNewer(this.sumaNewer);\r\n\r\n\t\t\t//this.addSumaNewer(this.sumaNewer);\r\n\r\n\t\t\t//calc positions\r\n\t\t\tif (olderSnapshot && newerSnapshot) {\r\n\t\t\t\tconst timeDistance = newerSnapshot.t - olderSnapshot.t;\r\n\r\n\t\t\t\tconst distanceOlderFromWantedTime = wantedSnapshotTime - olderSnapshot.t;\r\n\t\t\t\tif (timeDistance) {\r\n\t\t\t\t\tpercentShift = distanceOlderFromWantedTime / timeDistance;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//deep copy!\r\n\t\t\t\tconst copyFrom = newerSnapshot;\r\n\t\t\t\t//slow copy\r\n\t\t\t\t//this.betweenSnapshots = JSON.parse(JSON.stringify(copyFrom));\r\n\r\n\t\t\t\t//fast copy\r\n\t\t\t\tthis.betweenSnapshot = {\r\n\t\t\t\t\tt: copyFrom.t,\r\n\t\t\t\t\ti: { ...copyFrom.i },\r\n\t\t\t\t\tp: [],\r\n\t\t\t\t\tb: [],\r\n\t\t\t\t\tg: [],\r\n\t\t\t\t\ts: [],\r\n\t\t\t\t\tz: { ...copyFrom.z },\r\n\t\t\t\t\tl: [],\r\n\t\t\t\t\to: []\r\n\t\t\t\t};\r\n\r\n\t\t\t\tfor (const player of copyFrom.p) {\r\n\t\t\t\t\tthis.betweenSnapshot.p.push({ ...player });\r\n\t\t\t\t}\r\n\t\t\t\tfor (const bullet of copyFrom.b) {\r\n\t\t\t\t\tthis.betweenSnapshot.b.push({ ...bullet });\r\n\t\t\t\t}\r\n\t\t\t\tfor (const granade of copyFrom.g) {\r\n\t\t\t\t\tthis.betweenSnapshot.g.push({ ...granade });\r\n\t\t\t\t}\r\n\t\t\t\tfor (const smoke of copyFrom.s) {\r\n\t\t\t\t\tthis.betweenSnapshot.s.push({ ...smoke });\r\n\t\t\t\t}\r\n\t\t\t\tfor (const loot of copyFrom.l) {\r\n\t\t\t\t\tthis.betweenSnapshot.l.push({ ...loot });\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//players\r\n\t\t\t\tfor (let i = 0; i < this.betweenSnapshot.p.length; i++) {\r\n\t\t\t\t\tconst player = this.betweenSnapshot.p[i];\r\n\t\t\t\t\tplayer.x = this.positionBetweenSnapshots(olderSnapshot.p[i].x, newerSnapshot.p[i].x, percentShift);\r\n\t\t\t\t\tplayer.y = this.positionBetweenSnapshots(olderSnapshot.p[i].y, newerSnapshot.p[i].y, percentShift);\r\n\t\t\t\t\t//hands\r\n\t\t\t\t\t//deny between snapshot...\r\n\t\t\t\t\tif (!player.h) {\r\n\t\t\t\t\t\tplayer.lX = this.positionBetweenSnapshots(\r\n\t\t\t\t\t\t\tolderSnapshot.p[i].lX,\r\n\t\t\t\t\t\t\tnewerSnapshot.p[i].lX,\r\n\t\t\t\t\t\t\tpercentShift\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tplayer.lY = this.positionBetweenSnapshots(\r\n\t\t\t\t\t\t\tolderSnapshot.p[i].lY,\r\n\t\t\t\t\t\t\tnewerSnapshot.p[i].lY,\r\n\t\t\t\t\t\t\tpercentShift\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tplayer.rX = this.positionBetweenSnapshots(\r\n\t\t\t\t\t\t\tolderSnapshot.p[i].rX,\r\n\t\t\t\t\t\t\tnewerSnapshot.p[i].rX,\r\n\t\t\t\t\t\t\tpercentShift\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tplayer.rY = this.positionBetweenSnapshots(\r\n\t\t\t\t\t\t\tolderSnapshot.p[i].rY,\r\n\t\t\t\t\t\t\tnewerSnapshot.p[i].rY,\r\n\t\t\t\t\t\t\tpercentShift\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//loot\r\n\t\t\t\tfor (const loot of this.betweenSnapshot.l) {\r\n\t\t\t\t\tlet olderLoot, newerLoot;\r\n\t\t\t\t\tfor (const older of olderSnapshot.l) {\r\n\t\t\t\t\t\tif (loot.i === older.i) {\r\n\t\t\t\t\t\t\tolderLoot = older;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (const newer of newerSnapshot.l) {\r\n\t\t\t\t\t\tif (loot.i === newer.i) {\r\n\t\t\t\t\t\t\tnewerLoot = newer;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (olderLoot && newerLoot) {\r\n\t\t\t\t\t\tloot.x = this.positionBetweenSnapshots(olderLoot.x, newerLoot.x, percentShift);\r\n\t\t\t\t\t\tloot.y = this.positionBetweenSnapshots(olderLoot.y, newerLoot.y, percentShift);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//zone\r\n\t\t\t\tthis.betweenSnapshot.z.oR = this.positionBetweenSnapshots(\r\n\t\t\t\t\tolderSnapshot.z.oR,\r\n\t\t\t\t\tnewerSnapshot.z.oR,\r\n\t\t\t\t\tpercentShift\r\n\t\t\t\t);\r\n\t\t\t\tthis.betweenSnapshot.z.oX = this.positionBetweenSnapshots(\r\n\t\t\t\t\tolderSnapshot.z.oX,\r\n\t\t\t\t\tnewerSnapshot.z.oX,\r\n\t\t\t\t\tpercentShift\r\n\t\t\t\t);\r\n\t\t\t\tthis.betweenSnapshot.z.oY = this.positionBetweenSnapshots(\r\n\t\t\t\t\tolderSnapshot.z.oY,\r\n\t\t\t\t\tnewerSnapshot.z.oY,\r\n\t\t\t\t\tpercentShift\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.updatePlayers();\r\n\t\tthis.updateZone();\r\n\t}\r\n\r\n\tprivate updatePlayers(): void {\r\n\t\tif (!this.betweenSnapshot) return;\r\n\t\tfor (const playerSnapshot of this.betweenSnapshot.p) {\r\n\t\t\tlet playerExists = false;\r\n\t\t\tfor (const playerInstance of this.players) {\r\n\t\t\t\tif (playerInstance.id === playerSnapshot.i) {\r\n\t\t\t\t\t//update player\r\n\t\t\t\t\tplayerInstance.setX(playerSnapshot.x);\r\n\t\t\t\t\tplayerInstance.setY(playerSnapshot.y);\r\n\t\t\t\t\tplayerInstance.setAngle(playerSnapshot.a);\r\n\t\t\t\t\tplayerInstance.setWeapon(playerSnapshot.w);\r\n\t\t\t\t\tplayerInstance.setHammerAngle(playerSnapshot.m);\r\n\t\t\t\t\tif (playerSnapshot.l === 0) playerInstance.die();\r\n\t\t\t\t\t//hands\r\n\t\t\t\t\tplayerInstance.hands[0].setX(playerSnapshot.lX);\r\n\t\t\t\t\tplayerInstance.hands[0].setY(playerSnapshot.lY);\r\n\t\t\t\t\tplayerInstance.hands[1].setX(playerSnapshot.rX);\r\n\t\t\t\t\tplayerInstance.hands[1].setY(playerSnapshot.rY);\r\n\t\t\t\t\tplayerExists = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!playerExists) {\r\n\t\t\t\t//create player\r\n\t\t\t\tthis.players.push(new Player(playerSnapshot));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate positionBetweenSnapshots(olderPosition: number, newerPosition: number, percentShift: number): number {\r\n\t\tconst diference = Math.abs(newerPosition - olderPosition);\r\n\t\tlet direction = 1;\r\n\t\tif (newerPosition < olderPosition) direction = -1;\r\n\t\treturn olderPosition + diference * direction * percentShift;\r\n\t}\r\n}\r\n","import { Mouse } from './Controller';\r\nimport Socket from './Socket';\r\nimport View from './View';\r\nimport Map from './Map';\r\nimport WaterTerrainData from './WaterTerrainData';\r\nimport ServerClientSync from './ServerClientSync';\r\nimport MyHtmlElements from './MyHtmlElements';\r\nimport Editor from './Editor';\r\nimport CollisionPoints from './CollisionPoints';\r\nimport SnapshotManager from './SnapshotManager';\r\n\r\nexport default class Model {\r\n\tprivate spectate: boolean = false;\r\n\tprivate gameRun: boolean = false;\r\n\tprivate gameId: number = -1;\r\n\tprivate playerId: number = -1;\r\n\tprivate name: string;\r\n\tview: View;\r\n\tprivate socket: Socket;\r\n\tprivate waterTerrainData: WaterTerrainData;\r\n\tprivate mouse: Mouse;\r\n\tmap: Map;\r\n\tprivate serverClientSync: ServerClientSync;\r\n\tsnapshotManager: SnapshotManager;\r\n\tprivate myHtmlElements: MyHtmlElements;\r\n\tprivate editor: Editor;\r\n\tcollisionPoints: CollisionPoints;\r\n\r\n\tconstructor(\r\n\t\tmouse: Mouse,\r\n\t\tsocket: Socket,\r\n\t\tserverClientSync: ServerClientSync,\r\n\t\tmyHtmlElements: MyHtmlElements,\r\n\t\teditor: Editor\r\n\t) {\r\n\t\tthis.socket = socket;\r\n\t\tthis.serverClientSync = serverClientSync;\r\n\t\tthis.waterTerrainData = new WaterTerrainData();\r\n\t\tthis.map = new Map(this.waterTerrainData);\r\n\t\tthis.snapshotManager = new SnapshotManager(serverClientSync, this.map);\r\n\t\tthis.mouse = mouse;\r\n\t\tthis.myHtmlElements = myHtmlElements;\r\n\t\tthis.editor = editor;\r\n\t\tthis.collisionPoints = new CollisionPoints();\r\n\t\tthis.view = new View(\r\n\t\t\tthis.map,\r\n\t\t\tthis.mouse,\r\n\t\t\tthis.waterTerrainData,\r\n\t\t\tthis.myHtmlElements,\r\n\t\t\tthis.collisionPoints,\r\n\t\t\tthis.snapshotManager\r\n\t\t);\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.loop();\r\n\t\t}, 200);\r\n\t}\r\n\r\n\treset(): void {\r\n\t\tconst el = this.myHtmlElements;\r\n\t\tel.close(el.gameOverMenu.main);\r\n\t\tel.open(el.mainMenu.main, el.hideGame);\r\n\t\tel.gameOverMenu.stats.innerHTML = '';\r\n\t\tthis.gameRun = false;\r\n\t\tthis.gameId = -1;\r\n\t\tthis.playerId = -1;\r\n\t\tthis.map.reset();\r\n\t\tthis.snapshotManager.reset();\r\n\t\tthis.view.reset();\r\n\t\tthis.spectate = false;\r\n\t\tthis.serverClientSync.reset();\r\n\t}\r\n\r\n\tstop(): void {\r\n\t\tthis.gameRun = false;\r\n\t}\r\n\r\n\tisNameOk(name: string): boolean {\r\n\t\tlet state = false;\r\n\t\tconst allowedCharacters: string = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ';\r\n\t\tconst nameMaxLength: number = 20;\r\n\t\tif (typeof name === 'string') {\r\n\t\t\tif (name.length > 0 && name.length <= nameMaxLength) {\r\n\t\t\t\t//nepovolen znaky v jmnu?\r\n\t\t\t\tlet notAllowedCharacter = false;\r\n\t\t\t\tfor (let i = 0; i < name.length; i++) {\r\n\t\t\t\t\tif (allowedCharacters.lastIndexOf(name[i]) === -1) {\r\n\t\t\t\t\t\tnotAllowedCharacter = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//v jmenu nejsou nepovolene znaky\r\n\t\t\t\tif (!notAllowedCharacter) {\r\n\t\t\t\t\tstate = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn state;\r\n\t}\r\n\r\n\tstartSpectate(): void {\r\n\t\tthis.spectate = true;\r\n\t}\r\n\r\n\tgetSpectate(): boolean {\r\n\t\treturn this.spectate;\r\n\t}\r\n\r\n\tsetName(name: string): void {\r\n\t\tthis.name = name;\r\n\t}\r\n\r\n\tgetName(): string {\r\n\t\treturn this.name;\r\n\t}\r\n\r\n\tgetGameId(): number {\r\n\t\treturn this.gameId;\r\n\t}\r\n\r\n\tsetGameId(gameId: number): void {\r\n\t\tthis.gameId = gameId;\r\n\t}\r\n\r\n\tgetPlayerId(): number {\r\n\t\treturn this.playerId;\r\n\t}\r\n\r\n\tsetPlayerId(playerId: number): void {\r\n\t\tthis.playerId = playerId;\r\n\t}\r\n\r\n\tgameStart(): void {\r\n\t\tthis.gameRun = true;\r\n\t\tthis.snapshotManager.reset();\r\n\t}\r\n\r\n\tgameActive(): boolean {\r\n\t\treturn this.gameRun;\r\n\t}\r\n\tprivate loop(): void {\r\n\t\t//repeat\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tthis.loop();\r\n\t\t});\r\n\t\tif (this.editor.isActive()) {\r\n\t\t\tthis.view.drawEditor(this.editor);\r\n\t\t}\r\n\t\t//sync\r\n\t\tif (!this.serverClientSync.ready()) {\r\n\t\t\tif (Math.random() > 0.8) this.socket.emit('serverClientSync', Date.now());\r\n\t\t}\r\n\t\tif (!this.gameRun) return;\r\n\t\tthis.snapshotManager.createBetweenSnapshot();\r\n\t\tthis.view.drawGame(this.playerId);\r\n\t}\r\n}\r\n","export default class ServerClientSync {\r\n\tprivate ping: number = 0;\r\n\tprivate pings: number[] = [];\r\n\tprivate timeDiference: number = 0;\r\n\tprivate timeDiferences: number[] = [];\r\n\tprivate readonly pingAttempts: number = 5;\r\n\tprivate readonly defaultDrawDelay: number = 70;\r\n\tprivate drawDelay: number = this.defaultDrawDelay;\r\n\tprivate minWantedSumaNewerSnapshots: number = 3;\r\n\tprivate defaultWantedNewerSnapshots: number = 5;\r\n\tprivate wantedSumaNewerSnapshots: number = this.defaultWantedNewerSnapshots;\r\n\tprivate maxWantedSumaNewerSnapshots: number = 11;\r\n\tprivate lags: number = 0;\r\n\tprivate readonly maxLags: number = 10;\r\n\tprivate lastLagTime: number = 0;\r\n\r\n\tconstructor() {}\r\n\r\n\tgetPing(): number {\r\n\t\treturn this.ping;\r\n\t}\r\n\r\n\tgetTimeDiference(): number {\r\n\t\treturn this.timeDiference;\r\n\t}\r\n\r\n\tchangeSumaNewer(sumaNewer: number): void {\r\n\t\t//lag\r\n\t\tif (sumaNewer === 0) {\r\n\t\t\tthis.lags++;\r\n\t\t\tthis.lastLagTime = Date.now();\r\n\t\t\t//console.log('lag');\r\n\t\t}\r\n\t\t//more NewerSnapshots\r\n\t\tif (this.lags === this.maxLags) {\r\n\t\t\tif (this.wantedSumaNewerSnapshots < this.maxWantedSumaNewerSnapshots) {\r\n\t\t\t\tthis.wantedSumaNewerSnapshots++;\r\n\t\t\t\t//console.clear();\r\n\t\t\t\t//console.log('wantedSumaNewerSnapshots', this.wantedSumaNewerSnapshots);\r\n\t\t\t\tthis.lags = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\t//less newerSnapshots\r\n\t\tconst gap = 1000 * 5;\r\n\t\tif (this.lastLagTime && this.lastLagTime + gap < Date.now()) {\r\n\t\t\tif (this.wantedSumaNewerSnapshots > this.minWantedSumaNewerSnapshots) {\r\n\t\t\t\tthis.wantedSumaNewerSnapshots--;\r\n\t\t\t\tthis.lags = 0;\r\n\t\t\t\tthis.lastLagTime = Date.now();\r\n\t\t\t\t//console.clear();\r\n\t\t\t\t//console.log('wantedSumaNewerSnapshots', this.wantedSumaNewerSnapshots);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tswitch (this.wantedSumaNewerSnapshots) {\r\n\t\t\tcase 3:\r\n\t\t\t\tif (sumaNewer === 0) this.changeDrawDelay(5);\r\n\t\t\t\tif (sumaNewer === 1) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 2) this.changeDrawDelay(0.2);\r\n\r\n\t\t\t\tif (sumaNewer === 4) this.changeDrawDelay(-0.2);\r\n\t\t\t\tif (sumaNewer === 5) this.changeDrawDelay(-0.5);\r\n\t\t\t\tif (sumaNewer === 6) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 7) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 8) this.changeDrawDelay(-5);\r\n\r\n\t\t\t\tif (sumaNewer > 8) this.changeDrawDelay(-10);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 4:\r\n\t\t\t\tif (sumaNewer === 0) this.changeDrawDelay(5);\r\n\t\t\t\tif (sumaNewer === 1) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 2) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 3) this.changeDrawDelay(0.2);\r\n\r\n\t\t\t\tif (sumaNewer === 5) this.changeDrawDelay(-0.2);\r\n\t\t\t\tif (sumaNewer === 6) this.changeDrawDelay(-0.5);\r\n\t\t\t\tif (sumaNewer === 7) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 8) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 9) this.changeDrawDelay(-5);\r\n\r\n\t\t\t\tif (sumaNewer > 9) this.changeDrawDelay(-10);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 5:\r\n\t\t\t\tif (sumaNewer === 0) this.changeDrawDelay(5);\r\n\t\t\t\tif (sumaNewer === 1) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 2) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 3) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 4) this.changeDrawDelay(0.2);\r\n\r\n\t\t\t\tif (sumaNewer === 6) this.changeDrawDelay(-0.2);\r\n\t\t\t\tif (sumaNewer === 7) this.changeDrawDelay(-0.5);\r\n\t\t\t\tif (sumaNewer === 8) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 9) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 10) this.changeDrawDelay(-5);\r\n\r\n\t\t\t\tif (sumaNewer > 10) this.changeDrawDelay(-10);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 6:\r\n\t\t\t\tif (sumaNewer === 0) this.changeDrawDelay(5);\r\n\t\t\t\tif (sumaNewer === 1) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 2) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 3) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 4) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 5) this.changeDrawDelay(0.2);\r\n\r\n\t\t\t\tif (sumaNewer === 7) this.changeDrawDelay(-0.2);\r\n\t\t\t\tif (sumaNewer === 8) this.changeDrawDelay(-0.5);\r\n\t\t\t\tif (sumaNewer === 9) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 10) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 11) this.changeDrawDelay(-5);\r\n\r\n\t\t\t\tif (sumaNewer > 11) this.changeDrawDelay(-10);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 7:\r\n\t\t\t\tif (sumaNewer === 0) this.changeDrawDelay(5);\r\n\t\t\t\tif (sumaNewer === 1) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 2) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 3) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 4) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 5) this.changeDrawDelay(0.2);\r\n\t\t\t\tif (sumaNewer === 6) this.changeDrawDelay(0.2);\r\n\r\n\t\t\t\tif (sumaNewer === 8) this.changeDrawDelay(-0.2);\r\n\t\t\t\tif (sumaNewer === 9) this.changeDrawDelay(-0.5);\r\n\t\t\t\tif (sumaNewer === 10) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 11) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 12) this.changeDrawDelay(-5);\r\n\r\n\t\t\t\tif (sumaNewer > 12) this.changeDrawDelay(-10);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 8:\r\n\t\t\t\tif (sumaNewer === 0) this.changeDrawDelay(5);\r\n\t\t\t\tif (sumaNewer === 1) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 2) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 3) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 4) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 5) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 6) this.changeDrawDelay(0.2);\r\n\t\t\t\tif (sumaNewer === 7) this.changeDrawDelay(0.2);\r\n\r\n\t\t\t\tif (sumaNewer === 9) this.changeDrawDelay(-0.2);\r\n\t\t\t\tif (sumaNewer === 10) this.changeDrawDelay(-0.5);\r\n\t\t\t\tif (sumaNewer === 11) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 12) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 13) this.changeDrawDelay(-5);\r\n\r\n\t\t\t\tif (sumaNewer > 13) this.changeDrawDelay(-10);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 9:\r\n\t\t\t\tif (sumaNewer === 0) this.changeDrawDelay(5);\r\n\t\t\t\tif (sumaNewer === 1) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 2) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 3) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 4) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 5) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 6) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 7) this.changeDrawDelay(0.2);\r\n\t\t\t\tif (sumaNewer === 8) this.changeDrawDelay(0.2);\r\n\r\n\t\t\t\tif (sumaNewer === 10) this.changeDrawDelay(-0.2);\r\n\t\t\t\tif (sumaNewer === 11) this.changeDrawDelay(-0.5);\r\n\t\t\t\tif (sumaNewer === 12) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 13) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 14) this.changeDrawDelay(-5);\r\n\r\n\t\t\t\tif (sumaNewer > 14) this.changeDrawDelay(-10);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 10:\r\n\t\t\t\tif (sumaNewer === 0) this.changeDrawDelay(5);\r\n\t\t\t\tif (sumaNewer === 1) this.changeDrawDelay(5);\r\n\t\t\t\tif (sumaNewer === 2) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 3) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 4) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 5) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 6) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 7) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 8) this.changeDrawDelay(0.2);\r\n\t\t\t\tif (sumaNewer === 9) this.changeDrawDelay(0.2);\r\n\r\n\t\t\t\tif (sumaNewer === 11) this.changeDrawDelay(-0.2);\r\n\t\t\t\tif (sumaNewer === 12) this.changeDrawDelay(-0.5);\r\n\t\t\t\tif (sumaNewer === 13) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 14) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 15) this.changeDrawDelay(-5);\r\n\r\n\t\t\t\tif (sumaNewer > 5) this.changeDrawDelay(-10);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 11:\r\n\t\t\t\tif (sumaNewer === 0) this.changeDrawDelay(10);\r\n\t\t\t\tif (sumaNewer === 1) this.changeDrawDelay(5);\r\n\t\t\t\tif (sumaNewer === 2) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 3) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 4) this.changeDrawDelay(2);\r\n\t\t\t\tif (sumaNewer === 5) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 6) this.changeDrawDelay(1);\r\n\t\t\t\tif (sumaNewer === 7) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 8) this.changeDrawDelay(0.5);\r\n\t\t\t\tif (sumaNewer === 9) this.changeDrawDelay(0.2);\r\n\t\t\t\tif (sumaNewer === 10) this.changeDrawDelay(0.2);\r\n\r\n\t\t\t\tif (sumaNewer === 12) this.changeDrawDelay(-0.2);\r\n\t\t\t\tif (sumaNewer === 13) this.changeDrawDelay(-0.5);\r\n\t\t\t\tif (sumaNewer === 14) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 15) this.changeDrawDelay(-2);\r\n\t\t\t\tif (sumaNewer === 16) this.changeDrawDelay(-5);\r\n\t\t\t\tif (sumaNewer > 16) this.changeDrawDelay(-10);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tready(): boolean {\r\n\t\treturn this.pings.length === this.pingAttempts;\r\n\t}\r\n\r\n\treset(): void {\r\n\t\tthis.pings = [];\r\n\t\tthis.timeDiferences = [];\r\n\t\tthis.ping = 0;\r\n\t\tthis.timeDiference = 0;\r\n\t\tthis.drawDelay = this.defaultDrawDelay;\r\n\t\tthis.wantedSumaNewerSnapshots = this.defaultWantedNewerSnapshots;\r\n\t\tthis.lags = 0;\r\n\t\tthis.lastLagTime = 0;\r\n\t}\r\n\r\n\taddData(ping: number, timeDiference: number): void {\r\n\t\tif (!this.ready()) {\r\n\t\t\tthis.pings.push(ping);\r\n\t\t\tthis.timeDiferences.push(timeDiference);\r\n\t\t}\r\n\t\t//count average\r\n\t\tif (this.pings.length === this.pingAttempts) {\r\n\t\t\tlet pingsSuma = 0;\r\n\t\t\tfor (const ping of this.pings) {\r\n\t\t\t\tpingsSuma += ping;\r\n\t\t\t}\r\n\t\t\tthis.ping = pingsSuma / this.pingAttempts;\r\n\t\t\tlet timeDiferenceSuma = 0;\r\n\t\t\tfor (const timeDiference of this.timeDiferences) {\r\n\t\t\t\ttimeDiferenceSuma += timeDiference;\r\n\t\t\t}\r\n\t\t\tthis.timeDiference = timeDiferenceSuma / this.pingAttempts;\r\n\t\t}\r\n\t}\r\n\r\n\tchangeDrawDelay(change: number): void {\r\n\t\tthis.drawDelay += change;\r\n\t}\r\n\r\n\tgetDrawDelay(): number {\r\n\t\treturn this.drawDelay;\r\n\t}\r\n\r\n\tgetServerTime(): number {\r\n\t\tlet serverTime = Date.now();\r\n\t\tif (this.ready()) {\r\n\t\t\tserverTime += this.getTimeDiference();\r\n\t\t}\r\n\t\treturn serverTime;\r\n\t}\r\n}\r\n","export default class MyHtmlElements {\r\n\treadonly gameScreen: HTMLElement;\r\n\treadonly mapScreen: HTMLElement;\r\n\treadonly mapContainer: HTMLElement;\r\n\treadonly zoneTimer: HTMLElement;\r\n\treadonly helperScreen: HTMLElement;\r\n\treadonly zoneSVG: HTMLElement;\r\n\treadonly zoneCircle: HTMLElement;\r\n\treadonly zoneRect: HTMLElement;\r\n\treadonly mapZoneSVG: HTMLElement;\r\n\treadonly mapZoneCircle: HTMLElement;\r\n\treadonly takeLoot: HTMLElement;\r\n\treadonly transparentLayer: HTMLElement;\r\n\treadonly activeGunAmmo: HTMLElement;\r\n\treadonly alive: HTMLElement;\r\n\treadonly messages: HTMLElement;\r\n\treadonly spectate: HTMLElement;\r\n\treadonly spectateName: HTMLElement;\r\n\treadonly hideGame: HTMLElement;\r\n\treadonly itNetwork: HTMLElement;\r\n\r\n\t//<div id=\"healthBar\"><div id=\"healthBarIn\"></div></div>\r\n\treadonly healthBar = {\r\n\t\tmain: document.getElementById('healthBar'),\r\n\t\tin: document.getElementById('healthBarIn')\r\n\t};\r\n\r\n\treadonly items = {\r\n\t\tredAmmo: document.getElementById('redAmmo'),\r\n\t\tgreenAmmo: document.getElementById('greenAmmo'),\r\n\t\tblueAmmo: document.getElementById('blueAmmo'),\r\n\t\torangeAmmo: document.getElementById('orangeAmmo'),\r\n\t\titem1: document.getElementById('item1'),\r\n\t\titem2: document.getElementById('item2'),\r\n\t\titem3: document.getElementById('item3'),\r\n\t\titem4: document.getElementById('item4'),\r\n\t\titem5: document.getElementById('item5'),\r\n\t\titem1in: document.getElementById('item1').getElementsByTagName('span')[0],\r\n\t\titem2in: document.getElementById('item2').getElementsByTagName('span')[0],\r\n\t\titem3in: document.getElementById('item3').getElementsByTagName('span')[0],\r\n\t\titem4in: document.getElementById('item4').getElementsByTagName('span')[0],\r\n\t\titem5in: document.getElementById('item5').getElementsByTagName('span')[0],\r\n\t\titem1Ammo: document.getElementById('item1Ammo'),\r\n\t\titem2Ammo: document.getElementById('item2Ammo'),\r\n\t\tscope: document.getElementById('scope'),\r\n\t\tscope2: document.getElementById('scope2'),\r\n\t\tscope4: document.getElementById('scope4'),\r\n\t\tscope6: document.getElementById('scope6'),\r\n\t\tscopeSVG: document.getElementById('scope').getElementsByTagName('img')[0],\r\n\t\tvest: document.getElementById('vest')\r\n\t};\r\n\r\n\treadonly editor = {\r\n\t\tcoordinates: document.getElementById('editorCoordinates'),\r\n\t\tcontainer: document.getElementById('editorContainer'),\r\n\t\tscreen: document.getElementById('editorScreen'),\r\n\t\tterrainImgs: document.getElementById('editorTerrainImgs'),\r\n\t\tterrainWater: document.getElementById('terrainWater'),\r\n\t\tterrainGrass: document.getElementById('terrainGrass'),\r\n\t\tterrainWaterTriangle1: document.getElementById('terrainWaterTriangle1'),\r\n\t\tterrainWaterTriangle2: document.getElementById('terrainWaterTriangle2'),\r\n\t\tterrainWaterTriangle3: document.getElementById('terrainWaterTriangle3'),\r\n\t\tterrainWaterTriangle4: document.getElementById('terrainWaterTriangle4'),\r\n\t\tobjectImgs: document.getElementById('editorObjectImgs'),\r\n\t\tobjectBush: document.getElementById('editorObjectBush'),\r\n\t\tobjectRock: document.getElementById('editorObjectRock'),\r\n\t\tobjectTree: document.getElementById('editorObjectTree'),\r\n\t\tobjectRect: document.getElementById('editorObjectRect'),\r\n\t\tobjectHorizontalWall: document.getElementById('editorObjectHorizontalWall'),\r\n\t\tobjectVerticalWall: document.getElementById('editorObjectVerticalWall'),\r\n\t\tobjectDelete: document.getElementById('editorObjectDelete'),\r\n\t\topenMenu: document.getElementById('editorOpenMenu')\r\n\t};\r\n\r\n\t/*\r\n\t<div class=\"menu\" id=\"saveMapMenu\">\r\n        <h1>Saved</h1>\r\n        <button id=\"saveMapMenuBack\">Back to main menu</button>\r\n\t</div>\r\n\t*/\r\n\treadonly saveMapMenu = {\r\n\t\tmain: document.getElementById('saveMapMenu'),\r\n\t\tback: document.getElementById('saveMapMenuBack')\r\n\t};\r\n\r\n\t/*\r\n\t<div class=\"menu\" id=\"mapEditorMenu\">\r\n\t\t<h1>Map editor</h1>\r\n\t\t<input id=\"mapEditorMenuName\" type=\"text\" maxlength=\"20\" placeholder=\"Map name\" value=\"\" autocomplete=\"off\">\r\n\t\t<button id=\"mapEditorMenuSave\">Save</button>\r\n\t\t<button id=\"mapEditorMenuChangeSize\">Change map size</button>\r\n\t\t<button id=\"mapEditorMenuBack\">Back</button>\r\n\t\t<button id=\"mapEditorMenuClose\">Close editor</button>\r\n\t</div>\r\n\t*/\r\n\r\n\t/*\r\n\t\r\n\t<div class=\"menu\" id=\"gameOverMenu\">\r\n\t\t<h1 id=\"gameOverMenuH1\">You win!</h1>\r\n\t\t<div id=\"gameOverMenuStats\">\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<button id=\"gameOverMenuspectate\">spectate</button>\r\n        <button id=\"gameOverMenuBack\">Main menu</button>\r\n\t</div>\r\n\t*/\r\n\r\n\treadonly gameOverMenu = {\r\n\t\tmain: document.getElementById('gameOverMenu'),\r\n\t\tback: document.getElementById('gameOverMenuBack'),\r\n\t\th1: document.getElementById('gameOverMenuH1'),\r\n\t\tstats: document.getElementById('gameOverMenuStats'),\r\n\t\tspectate: document.getElementById('gameOverMenuspectate')\r\n\t};\r\n\r\n\treadonly mapEditorMenu = {\r\n\t\tmain: document.getElementById('mapEditorMenu'),\r\n\t\tname: document.getElementById('mapEditorMenuName'),\r\n\t\tsave: document.getElementById('mapEditorMenuSave'),\r\n\t\tchangeSize: document.getElementById('mapEditorMenuChangeSize'),\r\n\t\tback: document.getElementById('mapEditorMenuBack'),\r\n\t\tclose: document.getElementById('mapEditorMenuClose')\r\n\t};\r\n\r\n\t/*\r\n\t<div class=\"menu\" id=\"alertMenu\">\r\n\t\t<h1>Not allowed character!</h1>\r\n\t\t<p>Please change that name.</p>\r\n\t\t<p>Allowed characters:</p>\r\n\t\t<p><b>abcdefghijklmnopqrstuvwxyz</b><br /><b>ABCDEFGHIJKLMNOPQRSTUVWXYZ</b><br /><b>0123456789</b><br /> and <b>space</b></p>\r\n\t\t<button id=\"alertMenuOk\">OK</button>\r\n\t</div>\r\n\t*/\r\n\r\n\treadonly alertMenu = {\r\n\t\tmain: document.getElementById('alertMenu'),\r\n\t\tok: document.getElementById('alertMenuOk')\r\n\t};\r\n\r\n\t/*<div class=\"menu\" id=\"openMapMenu\">\r\n        <h1>Open map</h1>\r\n        <select id=\"openMapMenuMaps\"></select>\r\n        <button id=\"openMapMenuOk\">OK</button>\r\n        <button id=\"openMapMenuBack\">Back</button>\r\n\t</div>*/\r\n\r\n\treadonly openMapMenu = {\r\n\t\tmain: document.getElementById('openMapMenu'),\r\n\t\tmaps: document.getElementById('openMapMenuMaps'),\r\n\t\tok: document.getElementById('openMapMenuOk'),\r\n\t\tback: document.getElementById('openMapMenuBack')\r\n\t};\r\n\r\n\t/*\r\n\t<div class=\"menu\" id=\"controlsMenu\">\r\n        <h1>Game controls</h1>\r\n        <p>Move: <b>A, W, S, D</b>.</p>\r\n        <p>Hit / Shoot: <b>Mouse</b>.</p>\r\n        <button id=\"controlsMenuBack\">Back</button>\r\n\t</div>\r\n\t*/\r\n\r\n\treadonly controlsMenu = {\r\n\t\tmain: document.getElementById('controlsMenu'),\r\n\t\tback: document.getElementById('controlsMenuBack')\r\n\t};\r\n\r\n\t/*\r\n\t<div class=\"menu\" id=\"mainMenu\">\r\n\t\t<h1>Mini battle royale</h1>\r\n\t\t<!--<p id=\"mainMenuIp\">+</p>-->\r\n\t\t<input id=\"mainMenuName\" type=\"text\" maxlength=\"20\" placeholder=\"Your name\" value=\"\" autocomplete=\"off\" autofocus>\r\n\t\t<div class =\"join\">\r\n\t\t\t<h2>Join</h2>\r\n\t\t\t<select id=\"mainMenuGames\" disabled></select>\r\n\t\t\t<button id=\"mainMenuJoin\" disabled>Join</button>\r\n\t\t</div>\r\n\t\t<div class =\"create\">\r\n\t\t\t<h2>Create</h2>\r\n\t\t\t<select id=\"mainMenuMaps\"></select>\r\n\t\t\t<button id=\"mainMenuCreate\" disabled>Create</button>\r\n\t\t</div>\r\n\t\t<button id=\"mainMenuOpenEditor\">Map editor</button>\r\n\t\t<button id=\"mainMenuControls\">Game controls</button>\r\n\t</div>\r\n\t*/\r\n\r\n\treadonly mainMenu = {\r\n\t\tmain: document.getElementById('mainMenu'),\r\n\t\tip: document.getElementById('mainMenuIp'),\r\n\t\tname: document.getElementById('mainMenuName'),\r\n\t\tgames: document.getElementById('mainMenuGames'),\r\n\t\tjoin: document.getElementById('mainMenuJoin'),\r\n\t\tmaps: document.getElementById('mainMenuMaps'),\r\n\t\tcreate: document.getElementById('mainMenuCreate'),\r\n\t\topenEditor: document.getElementById('mainMenuOpenEditor'),\r\n\t\tcontrols: document.getElementById('mainMenuControls')\r\n\t};\r\n\t/*\r\n\t<div class=\"menu\" id=\"gameCanceledMenu\">\r\n\t\t<h1>Game canceled</h1>\r\n\t\t<p>Your game has been canceled.</p>\r\n\t\t<button id=\"gameCanceledMenuBack\">Back to main menu</button>\r\n\t</div>\r\n\t*/\r\n\treadonly gameCanceledMenu = {\r\n\t\tmain: document.getElementById('cancelLobbyMenu'),\r\n\t\tback: document.getElementById('cancelLobbyMenuBack')\r\n\t};\r\n\r\n\t/*\r\n\t<div class=\"menu\" id=\"mapSizeMenu\">\r\n\t\t\t<h1>Map size</h1>\r\n\t\t\t<p>Size [blocks]</p>\r\n\t\t\t<select id=\"mapSizeValue\">\r\n\t\t\t\t<option value=\"1\">1</option>\r\n\t\t\t\t<option value=\"2\">2</option>\r\n\t\t\t\t<option value=\"3\">3</option>\r\n\t\t\t\t<option value=\"4\">4</option>\r\n\t\t\t\t<option value=\"5\" selected>5</option>\r\n\t\t\t\t<option value=\"6\">6</option>\r\n\t\t\t\t<option value=\"7\">7</option>\r\n\t\t\t\t<option value=\"8\">8</option>\r\n\t\t\t\t<option value=\"9\">9</option>\r\n\t\t\t\t<option value=\"10\">10</option>\r\n\t\t\t</select>\r\n\t\t\t<p>\r\n\t\t\t\t<button id=\"mapSizeOk\">OK</button>\r\n\t\t\t\t<button id=\"mapSizeBack\">Back</button>\r\n\t\t\t</p>\r\n\t</div>\r\n\t*/\r\n\treadonly mapSizeMenu = {\r\n\t\tmain: document.getElementById('mapSizeMenu'),\r\n\t\tvalue: document.getElementById('mapSizeValue'),\r\n\t\tok: document.getElementById('mapSizeOk'),\r\n\t\tback: document.getElementById('mapSizeBack')\r\n\t};\r\n\r\n\t/*\r\n\t<div class=\"menu\" id=\"mapMenu\">\r\n        <h1>Map editor</h1>\r\n        <button id=\"mapMenuCreate\">Create a new map</button>\r\n        <button id=\"mapMenuOpenMap\">Open the created maps</button>\r\n        <button id=\"mapMenuBack\">Back</button>\r\n\t</div>\r\n\t*/\r\n\r\n\treadonly mapMenu = {\r\n\t\tmain: document.getElementById('mapMenu'),\r\n\t\tcreate: document.getElementById('mapMenuCreate'),\r\n\t\topen: document.getElementById('mapMenuOpenMap'),\r\n\t\tback: document.getElementById('mapMenuBack')\r\n\t};\r\n\r\n\t/**\r\n\t <div class=\"menu\" id=\"lobbyMenu\">\r\n\t\t<h1 id=\"lobbyMenuGameName\"></h1>\r\n\t\t<ul id=\"lobbyMenuPlayers\"></ul>\r\n\t\t<div id=\"lobbyMenuForJoinPlayer\">\r\n\t\t\t<p>Waiting for players...</p>\r\n\t\t\t<button id=\"lobbyMenuLeave\">Leave the game</button>\r\n\t\t</div>\r\n\t\t<div id=\"lobbyMenuForCreatePlayer\">\r\n\t\t\t<button id=\"lobbyMenuStart\">Launch the game</button>\r\n\t\t\t<button id=\"lobbyMenuCancel\">Cancel the game</button>\r\n\t\t</div>\r\n\t</div>\t\t\r\n\t*/\r\n\treadonly lobbyMenu = {\r\n\t\tmain: document.getElementById('lobbyMenu'),\r\n\t\tgameName: document.getElementById('lobbyMenuGameName'),\r\n\t\tplayers: document.getElementById('lobbyMenuPlayers'),\r\n\t\tforJoinPlayers: document.getElementById('lobbyMenuForJoinPlayer'),\r\n\t\tleave: document.getElementById('lobbyMenuLeave'),\r\n\t\tforCreatePlayer: document.getElementById('lobbyMenuForCreatePlayer'),\r\n\t\tstart: document.getElementById('lobbyMenuStart'),\r\n\t\tcancel: document.getElementById('lobbyMenuCancel')\r\n\t};\r\n\r\n\treadonly loading = {\r\n\t\tmain: document.getElementById('loading'),\r\n\t\tcounter: document.getElementById('loadingCounter'),\r\n\t\tcircle: document.getElementById('loadingCircle'),\r\n\t\ttext: document.getElementById('loadingText')\r\n\t};\r\n\r\n\t/*\r\n\t<div class=\"menu\" id=\"escFromGame\">\r\n\t\t<h1>Leave game?</h1>\r\n\t\t<button id=\"escFromGameBack\">Back to the game</button>\r\n        <button id=\"escFromGameLeave\">Leave the game</button>\r\n\t</div>\r\n\t*/\r\n\treadonly escFromGameMenu = {\r\n\t\tmain: document.getElementById('escFromGame'),\r\n\t\tback: document.getElementById('escFromGameBack'),\r\n\t\tleave: document.getElementById('escFromGameLeave')\r\n\t};\r\n\r\n\tconstructor() {\r\n\t\tthis.gameScreen = document.getElementById('gameScreen');\r\n\t\tthis.mapScreen = document.getElementById('mapScreen');\r\n\t\tthis.helperScreen = document.getElementById('helperScreen');\r\n\t\tthis.zoneSVG = document.getElementById('zoneSVG');\r\n\t\tthis.zoneCircle = document.getElementById('zoneCircle');\r\n\t\tthis.zoneRect = document.getElementById('zoneRect');\r\n\t\tthis.mapZoneSVG = document.getElementById('mapZoneSVG');\r\n\t\tthis.mapZoneCircle = document.getElementById('mapZoneCircle');\r\n\t\tthis.takeLoot = document.getElementById('takeLoot');\r\n\t\tthis.transparentLayer = document.getElementById('transparentLayer');\r\n\t\tthis.activeGunAmmo = document.getElementById('activeGunAmmo');\r\n\t\tthis.mapContainer = document.getElementById('mapContainer');\r\n\t\tthis.alive = document.getElementById('alive');\r\n\t\tthis.messages = document.getElementById('messages');\r\n\t\tthis.zoneTimer = document.getElementById('zoneTimer');\r\n\t\tthis.spectate = document.getElementById('spectate');\r\n\t\tthis.spectateName = document.getElementById('spectateName');\r\n\t\tthis.hideGame = document.getElementById('hideGame');\r\n\t\tthis.itNetwork = document.getElementById('itnetwork');\r\n\t}\r\n\r\n\tclose(...elements: HTMLElement[]): void {\r\n\t\tfor (const element of elements) {\r\n\t\t\telement.style.display = 'none';\r\n\t\t}\r\n\t}\r\n\r\n\topen(...elements: HTMLElement[]): void {\r\n\t\tfor (const element of elements) {\r\n\t\t\telement.style.display = 'block';\r\n\t\t}\r\n\t}\r\n}\r\n","import { Terrain } from './Terrain';\r\nimport RectangleObstacle from './RectangleObstacle';\r\nimport Bush from './Bush';\r\nimport Rock from './Rock';\r\nimport Tree from './Tree';\r\n\r\nexport default class MapData {\r\n\tsize: number;\r\n\tblockSize: number;\r\n\tterrains: Terrain[];\r\n\trects: RectangleObstacle[];\r\n\tbushes: Bush[];\r\n\trocks: Rock[];\r\n\ttrees: Tree[];\r\n\r\n\tconstructor(\r\n\t\tsize: number,\r\n\t\tblockSize: number,\r\n\t\tterrains: Terrain[],\r\n\t\trects: RectangleObstacle[],\r\n\t\tbushes: Bush[],\r\n\t\trocks: Rock[],\r\n\t\ttrees: Tree[]\r\n\t) {\r\n\t\tthis.size = size;\r\n\t\tthis.blockSize = blockSize;\r\n\t\tthis.terrains = terrains;\r\n\t\tthis.rects = rects;\r\n\t\tthis.bushes = bushes;\r\n\t\tthis.rocks = rocks;\r\n\t\tthis.trees = trees;\r\n\t}\r\n}\r\n","import { Terrain, TerrainType } from './Terrain';\r\nimport MyHtmlElements from './MyHtmlElements';\r\nimport Bush from './Bush';\r\nimport Rock from './Rock';\r\nimport Tree from './Tree';\r\nimport Wall from './Wall';\r\nimport Socket from './Socket';\r\nimport Colors from './Colors';\r\nimport MapData from './MapData';\r\n\r\nexport default class Editor {\r\n\tprivate terrainType: TerrainType | null;\r\n\tprivate objectType: string | null;\r\n\tbush: Bush;\r\n\trock: Rock;\r\n\ttree: Tree;\r\n\thorizontalWall: Wall;\r\n\tverticalWall: Wall;\r\n\tprivate x: number;\r\n\tprivate y: number;\r\n\tprivate active: boolean = false;\r\n\tprivate size: number;\r\n\treadonly blockSize: number = 300;\r\n\tterrains: Terrain[] = [];\r\n\tbushes: Bush[] = [];\r\n\trocks: Rock[] = [];\r\n\ttrees: Tree[] = [];\r\n\twalls: Wall[] = [];\r\n\tprivate myHtmlElements: MyHtmlElements;\r\n\tprivate socket: Socket;\r\n\tprivate colors: Colors;\r\n\r\n\tconstructor(myHtmlElements: MyHtmlElements, socket: Socket) {\r\n\t\tthis.myHtmlElements = myHtmlElements;\r\n\t\tthis.socket = socket;\r\n\t\tthis.colors = new Colors();\r\n\t\tthis.bush = new Bush(0, 0, 0, 0);\r\n\t\tthis.rock = new Rock(0, 0, 0);\r\n\t\tthis.tree = new Tree(0, 0, 0, 0);\r\n\t\tthis.horizontalWall = new Wall(0, 0, 0, 612 / 2, 145 / 2);\r\n\t\tthis.verticalWall = new Wall(0, 0, 0, 145 / 2, 612 / 2);\r\n\t\tthis.controller();\r\n\t}\r\n\r\n\tisActive(): boolean {\r\n\t\treturn this.active;\r\n\t}\r\n\r\n\tclose(): void {\r\n\t\tthis.active = false;\r\n\t}\r\n\r\n\tgetTerrainType(): TerrainType | null {\r\n\t\treturn this.terrainType;\r\n\t}\r\n\r\n\tgetObjectType(): string | null {\r\n\t\treturn this.objectType;\r\n\t}\r\n\r\n\tgetSize(): number {\r\n\t\treturn this.size;\r\n\t}\r\n\r\n\tgetX(): number {\r\n\t\treturn this.x;\r\n\t}\r\n\r\n\tgetY(): number {\r\n\t\treturn this.y;\r\n\t}\r\n\r\n\tgetMapData(): MapData {\r\n\t\treturn new MapData(this.size, this.blockSize, this.terrains, this.walls, this.bushes, this.rocks, this.trees);\r\n\t}\r\n\r\n\tcreate(): void {\r\n\t\tthis.cleanMap();\r\n\t}\r\n\r\n\tchangeSize(size: number): void {\r\n\t\tthis.active = true;\r\n\t\tconst el = this.myHtmlElements;\r\n\t\tthis.size = size;\r\n\t\t(<HTMLCanvasElement>el.editor.screen).width = size * this.blockSize;\r\n\t\t(<HTMLCanvasElement>el.editor.screen).height = size * this.blockSize;\r\n\t\tconst widthString = (size * this.blockSize).toString();\r\n\t\tel.editor.screen.style.width = widthString;\r\n\t\tconst heightString = (size * this.blockSize).toString();\r\n\t\tel.editor.screen.style.width = heightString;\r\n\t\tthis.cleanMapAfterChangeSize();\r\n\t}\r\n\r\n\tprivate cleanMap(): void {\r\n\t\tthis.terrains = [];\r\n\t\tthis.bushes = [];\r\n\t\tthis.rocks = [];\r\n\t\tthis.trees = [];\r\n\t\tthis.walls = [];\r\n\t}\r\n\r\n\tprivate cleanMapAfterChangeSize(): void {\r\n\t\tconst mapSize = this.size * this.blockSize;\r\n\t\tlet arr: any = this.terrains;\r\n\t\tfor (let i = arr.length - 1; i >= 0; i--) {\r\n\t\t\tconst item = arr[i];\r\n\t\t\tif (item.x >= mapSize || item.y >= mapSize) {\r\n\t\t\t\tarr.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tarr = this.trees;\r\n\t\tfor (let i = arr.length - 1; i >= 0; i--) {\r\n\t\t\tconst item = arr[i];\r\n\t\t\tif (item.x >= mapSize || item.y >= mapSize) {\r\n\t\t\t\tarr.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tarr = this.rocks;\r\n\t\tfor (let i = arr.length - 1; i >= 0; i--) {\r\n\t\t\tconst item = arr[i];\r\n\t\t\tif (item.x >= mapSize || item.y >= mapSize) {\r\n\t\t\t\tarr.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tarr = this.bushes;\r\n\t\tfor (let i = arr.length - 1; i >= 0; i--) {\r\n\t\t\tconst item = arr[i];\r\n\t\t\tif (item.x >= mapSize || item.y >= mapSize) {\r\n\t\t\t\tarr.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tarr = this.walls;\r\n\t\tfor (let i = arr.length - 1; i >= 0; i--) {\r\n\t\t\tconst item = arr[i];\r\n\t\t\tif (item.x >= mapSize || item.y >= mapSize) {\r\n\t\t\t\tarr.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate openMap(mapData: MapData): void {\r\n\t\tthis.create();\r\n\t\tthis.changeSize(mapData.size);\r\n\t\tlet id = 0;\r\n\t\tfor (const item of mapData.rocks) {\r\n\t\t\tthis.rocks.push(new Rock(id++, item.x, item.y));\r\n\t\t}\r\n\t\tfor (const item of mapData.trees) {\r\n\t\t\tthis.trees.push(new Tree(id++, item.x, item.y, item.angle));\r\n\t\t}\r\n\t\tfor (const item of mapData.bushes) {\r\n\t\t\tthis.bushes.push(new Bush(id++, item.x, item.y, item.angle));\r\n\t\t}\r\n\t\tfor (const item of mapData.rects) {\r\n\t\t\tthis.walls.push(new Wall(id++, item.x, item.y, item.width, item.height));\r\n\t\t}\r\n\t\tfor (const item of mapData.terrains) {\r\n\t\t\tthis.terrains.push(new Terrain(item.type, item.x, item.y, item.size));\r\n\t\t}\r\n\t\tthis.cleanMapAfterChangeSize();\r\n\t}\r\n\r\n\tcontroller(): void {\r\n\t\tconst el = this.myHtmlElements;\r\n\t\t//editorScreen mouse move\r\n\t\tel.editor.screen.addEventListener('mousemove', (e: MouseEvent) => {\r\n\t\t\tconst canvasRect = el.editor.screen.getBoundingClientRect();\r\n\t\t\tthis.x = e.clientX + el.editor.screen.scrollLeft - canvasRect.left;\r\n\t\t\tthis.y = e.clientY + el.editor.screen.scrollTop - canvasRect.top;\r\n\t\t\tel.editor.coordinates.innerText = `x: ${this.x} y: ${this.y}`;\r\n\t\t});\r\n\r\n\t\t//choose terrain type\r\n\t\tel.editor.terrainImgs.addEventListener('click', (e: MouseEvent) => {\r\n\t\t\tconst terrainImgs = el.editor.terrainImgs.children;\r\n\t\t\tfor (let i = 0; i < terrainImgs.length; i++) {\r\n\t\t\t\t(<HTMLElement>terrainImgs[i]).style.borderColor = this.colors.blockFrame;\r\n\t\t\t}\r\n\t\t\tconst objectImgs = el.editor.objectImgs.children;\r\n\t\t\tfor (let i = 0; i < objectImgs.length; i++) {\r\n\t\t\t\t(<HTMLElement>objectImgs[i]).style.borderColor = this.colors.blockFrame;\r\n\t\t\t}\r\n\t\t\t(<HTMLElement>e.target).style.borderColor = this.colors.blockFrameActive;\r\n\t\t\tthis.objectType = null;\r\n\t\t\tswitch (e.target) {\r\n\t\t\t\tcase el.editor.terrainWater:\r\n\t\t\t\t\tthis.terrainType = TerrainType.Water;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.terrainGrass:\r\n\t\t\t\t\tthis.terrainType = TerrainType.Grass;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.terrainWaterTriangle1:\r\n\t\t\t\t\tthis.terrainType = TerrainType.WaterTriangle1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.terrainWaterTriangle2:\r\n\t\t\t\t\tthis.terrainType = TerrainType.WaterTriangle2;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.terrainWaterTriangle3:\r\n\t\t\t\t\tthis.terrainType = TerrainType.WaterTriangle3;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.terrainWaterTriangle4:\r\n\t\t\t\t\tthis.terrainType = TerrainType.WaterTriangle4;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//choose object\r\n\t\tel.editor.objectImgs.addEventListener('click', (e: MouseEvent) => {\r\n\t\t\tconst terrainImgs = el.editor.terrainImgs.children;\r\n\t\t\tfor (let i = 0; i < terrainImgs.length; i++) {\r\n\t\t\t\t(<HTMLElement>terrainImgs[i]).style.borderColor = this.colors.blockFrame;\r\n\t\t\t}\r\n\t\t\tconst objectImgs = el.editor.objectImgs.children;\r\n\t\t\tfor (let i = 0; i < objectImgs.length; i++) {\r\n\t\t\t\t(<HTMLElement>objectImgs[i]).style.borderColor = this.colors.blockFrame;\r\n\t\t\t}\r\n\t\t\t(<HTMLElement>e.target).style.borderColor = this.colors.blockFrameActive;\r\n\t\t\tthis.terrainType = null;\r\n\t\t\tswitch (e.target) {\r\n\t\t\t\tcase el.editor.objectBush:\r\n\t\t\t\t\tthis.objectType = 'bush';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.objectRock:\r\n\t\t\t\t\tthis.objectType = 'rock';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.objectTree:\r\n\t\t\t\t\tthis.objectType = 'tree';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.objectRect:\r\n\t\t\t\t\tthis.objectType = 'rect';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.objectHorizontalWall:\r\n\t\t\t\t\tthis.objectType = 'horizontalWall';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.objectVerticalWall:\r\n\t\t\t\t\tthis.objectType = 'verticalWall';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase el.editor.objectDelete:\r\n\t\t\t\t\tthis.objectType = 'delete';\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//editorScreenClick\r\n\t\tel.editor.screen.addEventListener('click', () => {\r\n\t\t\tif (this.getTerrainType() != null) {\r\n\t\t\t\tconst blockX = Math.floor(this.getX() / this.blockSize) * this.blockSize;\r\n\t\t\t\tconst blockY = Math.floor(this.getY() / this.blockSize) * this.blockSize;\r\n\t\t\t\t//find block on this position and delete\r\n\t\t\t\tlet deletePosition = -1;\r\n\t\t\t\tfor (let i = 0; i < this.terrains.length; i++) {\r\n\t\t\t\t\tconst terrain = this.terrains[i];\r\n\t\t\t\t\tif (terrain.x === blockX && terrain.y === blockY) {\r\n\t\t\t\t\t\tdeletePosition = i;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (deletePosition !== -1) {\r\n\t\t\t\t\tthis.terrains.splice(deletePosition, 1);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.getTerrainType() !== TerrainType.Grass) {\r\n\t\t\t\t\tthis.terrains.push(new Terrain(this.getTerrainType(), blockX, blockY, this.blockSize));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.getObjectType() != null) {\r\n\t\t\t\tconst randomAngle = Math.floor(Math.random() * 360);\r\n\t\t\t\tswitch (this.getObjectType()) {\r\n\t\t\t\t\tcase 'bush':\r\n\t\t\t\t\t\tthis.bushes.push(\r\n\t\t\t\t\t\t\tnew Bush(0, this.x - this.bush.size / 2, this.y - this.bush.size / 2, randomAngle)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'rock':\r\n\t\t\t\t\t\tthis.rocks.push(new Rock(0, this.x - this.rock.size / 2, this.y - this.rock.size / 2));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'tree':\r\n\t\t\t\t\t\tthis.trees.push(\r\n\t\t\t\t\t\t\tnew Tree(0, this.x - this.tree.size / 2, this.y - this.tree.size / 2, randomAngle)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'rect':\r\n\t\t\t\t\t\tthis.walls.push(\r\n\t\t\t\t\t\t\tnew Wall(0, this.x - this.bush.size / 2, this.y - this.bush.size / 2, 100, 100)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'horizontalWall':\r\n\t\t\t\t\t\tthis.walls.push(\r\n\t\t\t\t\t\t\tnew Wall(\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\tthis.x - this.horizontalWall.width / 2,\r\n\t\t\t\t\t\t\t\tthis.y - this.horizontalWall.height / 2,\r\n\t\t\t\t\t\t\t\tthis.horizontalWall.width,\r\n\t\t\t\t\t\t\t\tthis.horizontalWall.height\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'verticalWall':\r\n\t\t\t\t\t\tthis.walls.push(\r\n\t\t\t\t\t\t\tnew Wall(\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\tthis.x - this.verticalWall.width / 2,\r\n\t\t\t\t\t\t\t\tthis.y - this.verticalWall.height / 2,\r\n\t\t\t\t\t\t\t\tthis.verticalWall.width,\r\n\t\t\t\t\t\t\t\tthis.verticalWall.height\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'delete':\r\n\t\t\t\t\t\t//find delete object\r\n\t\t\t\t\t\tlet deleteObject;\r\n\t\t\t\t\t\tconst editor = this;\r\n\t\t\t\t\t\tfor (const rock of editor.rocks) {\r\n\t\t\t\t\t\t\tconst object = rock;\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tobject.x <= editor.getX() &&\r\n\t\t\t\t\t\t\t\tobject.x + object.size >= editor.getX() &&\r\n\t\t\t\t\t\t\t\tobject.y <= editor.getY() &&\r\n\t\t\t\t\t\t\t\tobject.y + object.size >= editor.getY()\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tdeleteObject = object;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (const wall of editor.walls) {\r\n\t\t\t\t\t\t\tconst object = wall;\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tobject.x <= editor.getX() &&\r\n\t\t\t\t\t\t\t\tobject.x + object.width >= editor.getX() &&\r\n\t\t\t\t\t\t\t\tobject.y <= editor.getY() &&\r\n\t\t\t\t\t\t\t\tobject.y + object.height >= editor.getY()\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tdeleteObject = object;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (const bush of editor.bushes) {\r\n\t\t\t\t\t\t\tconst object = bush;\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tobject.x <= editor.getX() &&\r\n\t\t\t\t\t\t\t\tobject.x + object.size >= editor.getX() &&\r\n\t\t\t\t\t\t\t\tobject.y <= editor.getY() &&\r\n\t\t\t\t\t\t\t\tobject.y + object.size >= editor.getY()\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tdeleteObject = object;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (const tree of editor.trees) {\r\n\t\t\t\t\t\t\tconst object = tree;\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tobject.x <= editor.getX() &&\r\n\t\t\t\t\t\t\t\tobject.x + object.size >= editor.getX() &&\r\n\t\t\t\t\t\t\t\tobject.y <= editor.getY() &&\r\n\t\t\t\t\t\t\t\tobject.y + object.size >= editor.getY()\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tdeleteObject = object;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//delete\r\n\t\t\t\t\t\tlet deleteIndex = -1;\r\n\t\t\t\t\t\tfor (let i = 0; i < this.rocks.length; i++) {\r\n\t\t\t\t\t\t\tif (deleteObject == this.rocks[i]) deleteIndex = i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (deleteIndex !== -1) {\r\n\t\t\t\t\t\t\tthis.rocks.splice(deleteIndex, 1);\r\n\t\t\t\t\t\t\tdeleteIndex = -1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (let i = 0; i < this.bushes.length; i++) {\r\n\t\t\t\t\t\t\tif (deleteObject == this.bushes[i]) deleteIndex = i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (deleteIndex !== -1) {\r\n\t\t\t\t\t\t\tthis.bushes.splice(deleteIndex, 1);\r\n\t\t\t\t\t\t\tdeleteIndex = -1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (let i = 0; i < this.trees.length; i++) {\r\n\t\t\t\t\t\t\tif (deleteObject == this.trees[i]) deleteIndex = i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (deleteIndex !== -1) {\r\n\t\t\t\t\t\t\tthis.trees.splice(deleteIndex, 1);\r\n\t\t\t\t\t\t\tdeleteIndex = -1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (let i = 0; i < this.walls.length; i++) {\r\n\t\t\t\t\t\t\tif (deleteObject == this.walls[i]) deleteIndex = i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (deleteIndex !== -1) {\r\n\t\t\t\t\t\t\tthis.walls.splice(deleteIndex, 1);\r\n\t\t\t\t\t\t\tdeleteIndex = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//socket openMapInEditor\r\n\t\tthis.socket.on('openMapInEditor', (mapData: MapData) => {\r\n\t\t\tthis.openMap(mapData);\r\n\t\t\tel.close(el.openMapMenu.main);\r\n\t\t\tel.open(el.editor.container);\r\n\t\t});\r\n\t}\r\n}\r\n","import { Controller } from './Controller';\r\nController.run();\r\nconsole.log('Version: 1.0.1');\r\n"],"names":["Weapon","TerrainType","LootType","AppVariant","Terrain","constructor","type","x","y","size","angle","this","WaterTriangle2","WaterTriangle3","WaterTriangle4","RoundObstacle","id","changed","opacity","active","radius","getChanged","nullChanged","update","isPointIn","point","Math","sqrt","getCenterX","getCenterY","getOpacity","isActive","Tree","super","treeTrankRadius","Rock","Bush","RectangleObstacle","width","height","getChangedData","acceptHit","Wall","Colors","water","grass","blockFrame","blockFrameActive","bullet","text","collisionPoint","player","hand","handBorder","vest","waterCircle","PartBulletLine","startX","startY","endX","endY","age","maxAge","increaseAge","getAge","BulletLine","parts","setEnd","length","push","Point","Scope","loadingMax","loading","scope","scopeLoadingChange","scopeResolutionAdjustment","setScope","newScope","oldScope","getFinalResolutionAdjustment","resolutionAdjustment","View","map","mouse","waterTerrainData","myHtmlElements","collisionPoints","snapshotManager","finalResolutionAdjustment","bulletLines","lastdrawTime","Date","now","colors","gameScreen","editorScreen","editor","screen","mapScreen","helperScreen","ctxGame","getContext","ctxMap","ctxEditor","horizontalWallSVG","Image","src","verticalWallSVG","bushSVG","rockSVG","treeSVG","cursorSVG","loadingProgresSVG","loadingCircleSVG","pistolSVG","machinegunSVG","rifleSVG","shotgunSVG","hammerSVG","granadeSVG","smokeSVG","medkitSVG","smokeCloudSVG","rifleLootSVG","pistolLootSVG","shotgunLootSVG","machinegunLootSVG","hammerLootSVG","granadeLootSVG","smokeLootSVG","redAmmoLootSVG","greenAmmoLootSVG","blueAmmoLootSVG","orangeAmmoLootSVG","medkitLootSVG","vestLootSVG","scope2LootSVG","scope4LootSVG","scope6LootSVG","deadPlayer","waterTrianglePNG","screenResize","reset","myPlayer","el","window","innerWidth","innerHeight","zoneSVG","setAttribute","toString","mapSize","floor","mapZoneSVG","mapContainer","style","screenCenterX","screenCenterY","changeResolutionAdjustment","drawGame","calculateServerPosition","finalAdjustment","saveWaterPixels","waterType","ctx","fillStyle","fillRect","middleImage","save","translate","WaterTriangle1","rotate","PI","drawImage","restore","Worker","worker","onmessage","e","setData","data","getImageData","postMessage","time","getTime","console","log","drawMap","clearRect","blockSize","getSize","getBlockSize","sizeReduction","biggerBlockSize","terrain","Water","playerSize","beginPath","arc","fill","zone","innerCircle","getRadius","strokeStyle","stroke","outerCircle","mapZoneCircle","drawEditor","terrains","blockX","blockY","getTerrainType","getX","getY","Grass","i","getObjectType","globalAlpha","rock","rocks","wall","walls","svgSource","bush","bushes","tree","trees","deleteObject","object","wallSVG","verticalWall","horizontalWall","frameRateAdjuster","delayFromLastFrame","isPlayerUnderRoundObject","roudObject","myPlayerId","betweenSnapshot","players","spectate","s","block","blocks","isOnScreen","howToDraw","adjustFrameRate","waterCircles","flow","size2","rectangleObstacle","rectangleObstacles","alive","loot","l","lootSVG","Pistol","Machinegun","Shotgun","Rifle","Smoke","Granade","Hammer","RedAmmo","BlueAmmo","GreenAmmo","OrangeAmmo","Vest","Medkit","Scope2","Scope4","Scope6","colorVest","getVest","bodyRadius","gunSize","getWeapon","gunX","gunY","getAngle","getHammerAngle","Hand","hands","radiusHand","playerAngle","percentSize","shiftZ","shiftX","sin","shiftY","cos","granadeShiftAngle","SVG","drawHandOnWeapon","bloods","blood","getTimer","timerMax","shift","bloodX","bloodY","alpha","splice","granade","g","granadeSize","b","a","t","createBulletLines","line","partCounter","partLine","baseAlpha","finalAlpha","abs","moveTo","lineTo","lineWidth","opacityUnderTree","smoke","o","outerRadius","zoneCircle","healthBar","in","h","progres","round","lE","seconds","takeLoot","display","main","visibility","textContent","lT","secondsString","counter","circle","takeLootInfo","items","redAmmo","r","greenAmmo","blueAmmo","orangeAmmo","item1in","itemName","i1","item2in","i2","itemAmmoColor","item3in","i3","item4Text","i4","item4Count","s4","item4in","item5Text","i5","item5Count","s5","item5in","activeItem","ai","ammo","extraAmmoForActiveGun","activeGunAmmo","count","scope2","scope4","scope6","v","messageManager","messages","innerHTML","message","element","document","createElement","appendChild","z","hasOwnProperty","d","zoneTimer","innerText","spectateName","shiftHandZ","shiftHandAngle","finalAngle","shiftHandX","shiftHandY","handX","handY","thereIsLine","item1","classList","remove","item2","item3","item4","item5","add","item","weapon","item1Ammo","item2Ammo","background","weaponName","takeLootText","lootName","quantity","gameObject","gameOver","stats","win","winnerName","setTimeout","gameOverMenu","h1","open","kills","damageDealt","damageTaken","survive","minutes","surviveTime","Map","impassableRoundObstacles","openMap","yy","xx","newRock","newTree","rects","WaterTerrainData","waterTriangle1","waterTriangle2","waterTriangle3","waterTriangle4","Error","includeWater","waterData","state","CollisionPoints","body","hammer","ready","isReady","setX","setY","Blood","timer","random","Player","playerSnapshot","live","hammerAngle","m","w","lX","lY","hSize","rX","rY","createInjury","power","setVest","die","setAngle","setHammerAngle","setWeapon","ZoneCircle","centerX","centerY","setCenterX","setCenterY","setRadius","Zone","Message","WaterCircle","waterCircleSnapshot","frameRateAdjust","SnapshotManager","serverClientSync","snapshots","newerExists","olderExists","sumaNewer","averageSumaNewer","addSumaNewer","totalSuma","suma","beforeSnapshotForTestBullets","cut","addSnapshot","snapshot","updateDelay","getDrawDelay","getServerTime","p","completeSnapshot","updateMap","obsacleSnapshots","obstacleSnapshot","obstacle","updateZone","zoneSnapshot","iR","iX","iY","oR","oX","oY","previousSnapshot","lastSnapshot","completePlayerSnapshots","completeMyPlayerSnapshot","completeLootSnapshots","completeZoneSnapshot","previousMyPlayerSnapshot","lastMyPlayerSnapshot","aM","previousZoneSnapshot","lastZoneSnapshot","previousSnapshotLoots","lastSnapshotLoots","lastSnapshotLoot","previousSnapshotLoot","missingLoots","previous","lootExists","last","missingLoot","previousSnapshotPlayers","lastSnapshotPlayers","lastSnapshotPlayer","previousSnapshotPlayer","missingPlayerIds","playerExists","missingPlayerId","sort","createBetweenSnapshot","newerSnapshot","olderSnapshot","percentShift","wantedSnapshotTime","changeSumaNewer","timeDistance","distanceOlderFromWantedTime","copyFrom","positionBetweenSnapshots","olderLoot","newerLoot","older","newer","updatePlayers","playerInstance","olderPosition","newerPosition","direction","Model","socket","gameRun","gameId","playerId","view","loop","close","mainMenu","hideGame","stop","isNameOk","name","notAllowedCharacter","lastIndexOf","startSpectate","getSpectate","setName","getName","getGameId","setGameId","getPlayerId","setPlayerId","gameStart","gameActive","requestAnimationFrame","emit","ServerClientSync","ping","pings","timeDiference","timeDiferences","pingAttempts","defaultDrawDelay","drawDelay","minWantedSumaNewerSnapshots","defaultWantedNewerSnapshots","wantedSumaNewerSnapshots","maxWantedSumaNewerSnapshots","lags","maxLags","lastLagTime","getPing","getTimeDiference","changeDrawDelay","addData","pingsSuma","timeDiferenceSuma","change","serverTime","MyHtmlElements","getElementById","getElementsByTagName","scopeSVG","coordinates","container","terrainImgs","terrainWater","terrainGrass","terrainWaterTriangle1","terrainWaterTriangle2","terrainWaterTriangle3","terrainWaterTriangle4","objectImgs","objectBush","objectRock","objectTree","objectRect","objectHorizontalWall","objectVerticalWall","objectDelete","openMenu","saveMapMenu","back","mapEditorMenu","changeSize","alertMenu","ok","openMapMenu","maps","controlsMenu","ip","games","join","create","openEditor","controls","gameCanceledMenu","mapSizeMenu","value","mapMenu","lobbyMenu","gameName","forJoinPlayers","leave","forCreatePlayer","start","cancel","escFromGameMenu","zoneRect","transparentLayer","itNetwork","elements","MapData","Editor","controller","terrainType","objectType","getMapData","cleanMap","widthString","heightString","cleanMapAfterChangeSize","arr","mapData","addEventListener","canvasRect","getBoundingClientRect","clientX","scrollLeft","left","clientY","scrollTop","top","children","borderColor","target","deletePosition","randomAngle","deleteIndex","on","Controller","keys","middle","right","appVariant","location","hostname","Localhost","Production","canvas","io","connect","model","event","Event","dispatchEvent","preventDefault","returnValue","keysController","mouseController","socketController","menuController","static","instance","changePlayerName","nameOk","localStorage","setItem","disabled","gameExists","joinDisabled","playerName","openGames","openGame","option","index","playerNames","li","optionCopy","cloneNode","clientDateNow","serverDateNow","timeNow","timeDiferenceClientServer","which","undefined","previousPlayerAngle","rotatePlayer","clickPoint","serverPosition","mouseX","mouseY","atan","getItem","parseInt","mapName","selectedMap","gameIndex","run"],"sourceRoot":""}